module.exports={99468:a=>{"use strict";a.s({SPLITTERS:()=>c,SUPPORTED_LANGUAGES:()=>d,getLocale:()=>e});let b={arabic:"ar",armenian:"am",bulgarian:"bg",czech:"cz",danish:"dk",dutch:"nl",english:"en",finnish:"fi",french:"fr",german:"de",greek:"gr",hungarian:"hu",indian:"in",indonesian:"id",irish:"ie",italian:"it",lithuanian:"lt",nepali:"np",norwegian:"no",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"rs",slovenian:"ru",spanish:"es",swedish:"se",tamil:"ta",turkish:"tr",ukrainian:"uk",sanskrit:"sk"},c={dutch:/[^A-Za-zàèéìòóù0-9_'-]+/gim,english:/[^A-Za-zàèéìòóù0-9_'-]+/gim,french:/[^a-z0-9äâàéèëêïîöôùüûœç-]+/gim,italian:/[^A-Za-zàèéìòóù0-9_'-]+/gim,norwegian:/[^a-z0-9_æøåÆØÅäÄöÖüÜ]+/gim,portuguese:/[^a-z0-9à-úÀ-Ú]/gim,russian:/[^a-z0-9а-яА-ЯёЁ]+/gim,spanish:/[^a-z0-9A-Zá-úÁ-ÚñÑüÜ]+/gim,swedish:/[^a-z0-9_åÅäÄöÖüÜ-]+/gim,german:/[^a-z0-9A-ZäöüÄÖÜß]+/gim,finnish:/[^a-z0-9äöÄÖ]+/gim,danish:/[^a-z0-9æøåÆØÅ]+/gim,hungarian:/[^a-z0-9áéíóöőúüűÁÉÍÓÖŐÚÜŰ]+/gim,romanian:/[^a-z0-9ăâîșțĂÂÎȘȚ]+/gim,serbian:/[^a-z0-9čćžšđČĆŽŠĐ]+/gim,turkish:/[^a-z0-9çÇğĞıİöÖşŞüÜ]+/gim,lithuanian:/[^a-z0-9ąčęėįšųūžĄČĘĖĮŠŲŪŽ]+/gim,arabic:/[^a-z0-9أ-ي]+/gim,nepali:/[^a-z0-9अ-ह]+/gim,irish:/[^a-z0-9áéíóúÁÉÍÓÚ]+/gim,indian:/[^a-z0-9अ-ह]+/gim,armenian:/[^a-z0-9ա-ֆ]+/gim,greek:/[^a-z0-9α-ωά-ώ]+/gim,indonesian:/[^a-z0-9]+/gim,ukrainian:/[^a-z0-9а-яА-ЯіїєІЇЄ]+/gim,slovenian:/[^a-z0-9čžšČŽŠ]+/gim,bulgarian:/[^a-z0-9а-яА-Я]+/gim,tamil:/[^a-z0-9அ-ஹ]+/gim,sanskrit:/[^a-z0-9A-Zāīūṛḷṃṁḥśṣṭḍṇṅñḻḹṝ]+/gim,czech:/[^A-Z0-9a-zěščřžýáíéúůóťďĚŠČŘŽÝÁÍÉÓÚŮŤĎ-]+/gim},d=Object.keys(b);function e(a){return void 0!==a&&d.includes(a)?b[a]:void 0}},94919:a=>{"use strict";a.s({convertDistanceToMeters:()=>t,formatNanoseconds:()=>k,getDocumentProperties:()=>q,getNanosecondsTime:()=>l,getNested:()=>r,getOwnProperty:()=>n,intersect:()=>p,isAsyncFunction:()=>function a(b){return Array.isArray(b)?b.some(b=>a(b)):b?.constructor?.name==="AsyncFunction"},removeVectorsFromHits:()=>u,safeArrayPush:()=>h,setDifference:()=>z,setIntersection:()=>w,setUnion:()=>y,sleep:()=>A,sortTokenScorePredicate:()=>o,sprintf:()=>i,uniqueId:()=>m});var b=a.i(15905);let c=Date.now().toString().slice(5),d=0,e=BigInt(1e3),f=BigInt(1e6),g=BigInt(1e9);function h(a,b){if(b.length<65535)Array.prototype.push.apply(a,b);else{let c=b.length;for(let d=0;d<c;d+=65535)Array.prototype.push.apply(a,b.slice(d,d+65535))}}function i(a,...b){return a.replace(/%(?:(?<position>\d+)\$)?(?<width>-?\d*\.?\d*)(?<type>[dfs])/g,function(...a){let{width:c,type:d,position:e}=a[a.length-1],f=e?b[Number.parseInt(e)-1]:b.shift(),g=""===c?0:Number.parseInt(c);switch(d){case"d":return f.toString().padStart(g,"0");case"f":{let a=f,[b,d]=c.split(".").map(a=>Number.parseFloat(a));return"number"==typeof d&&d>=0&&(a=a.toFixed(d)),"number"==typeof b&&b>=0?a.toString().padStart(g,"0"):a.toString()}case"s":return g<0?f.toString().padEnd(-g," "):f.toString().padStart(g," ");default:return f}})}function j(){return BigInt(Math.floor(1e6*performance.now()))}function k(a){return("number"==typeof a&&(a=BigInt(a)),a<e)?`${a}ns`:a<f?`${a/e}μs`:a<g?`${a/f}ms`:`${a/g}s`}function l(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?j():"undefined"!=typeof process&&process.release&&"node"===process.release.name||"undefined"!=typeof process&&"function"==typeof process?.hrtime?.bigint?process.hrtime.bigint():"undefined"!=typeof performance?j():BigInt(0)}function m(){return`${c}-${d++}`}function n(a,b){return void 0===Object.hasOwn?Object.prototype.hasOwnProperty.call(a,b)?a[b]:void 0:Object.hasOwn(a,b)?a[b]:void 0}function o(a,b){return b[1]===a[1]?a[0]-b[0]:b[1]-a[1]}function p(a){if(0===a.length)return[];if(1===a.length)return a[0];for(let b=1;b<a.length;b++)if(a[b].length<a[0].length){let c=a[0];a[0]=a[b],a[b]=c}let b=new Map;for(let c of a[0])b.set(c,1);for(let c=1;c<a.length;c++){let d=0;for(let e of a[c]){let a=b.get(e);a===c&&(b.set(e,a+1),d++)}if(0===d)return[]}return a[0].filter(c=>{let d=b.get(c);return void 0!==d&&b.set(c,0),d===a.length})}function q(a,b){let c={},d=b.length;for(let e=0;e<d;e++){let d=b[e],f=d.split("."),g=a,h=f.length;for(let a=0;a<h;a++)if("object"==typeof(g=g[f[a]])){if(null!==g&&"lat"in g&&"lon"in g&&"number"==typeof g.lat&&"number"==typeof g.lon){g=c[d]=g;break}else if(!Array.isArray(g)&&null!==g&&a===h-1){g=void 0;break}}else if((null===g||"object"!=typeof g)&&a<h-1){g=void 0;break}void 0!==g&&(c[d]=g)}return c}function r(a,b){return q(a,[b])[b]}let s={cm:.01,m:1,km:1e3,ft:.3048,yd:.9144,mi:1609.344};function t(a,c){let d=s[c];if(void 0===d)throw Error((0,b.createError)("INVALID_DISTANCE_SUFFIX",a).message);return a*d}function u(a,b){a.hits=a.hits.map(a=>({...a,document:{...a.document,...b.reduce((a,b)=>{let c=b.split("."),d=c.pop(),e=a;for(let a of c)e[a]=e[a]??{},e=e[a];return e[d]=null,a},a.document)}}))}let v="intersection"in new Set;function w(...a){if(0===a.length)return new Set;if(1===a.length)return a[0];if(2===a.length){let b=a[0],c=a[1];if(v)return b.intersection(c);let d=new Set,e=b.size<c.size?b:c,f=e===b?c:b;for(let a of e)f.has(a)&&d.add(a);return d}let b={index:0,size:a[0].size};for(let c=1;c<a.length;c++)a[c].size<b.size&&(b.index=c,b.size=a[c].size);if(v){let c=a[b.index];for(let d=0;d<a.length;d++)d!==b.index&&(c=c.intersection(a[d]));return c}let c=a[b.index];for(let d=0;d<a.length;d++){if(d===b.index)continue;let e=a[d];for(let a of c)e.has(a)||c.delete(a)}return c}let x="union"in new Set;function y(a,b){return x?a?a.union(b):b:new Set(a?[...a,...b]:b)}function z(a,b){let c=new Set;for(let d of a)b.has(d)||c.add(d);return c}function A(a){if("undefined"!=typeof SharedArrayBuffer&&"undefined"!=typeof Atomics){let b=new Int32Array(new SharedArrayBuffer(4));if(!1==(a>0&&a<1/0)){if("number"!=typeof a&&"bigint"!=typeof a)throw TypeError("sleep: ms must be a number");throw RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")}Atomics.wait(b,0,0,Number(a))}else{if(!1==(a>0&&a<1/0)){if("number"!=typeof a&&"bigint"!=typeof a)throw TypeError("sleep: ms must be a number");throw RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")}let b=Date.now()+Number(a);for(;b>Date.now(););}}},15905:a=>{"use strict";a.s({createError:()=>f});var b=a.i(99468),c=a.i(94919);let d=b.SUPPORTED_LANGUAGES.join("\n - "),e={NO_LANGUAGE_WITH_CUSTOM_TOKENIZER:"Do not pass the language option to create when using a custom tokenizer.",LANGUAGE_NOT_SUPPORTED:`Language "%s" is not supported.
Supported languages are:
 - ${d}`,INVALID_STEMMER_FUNCTION_TYPE:"config.stemmer property must be a function.",MISSING_STEMMER:'As of version 1.0.0 @orama/orama does not ship non English stemmers by default. To solve this, please explicitly import and specify the "%s" stemmer from the package @orama/stemmers. See https://docs.orama.com/open-source/text-analysis/stemming for more information.',CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY:"Custom stop words array must only contain strings.",UNSUPPORTED_COMPONENT:'Unsupported component "%s".',COMPONENT_MUST_BE_FUNCTION:'The component "%s" must be a function.',COMPONENT_MUST_BE_FUNCTION_OR_ARRAY_FUNCTIONS:'The component "%s" must be a function or an array of functions.',INVALID_SCHEMA_TYPE:'Unsupported schema type "%s" at "%s". Expected "string", "boolean" or "number" or array of them.',DOCUMENT_ID_MUST_BE_STRING:'Document id must be of type "string". Got "%s" instead.',DOCUMENT_ALREADY_EXISTS:'A document with id "%s" already exists.',DOCUMENT_DOES_NOT_EXIST:'A document with id "%s" does not exists.',MISSING_DOCUMENT_PROPERTY:'Missing searchable property "%s".',INVALID_DOCUMENT_PROPERTY:'Invalid document property "%s": expected "%s", got "%s"',UNKNOWN_INDEX:'Invalid property name "%s". Expected a wildcard string ("*") or array containing one of the following properties: %s',INVALID_BOOST_VALUE:"Boost value must be a number greater than, or less than 0.",INVALID_FILTER_OPERATION:"You can only use one operation per filter, you requested %d.",SCHEMA_VALIDATION_FAILURE:'Cannot insert document due schema validation failure on "%s" property.',INVALID_SORT_SCHEMA_TYPE:'Unsupported sort schema type "%s" at "%s". Expected "string" or "number".',CANNOT_SORT_BY_ARRAY:'Cannot configure sort for "%s" because it is an array (%s).',UNABLE_TO_SORT_ON_UNKNOWN_FIELD:'Unable to sort on unknown field "%s". Allowed fields: %s',SORT_DISABLED:"Sort is disabled. Please read the documentation at https://docs.oramasearch for more information.",UNKNOWN_GROUP_BY_PROPERTY:'Unknown groupBy property "%s".',INVALID_GROUP_BY_PROPERTY:'Invalid groupBy property "%s". Allowed types: "%s", but given "%s".',UNKNOWN_FILTER_PROPERTY:'Unknown filter property "%s".',INVALID_VECTOR_SIZE:'Vector size must be a number greater than 0. Got "%s" instead.',INVALID_VECTOR_VALUE:'Vector value must be a number greater than 0. Got "%s" instead.',INVALID_INPUT_VECTOR:`Property "%s" was declared as a %s-dimensional vector, but got a %s-dimensional vector instead.
Input vectors must be of the size declared in the schema, as calculating similarity between vectors of different sizes can lead to unexpected results.`,WRONG_SEARCH_PROPERTY_TYPE:'Property "%s" is not searchable. Only "string" properties are searchable.',FACET_NOT_SUPPORTED:'Facet doens\'t support the type "%s".',INVALID_DISTANCE_SUFFIX:'Invalid distance suffix "%s". Valid suffixes are: cm, m, km, mi, yd, ft.',INVALID_SEARCH_MODE:'Invalid search mode "%s". Valid modes are: "fulltext", "vector", "hybrid".',MISSING_VECTOR_AND_SECURE_PROXY:"No vector was provided and no secure proxy was configured. Please provide a vector or configure an Orama Secure Proxy to perform hybrid search.",MISSING_TERM:'"term" is a required parameter when performing hybrid search. Please provide a search term.',INVALID_VECTOR_INPUT:'Invalid "vector" property. Expected an object with "value" and "property" properties, but got "%s" instead.',PLUGIN_CRASHED:"A plugin crashed during initialization. Please check the error message for more information:",PLUGIN_SECURE_PROXY_NOT_FOUND:`Could not find '@orama/secure-proxy-plugin' installed in your Orama instance.
Please install it before proceeding with creating an answer session.
Read more at https://docs.orama.com/open-source/plugins/plugin-secure-proxy#plugin-secure-proxy
`,PLUGIN_SECURE_PROXY_MISSING_CHAT_MODEL:`Could not find a chat model defined in the secure proxy plugin configuration.
Please provide a chat model before proceeding with creating an answer session.
Read more at https://docs.orama.com/open-source/plugins/plugin-secure-proxy#plugin-secure-proxy
`,ANSWER_SESSION_LAST_MESSAGE_IS_NOT_ASSISTANT:"The last message in the session is not an assistant message. Cannot regenerate non-assistant messages.",PLUGIN_COMPONENT_CONFLICT:'The component "%s" is already defined. The plugin "%s" is trying to redefine it.'};function f(a,...b){let d=Error((0,c.sprintf)(e[a]??`Unsupported Orama Error code: ${a}`,...b));return d.code=a,"captureStackTrace"in Error.prototype&&Error.captureStackTrace(d),d}},62675:a=>{"use strict";a.s({formatElapsedTime:()=>d,getDocumentIndexId:()=>e,getInnerType:()=>k,getVectorSize:()=>l,isArrayType:()=>j,isGeoPointType:()=>h,isVectorType:()=>i,validateSchema:()=>function a(c,d){for(let[e,f]of Object.entries(d)){let d=c[e];if(void 0!==d&&("geopoint"!==f||"object"!=typeof d||"number"!=typeof d.lon||"number"!=typeof d.lat)&&("enum"!==f||"string"!=typeof d&&"number"!=typeof d)){if("enum[]"===f&&Array.isArray(d)){let a=d.length;for(let b=0;b<a;b++)if("string"!=typeof d[b]&&"number"!=typeof d[b])return e+"."+b;continue}if(i(f)){let a=l(f);if(!Array.isArray(d)||d.length!==a)throw(0,b.createError)("INVALID_INPUT_VECTOR",e,a,d.length);continue}if(j(f)){if(!Array.isArray(d))return e;let a=function(a){return g[a]}(f),b=d.length;for(let c=0;c<b;c++)if(typeof d[c]!==a)return e+"."+c;continue}if("object"==typeof f){if(!d||"object"!=typeof d)return e;let b=a(d,f);if(b)return e+"."+b;continue}if(typeof d!==f)return e}}}});var b=a.i(15905),c=a.i(94919);function d(a){return{raw:Number(a),formatted:(0,c.formatNanoseconds)(a)}}function e(a){if(a.id){if("string"!=typeof a.id)throw(0,b.createError)("DOCUMENT_ID_MUST_BE_STRING",typeof a.id);return a.id}return(0,c.uniqueId)()}let f={string:!1,number:!1,boolean:!1,enum:!1,geopoint:!1,"string[]":!0,"number[]":!0,"boolean[]":!0,"enum[]":!0},g={"string[]":"string","number[]":"number","boolean[]":"boolean","enum[]":"enum"};function h(a){return"geopoint"===a}function i(a){return"string"==typeof a&&/^vector\[\d+\]$/.test(a)}function j(a){return"string"==typeof a&&f[a]}function k(a){return g[a]}function l(a){let c=Number(a.slice(7,-1));switch(!0){case isNaN(c):throw(0,b.createError)("INVALID_VECTOR_VALUE",a);case c<=0:throw(0,b.createError)("INVALID_VECTOR_SIZE",a);default:return c}}},11988:a=>{"use strict";a.s({}),a.i(15905),a.i(94919),a.i(62675)},80274:a=>{"use strict";function b(){return{idToInternalId:new Map,internalIdToId:[],save:c,load:d}}function c(a){return{internalIdToId:a.internalIdToId}}function d(a,b){let{internalIdToId:c}=b;a.internalDocumentIDStore.idToInternalId.clear(),a.internalDocumentIDStore.internalIdToId=[];let d=c.length;for(let b=0;b<d;b++){let d=c[b];a.internalDocumentIDStore.idToInternalId.set(d,b+1),a.internalDocumentIDStore.internalIdToId.push(d)}}function e(a,b){if(a.internalIdToId.length<b)throw Error(`Invalid internalId ${b}`);return a.internalIdToId[b-1]}a.s({createInternalDocumentIDStore:()=>b,getDocumentIdFromInternalId:()=>e,getInternalDocumentId:()=>function a(b,c){if("string"==typeof c){let a=b.idToInternalId.get(c);if(a)return a;let d=b.idToInternalId.size+1;return b.idToInternalId.set(c,d),b.internalIdToId.push(c),d}return c>b.internalIdToId.length?a(b,c.toString()):c}})},47181:a=>{"use strict";a.s({createDocumentsStore:()=>l});var b=a.i(80274);function c(a,b){return{sharedInternalDocumentStore:b,docs:{},count:0}}function d(a,c){let d=(0,b.getInternalDocumentId)(a.sharedInternalDocumentStore,c);return a.docs[d]}function e(a,c){let d=c.length,e=Array.from({length:d});for(let f=0;f<d;f++){let d=(0,b.getInternalDocumentId)(a.sharedInternalDocumentStore,c[f]);e[f]=a.docs[d]}return e}function f(a){return a.docs}function g(a,b,c,d){return void 0===a.docs[c]&&(a.docs[c]=d,a.count++,!0)}function h(a,c){let d=(0,b.getInternalDocumentId)(a.sharedInternalDocumentStore,c);return void 0!==a.docs[d]&&(delete a.docs[d],a.count--,!0)}function i(a){return a.count}function j(a,b){return{docs:b.docs,count:b.count,sharedInternalDocumentStore:a}}function k(a){return{docs:a.docs,count:a.count}}function l(){return{create:c,get:d,getMultiple:e,getAll:f,store:g,remove:h,count:i,load:j,save:k}}},2648:a=>{"use strict";a.s({AVAILABLE_PLUGIN_HOOKS:()=>c,getAllPluginsByHook:()=>d});var b=a.i(15905);let c=["beforeInsert","afterInsert","beforeRemove","afterRemove","beforeUpdate","afterUpdate","beforeUpsert","afterUpsert","beforeSearch","afterSearch","beforeInsertMultiple","afterInsertMultiple","beforeRemoveMultiple","afterRemoveMultiple","beforeUpdateMultiple","afterUpdateMultiple","beforeUpsertMultiple","afterUpsertMultiple","beforeLoad","afterLoad","afterCreate"];function d(a,c){let d=[],e=a.plugins?.length;if(!e)return d;for(let f=0;f<e;f++)try{let b=a.plugins[f];"function"==typeof b[c]&&d.push(b[c])}catch(a){throw console.error("Caught error in getAllPluginsByHook:",a),(0,b.createError)("PLUGIN_CRASHED")}return d}},97973:a=>{"use strict";a.s({FUNCTION_COMPONENTS:()=>d,OBJECT_COMPONENTS:()=>c,runAfterCreate:()=>i,runAfterSearch:()=>g,runBeforeSearch:()=>h,runMultipleHook:()=>f,runSingleHook:()=>e});var b=a.i(94919);let c=["tokenizer","index","documentsStore","sorter"],d=["validateSchema","getDocumentIndexId","getDocumentProperties","formatElapsedTime"];function e(a,c,d,e){if(a.some(b.isAsyncFunction))return(async()=>{for(let b of a)await b(c,d,e)})();for(let b of a)b(c,d,e)}function f(a,c,d){if(a.some(b.isAsyncFunction))return(async()=>{for(let b of a)await b(c,d)})();for(let b of a)b(c,d)}function g(a,c,d,e,f){if(a.some(b.isAsyncFunction))return(async()=>{for(let b of a)await b(c,d,e,f)})();for(let b of a)b(c,d,e,f)}function h(a,c,d,e){if(a.some(b.isAsyncFunction))return(async()=>{for(let b of a)await b(c,d,e)})();for(let b of a)b(c,d,e)}function i(a,c){if(a.some(b.isAsyncFunction))return(async()=>{for(let b of a)await b(c)})();for(let b of a)b(c)}},94533:a=>{"use strict";a.s({AVLTree:()=>d});var b=a.i(94919);class c{k;v;l=null;r=null;h=1;constructor(a,b){this.k=a,this.v=new Set(b)}updateHeight(){this.h=Math.max(c.getHeight(this.l),c.getHeight(this.r))+1}static getHeight(a){return a?a.h:0}getBalanceFactor(){return c.getHeight(this.l)-c.getHeight(this.r)}rotateLeft(){let a=this.r;return this.r=a.l,a.l=this,this.updateHeight(),a.updateHeight(),a}rotateRight(){let a=this.l;return this.l=a.r,a.r=this,this.updateHeight(),a.updateHeight(),a}toJSON(){return{k:this.k,v:Array.from(this.v),l:this.l?this.l.toJSON():null,r:this.r?this.r.toJSON():null,h:this.h}}static fromJSON(a){let b=new c(a.k,a.v);return b.l=a.l?c.fromJSON(a.l):null,b.r=a.r?c.fromJSON(a.r):null,b.h=a.h,b}}class d{root=null;insertCount=0;constructor(a,b){void 0!==a&&void 0!==b&&(this.root=new c(a,b))}insert(a,b,c=1e3){this.root=this.insertNode(this.root,a,b,c)}insertMultiple(a,b,c=1e3){for(let d of b)this.insert(a,d,c)}rebalance(){this.root&&(this.root=this.rebalanceNode(this.root))}toJSON(){return{root:this.root?this.root.toJSON():null,insertCount:this.insertCount}}static fromJSON(a){let b=new d;return b.root=a.root?c.fromJSON(a.root):null,b.insertCount=a.insertCount||0,b}insertNode(a,b,d,e){if(null===a)return new c(b,[d]);let f=[],g=a,h=null;for(;null!==g;)if(f.push({parent:h,node:g}),b<g.k)if(null===g.l){g.l=new c(b,[d]),f.push({parent:g,node:g.l});break}else h=g,g=g.l;else if(!(b>g.k))return g.v.add(d),a;else if(null===g.r){g.r=new c(b,[d]),f.push({parent:g,node:g.r});break}else h=g,g=g.r;let i=!1;this.insertCount++%e==0&&(i=!0);for(let b=f.length-1;b>=0;b--){let{parent:c,node:d}=f[b];if(d.updateHeight(),i){let b=this.rebalanceNode(d);c?c.l===d?c.l=b:c.r===d&&(c.r=b):a=b}}return a}rebalanceNode(a){let b=a.getBalanceFactor();if(b>1){if(a.l&&a.l.getBalanceFactor()>=0)return a.rotateRight();else if(a.l)return a.l=a.l.rotateLeft(),a.rotateRight()}if(b<-1){if(a.r&&0>=a.r.getBalanceFactor())return a.rotateLeft();else if(a.r)return a.r=a.r.rotateRight(),a.rotateLeft()}return a}find(a){let b=this.findNodeByKey(a);return b?b.v:null}contains(a){return null!==this.find(a)}getSize(){let a=0,b=[],c=this.root;for(;c||b.length>0;){for(;c;)b.push(c),c=c.l;c=b.pop(),a++,c=c.r}return a}isBalanced(){if(!this.root)return!0;let a=[this.root];for(;a.length>0;){let b=a.pop();if(Math.abs(b.getBalanceFactor())>1)return!1;b.l&&a.push(b.l),b.r&&a.push(b.r)}return!0}remove(a){this.root=this.removeNode(this.root,a)}removeDocument(a,b){let c=this.findNodeByKey(a);c&&(1===c.v.size?this.root=this.removeNode(this.root,a):c.v=new Set([...c.v.values()].filter(a=>a!==b)))}findNodeByKey(a){let b=this.root;for(;b;)if(a<b.k)b=b.l;else{if(!(a>b.k))return b;b=b.r}return null}removeNode(a,b){if(null===a)return null;let c=[],d=a;for(;null!==d&&d.k!==b;)c.push(d),d=b<d.k?d.l:d.r;if(null===d)return a;if(null===d.l||null===d.r){let b=d.l?d.l:d.r;if(0===c.length)a=b;else{let a=c[c.length-1];a.l===d?a.l=b:a.r=b}}else{let a=d,b=d.r;for(;null!==b.l;)a=b,b=b.l;d.k=b.k,d.v=b.v,a.l===b?a.l=b.r:a.r=b.r,d=a}c.push(d);for(let b=c.length-1;b>=0;b--){let d=c[b];d.updateHeight();let e=this.rebalanceNode(d);if(b>0){let a=c[b-1];a.l===d?a.l=e:a.r===d&&(a.r=e)}else a=e}return a}rangeSearch(a,c){let d=new Set,e=[],f=this.root;for(;f||e.length>0;){for(;f;)e.push(f),f=f.l;if((f=e.pop()).k>=a&&f.k<=c&&(d=(0,b.setUnion)(d,f.v)),f.k>c)break;f=f.r}return d}greaterThan(a,c=!1){let d=new Set,e=[],f=this.root;for(;f||e.length>0;){for(;f;)e.push(f),f=f.r;if(f=e.pop(),c&&f.k>=a||!c&&f.k>a)d=(0,b.setUnion)(d,f.v);else if(f.k<=a)break;f=f.l}return d}lessThan(a,c=!1){let d=new Set,e=[],f=this.root;for(;f||e.length>0;){for(;f;)e.push(f),f=f.l;if(f=e.pop(),c&&f.k<=a||!c&&f.k<a)d=(0,b.setUnion)(d,f.v);else if(f.k>a)break;f=f.r}return d}}},2552:a=>{"use strict";a.s({FlatTree:()=>b});class b{numberToDocumentId;constructor(){this.numberToDocumentId=new Map}insert(a,b){this.numberToDocumentId.has(a)?this.numberToDocumentId.get(a).add(b):this.numberToDocumentId.set(a,new Set([b]))}find(a){let b=this.numberToDocumentId.get(a);return b?Array.from(b):null}remove(a){this.numberToDocumentId.delete(a)}removeDocument(a,b){let c=this.numberToDocumentId.get(b);c&&(c.delete(a),0===c.size&&this.numberToDocumentId.delete(b))}contains(a){return this.numberToDocumentId.has(a)}getSize(){let a=0;for(let b of this.numberToDocumentId.values())a+=b.size;return a}filter(a){let b=Object.keys(a);if(1!==b.length)throw Error("Invalid operation");let c=b[0];switch(c){case"eq":{let b=a[c],d=this.numberToDocumentId.get(b);return d?Array.from(d):[]}case"in":{let b=a[c],d=new Set;for(let a of b){let b=this.numberToDocumentId.get(a);if(b)for(let a of b)d.add(a)}return Array.from(d)}case"nin":{let b=new Set(a[c]),d=new Set;for(let[a,c]of this.numberToDocumentId.entries())if(!b.has(a))for(let a of c)d.add(a);return Array.from(d)}default:throw Error("Invalid operation")}}filterArr(a){let b=Object.keys(a);if(1!==b.length)throw Error("Invalid operation");let c=b[0];switch(c){case"containsAll":{let b=a[c].map(a=>this.numberToDocumentId.get(a)??new Set);if(0===b.length)return[];return Array.from(b.reduce((a,b)=>new Set([...a].filter(a=>b.has(a)))))}case"containsAny":{let b=a[c].map(a=>this.numberToDocumentId.get(a)??new Set);if(0===b.length)return[];return Array.from(b.reduce((a,b)=>new Set([...a,...b])))}default:throw Error("Invalid operation")}}static fromJSON(a){if(!a.numberToDocumentId)throw Error("Invalid Flat Tree JSON");let c=new b;for(let[b,d]of a.numberToDocumentId)c.numberToDocumentId.set(b,new Set(d));return c}toJSON(){return{numberToDocumentId:Array.from(this.numberToDocumentId.entries()).map(([a,b])=>[a,Array.from(b)])}}}},71498:a=>{"use strict";function b(a,b,c){let d=function(a,b,c){if(c<0)return -1;if(a===b)return 0;let d=a.length,e=b.length;if(0===d)return e<=c?e:-1;if(0===e)return d<=c?d:-1;let f=Math.abs(d-e);if(a.startsWith(b))return f<=c?f:-1;if(b.startsWith(a))return 0;if(f>c)return -1;let g=[];for(let a=0;a<=d;a++){g[a]=[a];for(let b=1;b<=e;b++)g[a][b]=0===a?b:0}for(let f=1;f<=d;f++){let d=1/0;for(let c=1;c<=e;c++)a[f-1]===b[c-1]?g[f][c]=g[f-1][c-1]:g[f][c]=Math.min(g[f-1][c]+1,g[f][c-1]+1,g[f-1][c-1]+1),d=Math.min(d,g[f][c]);if(d>c)return -1}return g[d][e]<=c?g[d][e]:-1}(a,b,c);return{distance:d,isBounded:d>=0}}a.s({syncBoundedLevenshtein:()=>b})},51906:a=>{"use strict";a.s({RadixTree:()=>e});var b=a.i(71498),c=a.i(94919);class d{k;s;c=new Map;d=new Set;e;w="";constructor(a,b,c){this.k=a,this.s=b,this.e=c}updateParent(a){this.w=a.w+this.s}addDocument(a){this.d.add(a)}removeDocument(a){return this.d.delete(a)}findAllWords(a,d,e,f){let g=[this];for(;g.length>0;){let h=g.pop();if(h.e){let{w:g,d:i}=h;if(e&&g!==d)continue;if(null!==(0,c.getOwnProperty)(a,g))if(f){if(!(Math.abs(d.length-g.length)<=f)||!(0,b.syncBoundedLevenshtein)(d,g,f).isBounded)continue;a[g]=[]}else a[g]=[];if(null!=(0,c.getOwnProperty)(a,g)&&i.size>0){let b=a[g];for(let a of i)b.includes(a)||b.push(a)}}h.c.size>0&&g.push(...h.c.values())}return a}insert(a,b){let c=this,e=0,f=a.length;for(;e<f;){let g=a[e],h=c.c.get(g);if(h){let g=h.s,i=g.length,j=0;for(;j<i&&e+j<f&&g[j]===a[e+j];)j++;if(j===i){if(c=h,(e+=j)===f){h.e||(h.e=!0),h.addDocument(b);return}continue}let k=g.slice(0,j),l=g.slice(j),m=a.slice(e+j),n=new d(k[0],k,!1);if(c.c.set(k[0],n),n.updateParent(c),h.s=l,h.k=l[0],n.c.set(l[0],h),h.updateParent(n),m){let a=new d(m[0],m,!0);a.addDocument(b),n.c.set(m[0],a),a.updateParent(n)}else n.e=!0,n.addDocument(b);return}{let f=new d(g,a.slice(e),!0);f.addDocument(b),c.c.set(g,f),f.updateParent(c);return}}c.e||(c.e=!0),c.addDocument(b)}_findLevenshtein(a,d,e,f,g){let h=[{node:this,index:d,tolerance:e}];for(;h.length>0;){let{node:d,index:e,tolerance:i}=h.pop();if(d.w.startsWith(a)){d.findAllWords(g,a,!1,0);continue}if(i<0)continue;if(d.e){let{w:e,d:h}=d;if(e&&((0,b.syncBoundedLevenshtein)(a,e,f).isBounded&&(g[e]=[]),void 0!==(0,c.getOwnProperty)(g,e)&&h.size>0)){let a=new Set(g[e]);for(let b of h)a.add(b);g[e]=Array.from(a)}}if(e>=a.length)continue;let j=a[e];if(d.c.has(j)){let a=d.c.get(j);h.push({node:a,index:e+1,tolerance:i})}for(let[a,b]of(h.push({node:d,index:e+1,tolerance:i-1}),d.c))h.push({node:b,index:e,tolerance:i-1}),a!==j&&h.push({node:b,index:e+1,tolerance:i-1})}}find(a){let{term:b,exact:c,tolerance:d}=a;if(d&&!c){let a={};return this._findLevenshtein(b,0,d,d,a),a}{let a=this,e=0,f=b.length;for(;e<f;){let g=b[e],h=a.c.get(g);if(!h)return{};{let g=h.s,i=g.length,j=0;for(;j<i&&e+j<f&&g[j]===b[e+j];)j++;if(j===i)a=h,e+=j;else{if(e+j!==f||j!==f-e||c)return{};let a={};return h.findAllWords(a,b,c,d),a}}}let g={};return a.findAllWords(g,b,c,d),g}}contains(a){let b=this,c=0,d=a.length;for(;c<d;){let e=a[c],f=b.c.get(e);if(!f)return!1;{let e=f.s,g=e.length,h=0;for(;h<g&&c+h<d&&e[h]===a[c+h];)h++;if(h<g)return!1;c+=g,b=f}}return!0}removeWord(a){if(!a)return!1;let b=this,c=a.length,d=[];for(let e=0;e<c;e++){let c=a[e];if(!b.c.has(c))return!1;{let a=b.c.get(c);d.push({parent:b,character:c}),e+=a.s.length-1,b=a}}for(b.d.clear(),b.e=!1;d.length>0&&0===b.c.size&&!b.e&&0===b.d.size;){let{parent:a,character:c}=d.pop();a.c.delete(c),b=a}return!0}removeDocumentByWord(a,b,c=!0){if(!a)return!0;let d=this,e=a.length;for(let f=0;f<e;f++){let e=a[f];if(!d.c.has(e))return!1;{let g=d.c.get(e);f+=g.s.length-1,d=g,c&&d.w!==a||d.removeDocument(b)}}return!0}static getCommonPrefix(a,b){let c=Math.min(a.length,b.length),d=0;for(;d<c&&a.charCodeAt(d)===b.charCodeAt(d);)d++;return a.slice(0,d)}toJSON(){return{w:this.w,s:this.s,e:this.e,k:this.k,d:Array.from(this.d),c:Array.from(this.c?.entries())?.map(([a,b])=>[a,b.toJSON()])}}static fromJSON(a){let b=new d(a.k,a.s,a.e);return b.w=a.w,b.d=new Set(a.d),b.c=new Map(a?.c?.map(([a,b])=>[a,d.fromJSON(b)])),b}}class e extends d{constructor(){super("","",!1)}static fromJSON(a){let b=new e;return b.w=a.w,b.s=a.s,b.e=a.e,b.k=a.k,b.d=new Set(a.d),b.c=new Map(a.c?.map(([a,b])=>[a,d.fromJSON(b)])),b}toJSON(){return super.toJSON()}}},20819:a=>{"use strict";a.s({BKDTree:()=>c});class b{point;docIDs;left;right;parent;constructor(a,b){this.point=a,this.docIDs=new Set(b),this.left=null,this.right=null,this.parent=null}toJSON(){return{point:this.point,docIDs:Array.from(this.docIDs),left:this.left?this.left.toJSON():null,right:this.right?this.right.toJSON():null}}static fromJSON(a,c=null){let d=new b(a.point,a.docIDs);return d.parent=c,a.left&&(d.left=b.fromJSON(a.left,d)),a.right&&(d.right=b.fromJSON(a.right,d)),d}}class c{root;nodeMap;constructor(){this.root=null,this.nodeMap=new Map}getPointKey(a){return`${a.lon},${a.lat}`}insert(a,c){let d=this.getPointKey(a),e=this.nodeMap.get(d);if(e)return void c.forEach(a=>e.docIDs.add(a));let f=new b(a,c);if(this.nodeMap.set(d,f),null==this.root){this.root=f;return}let g=this.root,h=0;for(;;){if(0==h%2)if(a.lon<g.point.lon){if(null==g.left){g.left=f,f.parent=g;return}g=g.left}else{if(null==g.right){g.right=f,f.parent=g;return}g=g.right}else if(a.lat<g.point.lat){if(null==g.left){g.left=f,f.parent=g;return}g=g.left}else{if(null==g.right){g.right=f,f.parent=g;return}g=g.right}h++}}contains(a){let b=this.getPointKey(a);return this.nodeMap.has(b)}getDocIDsByCoordinates(a){let b=this.getPointKey(a),c=this.nodeMap.get(b);return c?Array.from(c.docIDs):null}removeDocByID(a,b){let c=this.getPointKey(a),d=this.nodeMap.get(c);d&&(d.docIDs.delete(b),0===d.docIDs.size&&(this.nodeMap.delete(c),this.deleteNode(d)))}deleteNode(a){let b=a.parent,c=a.left?a.left:a.right;c&&(c.parent=b),b?b.left===a?b.left=c:b.right===a&&(b.right=c):(this.root=c,this.root&&(this.root.parent=null))}searchByRadius(a,b,d=!0,e="asc",f=!1){let g=f?c.vincentyDistance:c.haversineDistance,h=[{node:this.root,depth:0}],i=[];for(;h.length>0;){let{node:c,depth:e}=h.pop();if(null==c)continue;let f=g(a,c.point);(d?f<=b:f>b)&&i.push({point:c.point,docIDs:Array.from(c.docIDs)}),null!=c.left&&h.push({node:c.left,depth:e+1}),null!=c.right&&h.push({node:c.right,depth:e+1})}return e&&i.sort((b,c)=>{let d=g(a,b.point),f=g(a,c.point);return"asc"===e.toLowerCase()?d-f:f-d}),i}searchByPolygon(a,b=!0,d=null,e=!1){let f=[{node:this.root,depth:0}],g=[];for(;f.length>0;){let{node:d,depth:e}=f.pop();if(null==d)continue;null!=d.left&&f.push({node:d.left,depth:e+1}),null!=d.right&&f.push({node:d.right,depth:e+1});let h=c.isPointInPolygon(a,d.point);(h&&b||!h&&!b)&&g.push({point:d.point,docIDs:Array.from(d.docIDs)})}let h=c.calculatePolygonCentroid(a);if(d){let a=e?c.vincentyDistance:c.haversineDistance;g.sort((b,c)=>{let e=a(h,b.point),f=a(h,c.point);return"asc"===d.toLowerCase()?e-f:f-e})}return g}toJSON(){return{root:this.root?this.root.toJSON():null}}static fromJSON(a){let d=new c;return a.root&&(d.root=b.fromJSON(a.root),d.buildNodeMap(d.root)),d}buildNodeMap(a){if(null==a)return;let b=this.getPointKey(a.point);this.nodeMap.set(b,a),a.left&&this.buildNodeMap(a.left),a.right&&this.buildNodeMap(a.right)}static calculatePolygonCentroid(a){let b=0,c=0,d=0,e=a.length;for(let f=0,g=e-1;f<e;g=f++){let e=a[f].lon,h=a[f].lat,i=a[g].lon,j=a[g].lat,k=e*j-i*h;b+=k,c+=(e+i)*k,d+=(h+j)*k}let f=6*(b/=2);return{lon:c/=f,lat:d/=f}}static isPointInPolygon(a,b){let c=!1,d=b.lon,e=b.lat,f=a.length;for(let b=0,g=f-1;b<f;g=b++){let f=a[b].lon,h=a[b].lat,i=a[g].lon,j=a[g].lat;h>e!=j>e&&d<(i-f)*(e-h)/(j-h)+f&&(c=!c)}return c}static haversineDistance(a,b){let c=Math.PI/180,d=a.lat*c,e=b.lat*c,f=(b.lat-a.lat)*c,g=(b.lon-a.lon)*c,h=Math.sin(f/2)*Math.sin(f/2)+Math.cos(d)*Math.cos(e)*Math.sin(g/2)*Math.sin(g/2);return 2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))*6371e3}static vincentyDistance(a,b){let c,d,e,f,g,h,i,j=1/298.257223563,k=(1-1/298.257223563)*6378137,l=Math.PI/180,m=a.lat*l,n=b.lat*l,o=(b.lon-a.lon)*l,p=Math.atan((1-j)*Math.tan(m)),q=Math.atan((1-j)*Math.tan(n)),r=Math.sin(p),s=Math.cos(p),t=Math.sin(q),u=Math.cos(q),v=o,w=1e3;do{let a=Math.sin(v),b=Math.cos(v);if(0===(d=Math.sqrt(u*a*(u*a)+(s*t-r*u*b)*(s*t-r*u*b))))return 0;f=Math.atan2(d,e=r*t+s*u*b),isNaN(i=e-2*r*t/(h=1-(g=s*u*a/d)*g))&&(i=0);let k=j/16*h*(4+j*(4-3*h));c=v,v=o+(1-k)*j*g*(f+k*d*(i+k*e*(-1+2*i*i)))}while(Math.abs(v-c)>1e-12&&--w>0)if(0===w)return NaN;let x=h*(0x24ffb2985f71-k*k)/(k*k),y=1+x/16384*(4096+x*(-768+x*(320-175*x))),z=x/1024*(256+x*(-128+x*(74-47*x)));return k*y*(f-z*d*(i+z/4*(e*(-1+2*i*i)-z/6*i*(-3+4*d*d)*(-3+4*i*i))))}}},87010:a=>{"use strict";a.s({BoolNode:()=>b});class b{true;false;constructor(){this.true=new Set,this.false=new Set}insert(a,b){b?this.true.add(a):this.false.add(a)}delete(a,b){b?this.true.delete(a):this.false.delete(a)}getSize(){return this.true.size+this.false.size}toJSON(){return{true:Array.from(this.true),false:Array.from(this.false)}}static fromJSON(a){let c=new b;return c.true=new Set(a.true),c.false=new Set(a.false),c}}},26838:a=>{"use strict";function b(a,b,c,d,e,{k:f,b:g,d:h}){return Math.log(1+(c-b+.5)/(b+.5))*(h+a*(f+1))/(a+f*(1-g+g*d/e))}a.s({BM25:()=>b}),a.i(15905)},90845:a=>{"use strict";a.s({DEFAULT_SIMILARITY:()=>b,VectorIndex:()=>c});let b=.8;class c{size;vectors=new Map;constructor(a){this.size=a}add(a,b){b instanceof Float32Array||(b=new Float32Array(b));let c=d(b,this.size);this.vectors.set(a,[c,b])}remove(a){this.vectors.delete(a)}find(a,b,c){return a instanceof Float32Array||(a=new Float32Array(a)),function(a,b,c,e,f){let g=d(a,e),h=[];for(let d of b||c.keys()){let b=c.get(d);if(!b)continue;let i=b[0],j=b[1],k=0;for(let b=0;b<e;b++)k+=a[b]*j[b];let l=k/(g*i);l>=f&&h.push([d,l])}return h}(a,c,this.vectors,this.size,b)}toJSON(){let a=[];for(let[b,[c,d]]of this.vectors)a.push([b,[c,Array.from(d)]]);return{size:this.size,vectors:a}}static fromJSON(a){let b=new c(a.size);for(let[c,[d,e]]of a.vectors)b.vectors.set(c,[d,new Float32Array(e)]);return b}}function d(a,b){let c=0;for(let d=0;d<b;d++)c+=a[d]*a[d];return Math.sqrt(c)}},79886:a=>{"use strict";a.s({createIndex:()=>z});var b=a.i(15905),c=a.i(94533),d=a.i(2552),e=a.i(51906),f=a.i(20819),g=a.i(87010),h=a.i(94919),i=a.i(26838);a.i(11988);var j=a.i(62675),k=a.i(80274),l=a.i(90845);function m(a,b,c,d,e){let f=(0,k.getInternalDocumentId)(a.sharedInternalDocumentStore,c);a.avgFieldLength[b]=((a.avgFieldLength[b]??0)*(e-1)+d.length)/e,a.fieldLengths[b][f]=d.length,a.frequencies[b][f]={}}function n(a,b,c,d,e){let f=0;for(let a of d)a===e&&f++;let g=(0,k.getInternalDocumentId)(a.sharedInternalDocumentStore,c),h=f/d.length;a.frequencies[b][g][e]=h,e in a.tokenOccurrences[b]||(a.tokenOccurrences[b][e]=0),a.tokenOccurrences[b][e]=(a.tokenOccurrences[b][e]??0)+1}function o(a,b,c,d){let e=(0,k.getInternalDocumentId)(a.sharedInternalDocumentStore,c);d>1?a.avgFieldLength[b]=(a.avgFieldLength[b]*d-a.fieldLengths[b][e])/(d-1):a.avgFieldLength[b]=void 0,a.fieldLengths[b][e]=void 0,a.frequencies[b][e]=void 0}function p(a,b,c){a.tokenOccurrences[b][c]--}function q(a,b,c,d,e,f,g,h,i,k,l){if((0,j.isVectorType)(g)){var m,n,o,p;return m=b,n=c,o=f,p=e,void m.vectorIndexes[n].node.add(p,o)}let q=d=>{let{type:f,node:g}=b.indexes[c];switch(f){case"Bool":g[d?"true":"false"].add(e);break;case"AVL":{let a=l?.avlRebalanceThreshold??1;g.insert(d,e,a);break}case"Radix":{let f=i.tokenize(d,h,c,!1);for(let d of(a.insertDocumentScoreParameters(b,c,e,f,k),f))a.insertTokenScoreParameters(b,c,e,f,d),g.insert(d,e);break}case"Flat":g.insert(d,e);break;case"BKD":g.insert(d,[e])}};if(!(0,j.isArrayType)(g))return q(f);let r=f.length;for(let a=0;a<r;a++)q(f[a])}function r(a,b,c,d,e,f,g,h,i,k){if((0,j.isVectorType)(g))return b.vectorIndexes[c].node.remove(e),!0;let{type:l,node:m}=b.indexes[c];switch(l){case"AVL":return m.removeDocument(f,e),!0;case"Bool":return m[f?"true":"false"].delete(e),!0;case"Radix":{let g=i.tokenize(f,h,c);for(let f of(a.removeDocumentScoreParameters(b,c,d,k),g))a.removeTokenScoreParameters(b,c,f),m.removeDocumentByWord(f,e);return!0}case"Flat":return m.removeDocument(e,f),!0;case"BKD":return m.removeDocByID(f,e),!1}}function s(a,b,c,d,e,f,g,h,i,k){if(!(0,j.isArrayType)(g))return r(a,b,c,d,e,f,g,h,i,k);let l=(0,j.getInnerType)(g),m=f.length;for(let g=0;g<m;g++)r(a,b,c,d,e,f[g],l,h,i,k);return!0}function t(a,b,c,d,e,f,g,h,j,k){let l=Array.from(d),m=a.avgFieldLength[b],n=a.fieldLengths[b],o=a.tokenOccurrences[b],p=a.frequencies[b],q="number"==typeof o[c]?o[c]??0:0,r=l.length;for(let a=0;a<r;a++){let d=l[a];if(j&&!j.has(d))continue;k.has(d)||k.set(d,new Map);let o=k.get(d);o.set(b,(o.get(b)||0)+1);let r=p?.[d]?.[c]??0,s=(0,i.BM25)(r,q,e,n[d],m,f);g.has(d)?g.set(d,g.get(d)+s*h):g.set(d,s*h)}}function u(a,c,d,e,f,g,h,i,j,k,l,m=0){let n=d.tokenize(c,e),o=n.length||1,p=new Map,q=new Map,r=new Map;for(let d of f){if(!(d in a.indexes))continue;let e=a.indexes[d],{type:f}=e;if("Radix"!==f)throw(0,b.createError)("WRONG_SEARCH_PROPERTY_TYPE",d);let m=i[d]??1;if(m<=0)throw(0,b.createError)("INVALID_BOOST_VALUE",m);0!==n.length||c||n.push("");let o=n.length;for(let b=0;b<o;b++){let c=n[b],f=e.node.find({term:c,exact:g,tolerance:h}),i=Object.keys(f);i.length>0&&q.set(c,!0);let o=i.length;for(let b=0;b<o;b++){let c=i[b],e=f[c];t(a,d,c,e,k,j,r,m,l,p)}}}let s=Array.from(r.entries()).map(([a,b])=>[a,b]).sort((a,b)=>b[1]-a[1]);if(0===s.length)return[];if(1===m)return s;if(0===m){if(1===o)return s;for(let a of n)if(!q.get(a))return[];return s.filter(([a])=>{let b=p.get(a);return!!b&&Array.from(b.values()).some(a=>a===o)})}let v=s.filter(([a])=>{let b=p.get(a);return!!b&&Array.from(b.values()).some(a=>a===o)});if(v.length>0){let a=s.filter(([a])=>!v.some(([b])=>b===a)),b=Math.ceil(a.length*m);return[...v,...a.slice(0,b)]}return s}function v(a){return a.searchableProperties}function w(a){return a.searchablePropertiesWithTypes}function x(a,b){let{indexes:h,vectorIndexes:i,searchableProperties:j,searchablePropertiesWithTypes:k,frequencies:m,tokenOccurrences:n,avgFieldLength:o,fieldLengths:p}=b,q={},r={};for(let a of Object.keys(h)){let{node:b,type:i,isArray:j}=h[a];switch(i){case"Radix":q[a]={type:"Radix",node:e.RadixTree.fromJSON(b),isArray:j};break;case"Flat":q[a]={type:"Flat",node:d.FlatTree.fromJSON(b),isArray:j};break;case"AVL":q[a]={type:"AVL",node:c.AVLTree.fromJSON(b),isArray:j};break;case"BKD":q[a]={type:"BKD",node:f.BKDTree.fromJSON(b),isArray:j};break;case"Bool":q[a]={type:"Bool",node:g.BoolNode.fromJSON(b),isArray:j};break;default:q[a]=h[a]}}for(let a of Object.keys(i))r[a]={type:"Vector",isArray:!1,node:l.VectorIndex.fromJSON(i[a])};return{sharedInternalDocumentStore:a,indexes:q,vectorIndexes:r,searchableProperties:j,searchablePropertiesWithTypes:k,frequencies:m,tokenOccurrences:n,avgFieldLength:o,fieldLengths:p}}function y(a){let{indexes:b,vectorIndexes:c,searchableProperties:d,searchablePropertiesWithTypes:e,frequencies:f,tokenOccurrences:g,avgFieldLength:h,fieldLengths:i}=a,j={};for(let a of Object.keys(c))j[a]=c[a].node.toJSON();let k={};for(let a of Object.keys(b)){let{type:c,node:d,isArray:e}=b[a];"Flat"===c||"Radix"===c||"AVL"===c||"BKD"===c||"Bool"===c?k[a]={type:c,node:d.toJSON(),isArray:e}:(k[a]=b[a],k[a].node=k[a].node.toJSON())}return{indexes:k,vectorIndexes:j,searchableProperties:d,searchablePropertiesWithTypes:e,frequencies:f,tokenOccurrences:g,avgFieldLength:h,fieldLengths:i}}function z(){return{create:function a(h,i,k,m,n=""){for(let[o,p]of(m||(m={sharedInternalDocumentStore:i,indexes:{},vectorIndexes:{},searchableProperties:[],searchablePropertiesWithTypes:{},frequencies:{},tokenOccurrences:{},avgFieldLength:{},fieldLengths:{}}),Object.entries(k))){let k=`${n}${n?".":""}${o}`;if("object"==typeof p&&!Array.isArray(p)){a(h,i,p,m,k);continue}if((0,j.isVectorType)(p))m.searchableProperties.push(k),m.searchablePropertiesWithTypes[k]=p,m.vectorIndexes[k]={type:"Vector",node:new l.VectorIndex((0,j.getVectorSize)(p)),isArray:!1};else{let a=/\[/.test(p);switch(p){case"boolean":case"boolean[]":m.indexes[k]={type:"Bool",node:new g.BoolNode,isArray:a};break;case"number":case"number[]":m.indexes[k]={type:"AVL",node:new c.AVLTree(0,[]),isArray:a};break;case"string":case"string[]":m.indexes[k]={type:"Radix",node:new e.RadixTree,isArray:a},m.avgFieldLength[k]=0,m.frequencies[k]={},m.tokenOccurrences[k]={},m.fieldLengths[k]={};break;case"enum":case"enum[]":m.indexes[k]={type:"Flat",node:new d.FlatTree,isArray:a};break;case"geopoint":m.indexes[k]={type:"BKD",node:new f.BKDTree,isArray:a};break;default:throw(0,b.createError)("INVALID_SCHEMA_TYPE",Array.isArray(p)?"array":p,k)}m.searchableProperties.push(k),m.searchablePropertiesWithTypes[k]=p}}return m},insert:q,remove:s,insertDocumentScoreParameters:m,insertTokenScoreParameters:n,removeDocumentScoreParameters:o,removeTokenScoreParameters:p,calculateResultScores:t,search:u,searchByWhereClause:function a(c,d,e,f){if("and"in e&&e.and&&Array.isArray(e.and)){let b=e.and;if(0===b.length)return new Set;let g=b.map(b=>a(c,d,b,f));return(0,h.setIntersection)(...g)}if("or"in e&&e.or&&Array.isArray(e.or)){let b=e.or;return 0===b.length?new Set:b.map(b=>a(c,d,b,f)).reduce((a,b)=>(0,h.setUnion)(a,b),new Set)}if("not"in e&&e.not){let b=e.not,g=new Set,i=c.sharedInternalDocumentStore;for(let a=1;a<=i.internalIdToId.length;a++)g.add(a);let j=a(c,d,b,f);return(0,h.setDifference)(g,j)}let g=Object.keys(e),i=g.reduce((a,b)=>({[b]:new Set,...a}),{});for(let a of g){let g=e[a];if(void 0===c.indexes[a])throw(0,b.createError)("UNKNOWN_FILTER_PROPERTY",a);let{node:j,type:k,isArray:l}=c.indexes[a];if("Bool"===k){let b=g?j.true:j.false;i[a]=(0,h.setUnion)(i[a],b);continue}if("BKD"===k){let b;if("radius"in g)b="radius";else if("polygon"in g)b="polygon";else throw Error(`Invalid operation ${g}`);if("radius"===b){let{value:c,coordinates:d,unit:e="m",inside:f=!0,highPrecision:k=!1}=g[b],l=(0,h.convertDistanceToMeters)(c,e),m=j.searchByRadius(d,l,f,void 0,k);i[a]=A(i[a],m)}else{let{coordinates:c,inside:d=!0,highPrecision:e=!1}=g[b],f=j.searchByPolygon(c,d,void 0,e);i[a]=A(i[a],f)}continue}if("Radix"===k&&("string"==typeof g||Array.isArray(g))){for(let b of[g].flat())for(let c of d.tokenize(b,f,a)){let b=j.find({term:c,exact:!0});i[a]=function(a,b){a||(a=new Set);let c=Object.keys(b),d=c.length;for(let e=0;e<d;e++){let d=b[c[e]],f=d.length;for(let b=0;b<f;b++)a.add(d[b])}return a}(i[a],b)}continue}let m=Object.keys(g);if(m.length>1)throw(0,b.createError)("INVALID_FILTER_OPERATION",m.length);if("Flat"===k){let b=new Set(l?j.filterArr(g):j.filter(g));i[a]=(0,h.setUnion)(i[a],b);continue}if("AVL"===k){let c,d=m[0],e=g[d];switch(d){case"gt":c=j.greaterThan(e,!1);break;case"gte":c=j.greaterThan(e,!0);break;case"lt":c=j.lessThan(e,!1);break;case"lte":c=j.lessThan(e,!0);break;case"eq":c=j.find(e)??new Set;break;case"between":{let[a,b]=e;c=j.rangeSearch(a,b);break}default:throw(0,b.createError)("INVALID_FILTER_OPERATION",d)}i[a]=(0,h.setUnion)(i[a],c)}}return(0,h.setIntersection)(...Object.values(i))},getSearchableProperties:v,getSearchablePropertiesWithTypes:w,load:x,save:y}}function A(a,b){a||(a=new Set);let c=b.length;for(let d=0;d<c;d++){let c=b[d].docIDs,e=c.length;for(let b=0;b<e;b++)a.add(c[b])}return a}},90856:a=>{"use strict";a.s({createSorter:()=>t});var b=a.i(15905);a.i(11988);var c=a.i(62675),d=a.i(80274),e=a.i(94919),f=a.i(99468);function g(a,d,f,g){return g?.enabled===!1?{disabled:!0}:function a(d,f,g,h,i){let j={language:d.tokenizer.language,sharedInternalDocumentStore:f,enabled:!0,isSorted:!0,sortableProperties:[],sortablePropertiesWithTypes:{},sorts:{}};for(let[k,l]of Object.entries(g)){let g=`${i}${i?".":""}${k}`;if(!h.includes(g)){if("object"==typeof l&&!Array.isArray(l)){let b=a(d,f,l,h,g);(0,e.safeArrayPush)(j.sortableProperties,b.sortableProperties),j.sorts={...j.sorts,...b.sorts},j.sortablePropertiesWithTypes={...j.sortablePropertiesWithTypes,...b.sortablePropertiesWithTypes};continue}if(!(0,c.isVectorType)(l))switch(l){case"boolean":case"number":case"string":j.sortableProperties.push(g),j.sortablePropertiesWithTypes[g]=l,j.sorts[g]={docs:new Map,orderedDocsToRemove:new Map,orderedDocs:[],type:l};break;case"geopoint":case"enum":case"enum[]":case"boolean[]":case"number[]":case"string[]":continue;default:throw(0,b.createError)("INVALID_SORT_SCHEMA_TYPE",Array.isArray(l)?"array":l,g)}}}return j}(a,d,f,(g||{}).unsortableProperties||[],"")}function h(a,b,c,e){if(!a.enabled)return;a.isSorted=!1;let f=(0,d.getInternalDocumentId)(a.sharedInternalDocumentStore,c),g=a.sorts[b];g.orderedDocsToRemove.has(f)&&m(a,b),g.docs.set(f,g.orderedDocs.length),g.orderedDocs.push([f,e])}function i(a){if(!a.isSorted&&a.enabled){for(let b of Object.keys(a.sorts))!function(a,b){let c,d=a.sorts[b];switch(d.type){case"string":c=j.bind(null,a.language);break;case"number":c=k.bind(null);break;case"boolean":c=l.bind(null)}d.orderedDocs.sort(c);let e=d.orderedDocs.length;for(let a=0;a<e;a++){let b=d.orderedDocs[a][0];d.docs.set(b,a)}}(a,b);a.isSorted=!0}}function j(a,b,c){return b[1].localeCompare(c[1],(0,f.getLocale)(a))}function k(a,b){return a[1]-b[1]}function l(a,b){return b[1]?-1:1}function m(a,b){let c=a.sorts[b];c.orderedDocsToRemove.size&&(c.orderedDocs=c.orderedDocs.filter(a=>!c.orderedDocsToRemove.has(a[0])),c.orderedDocsToRemove.clear())}function n(a,b,c){if(!a.enabled)return;let e=a.sorts[b],f=(0,d.getInternalDocumentId)(a.sharedInternalDocumentStore,c);e.docs.get(f)&&(e.docs.delete(f),e.orderedDocsToRemove.set(f,!0))}function o(a,c,e){if(!a.enabled)throw(0,b.createError)("SORT_DISABLED");let f=e.property,g="DESC"===e.order,h=a.sorts[f];if(!h)throw(0,b.createError)("UNABLE_TO_SORT_ON_UNKNOWN_FIELD",f,a.sortableProperties.join(", "));return m(a,f),i(a),c.sort((b,c)=>{let e=h.docs.get((0,d.getInternalDocumentId)(a.sharedInternalDocumentStore,b[0])),f=h.docs.get((0,d.getInternalDocumentId)(a.sharedInternalDocumentStore,c[0])),i=void 0!==e,j=void 0!==f;return i||j?i?j?g?f-e:e-f:-1:1:0}),c}function p(a){return a.enabled?a.sortableProperties:[]}function q(a){return a.enabled?a.sortablePropertiesWithTypes:{}}function r(a,b){if(!b.enabled)return{enabled:!1};let c=Object.keys(b.sorts).reduce((a,c)=>{let{docs:d,orderedDocs:e,type:f}=b.sorts[c];return a[c]={docs:new Map(Object.entries(d).map(([a,b])=>[+a,b])),orderedDocsToRemove:new Map,orderedDocs:e,type:f},a},{});return{sharedInternalDocumentStore:a,language:b.language,sortableProperties:b.sortableProperties,sortablePropertiesWithTypes:b.sortablePropertiesWithTypes,sorts:c,enabled:!0,isSorted:b.isSorted}}function s(a){if(!a.enabled)return{enabled:!1};for(let b of Object.keys(a.sorts))m(a,b);i(a);let b=Object.keys(a.sorts).reduce((b,c)=>{let{docs:d,orderedDocs:e,type:f}=a.sorts[c];return b[c]={docs:Object.fromEntries(d.entries()),orderedDocs:e,type:f},b},{});return{language:a.language,sortableProperties:a.sortableProperties,sortablePropertiesWithTypes:a.sortablePropertiesWithTypes,sorts:b,enabled:a.enabled,isSorted:a.isSorted}}function t(){return{create:g,insert:h,remove:n,save:s,load:r,sortBy:o,getSortableProperties:p,getSortablePropertiesWithTypes:q}}},38112:a=>{"use strict";a.s({replaceDiacritics:()=>c});let b=[65,65,65,65,65,65,65,67,69,69,69,69,73,73,73,73,69,78,79,79,79,79,79,null,79,85,85,85,85,89,80,115,97,97,97,97,97,97,97,99,101,101,101,101,105,105,105,105,101,110,111,111,111,111,111,null,111,117,117,117,117,121,112,121,65,97,65,97,65,97,67,99,67,99,67,99,67,99,68,100,68,100,69,101,69,101,69,101,69,101,69,101,71,103,71,103,71,103,71,103,72,104,72,104,73,105,73,105,73,105,73,105,73,105,73,105,74,106,75,107,107,76,108,76,108,76,108,76,108,76,108,78,110,78,110,78,110,110,78,110,79,111,79,111,79,111,79,111,82,114,82,114,82,114,83,115,83,115,83,115,83,115,84,116,84,116,84,116,85,117,85,117,85,117,85,117,85,117,85,117,87,119,89,121,89,90,122,90,122,90,122,115];function c(a){let c=[];for(let e=0;e<a.length;e++){var d;c[e]=(d=a.charCodeAt(e))<192||d>383?d:b[d-192]||d}return String.fromCharCode(...c)}},3340:a=>{"use strict";a.s({stemmer:()=>k});let b={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},c={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},d="[aeiouy]",e="[^aeiou][^aeiouy]*",f=d+"[aeiou]*",g="^("+e+")?"+f+e,h="^("+e+")?"+f+e+"("+f+")?$",i="^("+e+")?"+f+e+f+e,j="^("+e+")?"+d;function k(a){let f,k,l,m,n,o;if(a.length<3)return a;let p=a.substring(0,1);if("y"==p&&(a=p.toUpperCase()+a.substring(1)),m=/^(.+?)([^s])s$/,(l=/^(.+?)(ss|i)es$/).test(a)?a=a.replace(l,"$1$2"):m.test(a)&&(a=a.replace(m,"$1$2")),m=/^(.+?)(ed|ing)$/,(l=/^(.+?)eed$/).test(a)){let b=l.exec(a);(l=new RegExp(g)).test(b[1])&&(l=/.$/,a=a.replace(l,""))}else m.test(a)&&(f=m.exec(a)[1],(m=new RegExp(j)).test(f)&&(a=f,m=/(at|bl|iz)$/,n=RegExp("([^aeiouylsz])\\1$"),o=RegExp("^"+e+d+"[^aeiouwxy]$"),m.test(a)?a+="e":n.test(a)?(l=/.$/,a=a.replace(l,"")):o.test(a)&&(a+="e")));if((l=/^(.+?)y$/).test(a)){let b=l.exec(a);f=b?.[1],l=new RegExp(j),f&&l.test(f)&&(a=f+"i")}if((l=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/).test(a)){let c=l.exec(a);f=c?.[1],k=c?.[2],l=new RegExp(g),f&&l.test(f)&&(a=f+b[k])}if((l=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/).test(a)){let b=l.exec(a);f=b?.[1],k=b?.[2],l=new RegExp(g),f&&l.test(f)&&(a=f+c[k])}if(m=/^(.+?)(s|t)(ion)$/,(l=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/).test(a)){let b=l.exec(a);f=b?.[1],l=new RegExp(i),f&&l.test(f)&&(a=f)}else if(m.test(a)){let b=m.exec(a);f=b?.[1]??""+b?.[2]??"",(m=new RegExp(i)).test(f)&&(a=f)}if((l=/^(.+?)e$/).test(a)){let b=l.exec(a);f=b?.[1],l=new RegExp(i),m=new RegExp(h),n=RegExp("^"+e+d+"[^aeiouwxy]$"),f&&(l.test(f)||m.test(f)&&!n.test(f))&&(a=f)}return l=/ll$/,m=new RegExp(i),l.test(a)&&m.test(a)&&(l=/.$/,a=a.replace(l,"")),"y"==p&&(a=p.toLowerCase()+a.substring(1)),a}},87094:a=>{"use strict";a.s({createTokenizer:()=>h});var b=a.i(15905),c=a.i(38112),d=a.i(99468),e=a.i(3340);function f(a,b,d=!0){let e=`${this.language}:${a}:${b}`;return d&&this.normalizationCache.has(e)?this.normalizationCache.get(e):this.stopWords?.includes(b)?(d&&this.normalizationCache.set(e,""),""):(this.stemmer&&!this.stemmerSkipProperties.has(a)&&(b=this.stemmer(b)),b=(0,c.replaceDiacritics)(b),d&&this.normalizationCache.set(e,b),b)}function g(a,c,e,f=!0){let h;if(c&&c!==this.language)throw(0,b.createError)("LANGUAGE_NOT_SUPPORTED",c);if("string"!=typeof a)return[a];let i=this.normalizeToken.bind(this,e??"");if(e&&this.tokenizeSkipProperties.has(e))h=[i(a,f)];else{let b=d.SPLITTERS[this.language];h=a.toLowerCase().split(b).map(a=>i(a,f)).filter(Boolean)}let j=function(a){for(;""===a[a.length-1];)a.pop();for(;""===a[0];)a.shift();return a}(h);return this.allowDuplicates?j:Array.from(new Set(j))}function h(a={}){let c,i;if(a.language){if(!d.SUPPORTED_LANGUAGES.includes(a.language))throw(0,b.createError)("LANGUAGE_NOT_SUPPORTED",a.language)}else a.language="english";if(a.stemming||a.stemmer&&!("stemming"in a))if(a.stemmer){if("function"!=typeof a.stemmer)throw(0,b.createError)("INVALID_STEMMER_FUNCTION_TYPE");c=a.stemmer}else if("english"===a.language)c=e.stemmer;else throw(0,b.createError)("MISSING_STEMMER",a.language);if(!1!==a.stopWords){if(i=[],Array.isArray(a.stopWords))i=a.stopWords;else if("function"==typeof a.stopWords)i=a.stopWords(i);else if(a.stopWords)throw(0,b.createError)("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY");if(!Array.isArray(i))throw(0,b.createError)("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY");for(let a of i)if("string"!=typeof a)throw(0,b.createError)("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY")}let j={tokenize:g,language:a.language,stemmer:c,stemmerSkipProperties:new Set(a.stemmerSkipProperties?[a.stemmerSkipProperties].flat():[]),tokenizeSkipProperties:new Set(a.tokenizeSkipProperties?[a.tokenizeSkipProperties].flat():[]),stopWords:i,allowDuplicates:!!a.allowDuplicates,normalizeToken:f,normalizationCache:new Map};return j.tokenize=g.bind(j),j.normalizeToken=f,j}},64731:a=>{"use strict";a.s({create:()=>l}),a.i(11988);var b=a.i(62675),c=a.i(94919),d=a.i(47181),e=a.i(2648),f=a.i(97973),g=a.i(79886),h=a.i(80274),i=a.i(90856),j=a.i(87094),k=a.i(15905);function l({schema:a,sort:l,language:m,components:n,id:o,plugins:p}){for(let b of(n||(n={}),p??[])){if(!("getComponents"in b)||"function"!=typeof b.getComponents)continue;let c=b.getComponents(a);for(let a of Object.keys(c))if(n[a])throw(0,k.createError)("PLUGIN_COMPONENT_CONFLICT",a,b.name);n={...n,...c}}o||(o=(0,c.uniqueId)());let q=n.tokenizer,r=n.index,s=n.documentsStore,t=n.sorter;if(q=q?q.tokenize?q:(0,j.createTokenizer)(q):(0,j.createTokenizer)({language:m??"english"}),n.tokenizer&&m)throw(0,k.createError)("NO_LANGUAGE_WITH_CUSTOM_TOKENIZER");let u=(0,h.createInternalDocumentIDStore)();r||=(0,g.createIndex)(),t||=(0,i.createSorter)(),s||=(0,d.createDocumentsStore)();var v=n;let w={formatElapsedTime:b.formatElapsedTime,getDocumentIndexId:b.getDocumentIndexId,getDocumentProperties:c.getDocumentProperties,validateSchema:b.validateSchema};for(let a of f.FUNCTION_COMPONENTS)if(v[a]){if("function"!=typeof v[a])throw(0,k.createError)("COMPONENT_MUST_BE_FUNCTION",a)}else v[a]=w[a];for(let a of Object.keys(v))if(!f.OBJECT_COMPONENTS.includes(a)&&!f.FUNCTION_COMPONENTS.includes(a))throw(0,k.createError)("UNSUPPORTED_COMPONENT",a);let{getDocumentProperties:x,getDocumentIndexId:y,validateSchema:z,formatElapsedTime:A}=n,B={data:{},caches:{},schema:a,tokenizer:q,index:r,sorter:t,documentsStore:s,internalDocumentIDStore:u,getDocumentProperties:x,getDocumentIndexId:y,validateSchema:z,beforeInsert:[],afterInsert:[],beforeRemove:[],afterRemove:[],beforeUpdate:[],afterUpdate:[],beforeUpsert:[],afterUpsert:[],beforeSearch:[],afterSearch:[],beforeInsertMultiple:[],afterInsertMultiple:[],beforeRemoveMultiple:[],afterRemoveMultiple:[],beforeUpdateMultiple:[],afterUpdateMultiple:[],beforeUpsertMultiple:[],afterUpsertMultiple:[],afterCreate:[],formatElapsedTime:A,id:o,plugins:p,version:"{{VERSION}}"};for(let b of(B.data={index:B.index.create(B,u,a),docs:B.documentsStore.create(B,u),sorting:B.sorter.create(B,u,a,l)},e.AVAILABLE_PLUGIN_HOOKS))B[b]=(B[b]??[]).concat((0,e.getAllPluginsByHook)(B,b));let C=B.afterCreate;return C&&(0,f.runAfterCreate)(C,B),B}},81188:a=>{"use strict";function b(a,b){return a.documentsStore.get(a.data.docs,b)}function c(a){return a.documentsStore.count(a.data.docs)}a.s({count:()=>c,getByID:()=>b})},98772:a=>{"use strict";a.s({}),a.i(11988),a.i(47181),a.i(79886),a.i(87094),a.i(90856),a.i(80274)},94846:a=>{"use strict";a.s({}),a.i(11988),a.i(47181),a.i(79886),a.i(87094),a.i(90856),a.i(80274),a.i(98772)},17945:a=>{"use strict";a.s({innerInsertMultiple:()=>n,insert:()=>g}),a.i(94846);var b=a.i(62675),c=a.i(94919),d=a.i(97973),e=a.i(15905),f=a.i(80274);function g(a,b,g,h,i){let l=a.validateSchema(b,a.schema);if(l)throw(0,e.createError)("SCHEMA_VALIDATION_FAILURE",l);return(0,c.isAsyncFunction)(a.beforeInsert)||(0,c.isAsyncFunction)(a.afterInsert)||(0,c.isAsyncFunction)(a.index.beforeInsert)||(0,c.isAsyncFunction)(a.index.insert)||(0,c.isAsyncFunction)(a.index.afterInsert)?j(a,b,g,h,i):function(a,b,c,g,h){let{index:i,docs:j}=a.data,l=a.getDocumentIndexId(b);if("string"!=typeof l)throw(0,e.createError)("DOCUMENT_ID_MUST_BE_STRING",typeof l);let m=(0,f.getInternalDocumentId)(a.internalDocumentIDStore,l);if(!a.documentsStore.store(j,l,m,b))throw(0,e.createError)("DOCUMENT_ALREADY_EXISTS",l);let n=a.documentsStore.count(j);g||(0,d.runSingleHook)(a.beforeInsert,a,l,b);let o=a.index.getSearchableProperties(i),p=a.index.getSearchablePropertiesWithTypes(i),q=a.getDocumentProperties(b,o);for(let[a,b]of Object.entries(q))void 0!==b&&k(typeof b,p[a],a,b);return function(a,b,c,d,e,g,h,i){for(let h of c){let c=d[h];if(void 0===c)continue;let j=a.index.getSearchablePropertiesWithTypes(a.data.index)[h],k=(0,f.getInternalDocumentId)(a.internalDocumentIDStore,b);a.index.beforeInsert?.(a.data.index,h,b,c,j,g,a.tokenizer,e),a.index.insert(a.index,a.data.index,h,b,k,c,j,g,a.tokenizer,e,i),a.index.afterInsert?.(a.data.index,h,b,c,j,g,a.tokenizer,e)}let j=a.sorter.getSortableProperties(a.data.sorting),k=a.getDocumentProperties(h,j);for(let c of j){let d=k[c];if(void 0===d)continue;let e=a.sorter.getSortablePropertiesWithTypes(a.data.sorting)[c];a.sorter.insert(a.data.sorting,c,b,d,e,g)}}(a,l,o,q,n,c,b,h),g||(0,d.runSingleHook)(a.afterInsert,a,l,b),l}(a,b,g,h,i)}let h=new Set(["enum","enum[]"]),i=new Set(["string","number"]);async function j(a,b,c,g,h){let{index:i,docs:j}=a.data,m=a.getDocumentIndexId(b);if("string"!=typeof m)throw(0,e.createError)("DOCUMENT_ID_MUST_BE_STRING",typeof m);let n=(0,f.getInternalDocumentId)(a.internalDocumentIDStore,m);if(!a.documentsStore.store(j,m,n,b))throw(0,e.createError)("DOCUMENT_ALREADY_EXISTS",m);let o=a.documentsStore.count(j);g||await (0,d.runSingleHook)(a.beforeInsert,a,m,b);let p=a.index.getSearchableProperties(i),q=a.index.getSearchablePropertiesWithTypes(i),r=a.getDocumentProperties(b,p);for(let[a,b]of Object.entries(r))void 0!==b&&k(typeof b,q[a],a,b);return await l(a,m,p,r,o,c,b,h),g||await (0,d.runSingleHook)(a.afterInsert,a,m,b),m}function k(a,c,d,f){if(!((0,b.isGeoPointType)(c)&&"object"==typeof f&&"number"==typeof f.lon&&"number"==typeof f.lat||(0,b.isVectorType)(c)&&Array.isArray(f)||(0,b.isArrayType)(c)&&Array.isArray(f))&&!(h.has(c)&&i.has(a))&&a!==c)throw(0,e.createError)("INVALID_DOCUMENT_PROPERTY",d,c,a)}async function l(a,b,c,d,e,f,g,h){for(let g of c){let c=d[g];if(void 0===c)continue;let i=a.index.getSearchablePropertiesWithTypes(a.data.index)[g];await a.index.beforeInsert?.(a.data.index,g,b,c,i,f,a.tokenizer,e);let j=a.internalDocumentIDStore.idToInternalId.get(b);await a.index.insert(a.index,a.data.index,g,b,j,c,i,f,a.tokenizer,e,h),await a.index.afterInsert?.(a.data.index,g,b,c,i,f,a.tokenizer,e)}let i=a.sorter.getSortableProperties(a.data.sorting),j=a.getDocumentProperties(g,i);for(let c of i){let d=j[c];if(void 0===d)continue;let e=a.sorter.getSortablePropertiesWithTypes(a.data.sorting)[c];a.sorter.insert(a.data.sorting,c,b,d,e,f)}}async function m(a,b,e=1e3,f,h,i=0){let j=[],k=async c=>{let d=Math.min(c+e,b.length),i=b.slice(c,d);for(let b of i){let c={avlRebalanceThreshold:i.length},d=await g(a,b,f,h,c);j.push(d)}return d},l=async()=>{let a=0;for(;a<b.length;){let b=Date.now();if(a=await k(a),i>0){let a=i-(Date.now()-b);a>0&&(0,c.sleep)(a)}}};return await l(),h||await (0,d.runMultipleHook)(a.afterInsertMultiple,a,b),j}function n(a,b,e,f,h,i){return(0,c.isAsyncFunction)(a.beforeInsert)||(0,c.isAsyncFunction)(a.afterInsert)||(0,c.isAsyncFunction)(a.index.beforeInsert)||(0,c.isAsyncFunction)(a.index.insert)||(0,c.isAsyncFunction)(a.index.afterInsert)?m(a,b,e,f,h,i):function(a,b,e=1e3,f,h,i=0){let j=[],k=0,l=Date.now();for(;function(){let c=b.slice(k*e,(k+1)*e);if(0===c.length)return!1;for(let b of c){let d=g(a,b,f,h,{avlRebalanceThreshold:c.length});j.push(d)}return k++,!0}();)if(i>0){let a=Date.now()-l;if(a>=i){let b=i-a%i;b>0&&(0,c.sleep)(b)}}return h||(0,d.runMultipleHook)(a.afterInsertMultiple,a,b),j}(a,b,e,f,h,i)}},48855:a=>{"use strict";a.s({remove:()=>e,removeMultiple:()=>g});var b=a.i(97973),c=a.i(80274),d=a.i(94919);function e(a,e,g,h){return(0,d.isAsyncFunction)(a.index.beforeRemove)||(0,d.isAsyncFunction)(a.index.remove)||(0,d.isAsyncFunction)(a.index.afterRemove)?f(a,e,g,h):function(a,d,e,f){let g=!0,{index:h,docs:i}=a.data,j=a.documentsStore.get(i,d);if(!j)return!1;let k=(0,c.getInternalDocumentId)(a.internalDocumentIDStore,d),l=(0,c.getDocumentIdFromInternalId)(a.internalDocumentIDStore,k),m=a.documentsStore.count(i);f||(0,b.runSingleHook)(a.beforeRemove,a,l);let n=a.index.getSearchableProperties(h),o=a.index.getSearchablePropertiesWithTypes(h),p=a.getDocumentProperties(j,n);for(let b of n){let c=p[b];if(void 0===c)continue;let f=o[b];a.index.beforeRemove?.(a.data.index,b,l,c,f,e,a.tokenizer,m),a.index.remove(a.index,a.data.index,b,d,k,c,f,e,a.tokenizer,m)||(g=!1),a.index.afterRemove?.(a.data.index,b,l,c,f,e,a.tokenizer,m)}let q=a.sorter.getSortableProperties(a.data.sorting),r=a.getDocumentProperties(j,q);for(let b of q)void 0!==r[b]&&a.sorter.remove(a.data.sorting,b,d);return f||(0,b.runSingleHook)(a.afterRemove,a,l),a.documentsStore.remove(a.data.docs,d,k),g}(a,e,g,h)}async function f(a,d,e,f){let g=!0,{index:h,docs:i}=a.data,j=a.documentsStore.get(i,d);if(!j)return!1;let k=(0,c.getInternalDocumentId)(a.internalDocumentIDStore,d),l=(0,c.getDocumentIdFromInternalId)(a.internalDocumentIDStore,k),m=a.documentsStore.count(i);f||await (0,b.runSingleHook)(a.beforeRemove,a,l);let n=a.index.getSearchableProperties(h),o=a.index.getSearchablePropertiesWithTypes(h),p=a.getDocumentProperties(j,n);for(let b of n){let c=p[b];if(void 0===c)continue;let f=o[b];await a.index.beforeRemove?.(a.data.index,b,l,c,f,e,a.tokenizer,m),await a.index.remove(a.index,a.data.index,b,d,k,c,f,e,a.tokenizer,m)||(g=!1),await a.index.afterRemove?.(a.data.index,b,l,c,f,e,a.tokenizer,m)}let q=await a.sorter.getSortableProperties(a.data.sorting),r=await a.getDocumentProperties(j,q);for(let b of q)void 0!==r[b]&&a.sorter.remove(a.data.sorting,b,d);return f||await (0,b.runSingleHook)(a.afterRemove,a,l),a.documentsStore.remove(a.data.docs,d,k),g}function g(a,f,g,i,j){return(0,d.isAsyncFunction)(a.index.beforeRemove)||(0,d.isAsyncFunction)(a.index.remove)||(0,d.isAsyncFunction)(a.index.afterRemove)||(0,d.isAsyncFunction)(a.beforeRemoveMultiple)||(0,d.isAsyncFunction)(a.afterRemoveMultiple)?h(a,f,g,i,j):function(a,d,f,g,h){let i=0;f||(f=1e3);let j=h?[]:d.map(b=>(0,c.getDocumentIdFromInternalId)(a.internalDocumentIDStore,(0,c.getInternalDocumentId)(a.internalDocumentIDStore,b)));h||(0,b.runMultipleHook)(a.beforeRemoveMultiple,a,j);let k=0;return!function b(){let c=d.slice(k*f,++k*f);if(c.length){for(let b of c)e(a,b,g,h)&&i++;setTimeout(b,0)}}(),h||(0,b.runMultipleHook)(a.afterRemoveMultiple,a,j),i}(a,f,g,i,j)}async function h(a,d,f,g,h){let i=0;f||(f=1e3);let j=h?[]:d.map(b=>(0,c.getDocumentIdFromInternalId)(a.internalDocumentIDStore,(0,c.getInternalDocumentId)(a.internalDocumentIDStore,b)));return h||await (0,b.runMultipleHook)(a.beforeRemoveMultiple,a,j),await new Promise((b,c)=>{let j=0;async function k(){let l=d.slice(j*f,++j*f);if(!l.length)return b();for(let b of l)try{await e(a,b,g,h)&&i++}catch(a){c(a)}setTimeout(k,0)}setTimeout(k,0)}),h||await (0,b.runMultipleHook)(a.afterRemoveMultiple,a,j),i}},35108:a=>{"use strict";a.s({MODE_FULLTEXT_SEARCH:()=>b,MODE_HYBRID_SEARCH:()=>c,MODE_VECTOR_SEARCH:()=>d});let b="fulltext",c="hybrid",d="vector"},51443:a=>{"use strict";a.s({getFacets:()=>f});var b=a.i(15905),c=a.i(94919);function d(a,b){return a[1]-b[1]}function e(a,b){return b[1]-a[1]}function f(a,f,i){let j={},k=f.map(([a])=>a),l=a.documentsStore.getMultiple(a.data.docs,k),m=Object.keys(i),n=a.index.getSearchablePropertiesWithTypes(a.data.index);for(let a of m){let b;if("number"===n[a]){let{ranges:c}=i[a],d=c.length,e=Array.from({length:d});for(let a=0;a<d;a++){let b=c[a];e[a]=[`${b.from}-${b.to}`,0]}b=Object.fromEntries(e)}j[a]={count:0,values:b??{}}}let o=l.length;for(let a=0;a<o;a++){let d=l[a];for(let a of m){let e=a.includes(".")?(0,c.getNested)(d,a):d[a],f=n[a],k=j[a].values;switch(f){case"number":g(i[a].ranges,k)(e);break;case"number[]":{let b=new Set,c=g(i[a].ranges,k,b);for(let a of e)c(a);break}case"boolean":case"enum":case"string":h(k,f)(e);break;case"boolean[]":case"enum[]":case"string[]":{let a=h(k,"boolean[]"===f?"boolean":"string",new Set);for(let b of e)a(b);break}default:throw(0,b.createError)("FACET_NOT_SUPPORTED",f)}}}for(let a of m){let b=j[a];if(b.count=Object.keys(b.values).length,"string"===n[a]){let c=i[a],f=function(a="desc"){return"asc"===a.toLowerCase()?d:e}(c.sort);b.values=Object.fromEntries(Object.entries(b.values).sort(f).slice(c.offset??0,c.limit??10))}}return j}function g(a,b,c){return d=>{for(let e of a){let a=`${e.from}-${e.to}`;!c?.has(a)&&d>=e.from&&d<=e.to&&(void 0===b[a]?b[a]=1:(b[a]++,c?.add(a)))}}}function h(a,b,c){let d="boolean"===b?"false":"";return b=>{let e=b?.toString()??d;c?.has(e)||(a[e]=(a[e]??0)+1,c?.add(e))}}},70247:a=>{"use strict";a.s({getGroups:()=>g});var b=a.i(15905),c=a.i(94919),d=a.i(80274);let e={reducer:(a,b,c,d)=>(b[d]=c,b),getInitialValue:a=>Array.from({length:a})},f=["string","number","boolean"];function g(a,g,h){let i=h.properties,j=i.length,k=a.index.getSearchablePropertiesWithTypes(a.data.index);for(let a=0;a<j;a++){let c=i[a];if(void 0===k[c])throw(0,b.createError)("UNKNOWN_GROUP_BY_PROPERTY",c);if(!f.includes(k[c]))throw(0,b.createError)("INVALID_GROUP_BY_PROPERTY",c,f.join(", "),k[c])}let l=g.map(([b])=>(0,d.getDocumentIdFromInternalId)(a.internalDocumentIDStore,b)),m=a.documentsStore.getMultiple(a.data.docs,l),n=m.length,o=h.maxResult||Number.MAX_SAFE_INTEGER,p=[],q={};for(let a=0;a<j;a++){let b=i[a],d={property:b,perValue:{}},e=new Set;for(let a=0;a<n;a++){let f=m[a],g=(0,c.getNested)(f,b);if(void 0===g)continue;let h="boolean"!=typeof g?g:""+g,i=d.perValue[h]??{indexes:[],count:0};i.count>=o||(i.indexes.push(a),i.count++,d.perValue[h]=i,e.add(g))}p.push(Array.from(e)),q[b]=d}let r=function a(b,d=0){if(d+1===b.length)return b[d].map(a=>[a]);let e=b[d],f=a(b,d+1),g=[];for(let a of e)for(let b of f){let d=[a];(0,c.safeArrayPush)(d,b),g.push(d)}return g}(p),s=r.length,t=[];for(let a=0;a<s;a++){let b=r[a],d=b.length,e={values:[],indexes:[]},f=[];for(let a=0;a<d;a++){let c=b[a],d=i[a];f.push(q[d].perValue["boolean"!=typeof c?c:""+c].indexes),e.values.push(c)}e.indexes=(0,c.intersect)(f).sort((a,b)=>a-b),0!==e.indexes.length&&t.push(e)}let u=t.length,v=Array.from({length:u});for(let a=0;a<u;a++){let b=t[a],c=h.reduce||e,d=b.indexes.map(a=>({id:l[a],score:g[a][1],document:m[a]})),f=c.reducer.bind(null,b.values),i=c.getInitialValue(b.indexes.length),j=d.reduce(f,i);v[a]={values:b.values,result:j}}return v}},93938:a=>{"use strict";a.s({fullTextSearch:()=>k,innerFullTextSearch:()=>j});var b=a.i(51443),c=a.i(70247),d=a.i(97973),e=a.i(80274),f=a.i(15905),g=a.i(94919),h=a.i(81188),i=a.i(79875);function j(a,b,c){let d,e,{term:g,properties:i}=b,j=a.data.index,k=a.caches.propertiesToSearch;if(!k){let b=a.index.getSearchablePropertiesWithTypes(j);k=(k=a.index.getSearchableProperties(j)).filter(a=>b[a].startsWith("string")),a.caches.propertiesToSearch=k}if(i&&"*"!==i){for(let a of i)if(!k.includes(a))throw(0,f.createError)("UNKNOWN_INDEX",a,k.join(", "));k=k.filter(a=>i.includes(a))}Object.keys(b.where??{}).length>0&&(d=a.index.searchByWhereClause(j,a.tokenizer,b.where,c));let m=void 0!==b.threshold&&null!==b.threshold?b.threshold:1;if(g||i){let f=(0,h.count)(a);e=a.index.search(j,g||"",a.tokenizer,c,k,b.exact||!1,b.tolerance||0,b.boost||{},function(a){let b=a??{};return b.k=b.k??l.k,b.b=b.b??l.b,b.d=b.d??l.d,b}(b.relevance),f,d,m)}else e=(d?Array.from(d):Object.keys(a.documentsStore.getAll(a.data.docs))).map(a=>[+a,0]);return e}function k(a,f,h){let k=(0,g.getNanosecondsTime)();function l(){let d,l=Object.keys(a.data.index.vectorIndexes),m=f.facets&&Object.keys(f.facets).length>0,{limit:n=10,offset:o=0,distinctOn:p,includeVectors:q=!1}=f,r=!0===f.preflight,s=j(a,f,h);if(f.sortBy)if("function"==typeof f.sortBy){let b=s.map(([a])=>a),c=a.documentsStore.getMultiple(a.data.docs,b).map((a,b)=>[s[b][0],s[b][1],a]);c.sort(f.sortBy),s=c.map(([a,b])=>[a,b])}else s=a.sorter.sortBy(a.data.sorting,s,f.sortBy).map(([b,c])=>[(0,e.getInternalDocumentId)(a.internalDocumentIDStore,b),c]);else s=s.sort(g.sortTokenScorePredicate);r||(d=p?(0,i.fetchDocumentsWithDistinct)(a,s,o,n,p):(0,i.fetchDocuments)(a,s,o,n));let t={elapsed:{formatted:"",raw:0},hits:[],count:s.length};return void 0!==d&&(t.hits=d.filter(Boolean),q||(0,g.removeVectorsFromHits)(t,l)),m&&(t.facets=(0,b.getFacets)(a,s,f.facets)),f.groupBy&&(t.groups=(0,c.getGroups)(a,s,f.groupBy)),t.elapsed=a.formatElapsedTime((0,g.getNanosecondsTime)()-k),t}async function m(){a.beforeSearch&&await (0,d.runBeforeSearch)(a.beforeSearch,a,f,h);let b=l();return a.afterSearch&&await (0,d.runAfterSearch)(a.afterSearch,a,f,h,b),b}return a.beforeSearch?.length||a.afterSearch?.length?m():l()}let l={k:1.2,b:.75,d:.5}},77461:a=>{"use strict";a.s({innerVectorSearch:()=>i,searchVector:()=>j});var b=a.i(94919),c=a.i(51443),d=a.i(15905),e=a.i(70247),f=a.i(80274),g=a.i(97973),h=a.i(90845);function i(a,b,c){let e,f=b.vector;if(f&&(!("value"in f)||!("property"in f)))throw(0,d.createError)("INVALID_VECTOR_INPUT",Object.keys(f).join(", "));let g=a.data.index.vectorIndexes[f.property],i=g.node.size;if(f?.value.length!==i){if(f?.property===void 0||f?.value.length===void 0)throw(0,d.createError)("INVALID_INPUT_VECTOR","undefined",i,"undefined");throw(0,d.createError)("INVALID_INPUT_VECTOR",f.property,i,f.value.length)}let j=a.data.index;return Object.keys(b.where??{}).length>0&&(e=a.index.searchByWhereClause(j,a.tokenizer,b.where,c)),g.node.find(f.value,b.similarity??h.DEFAULT_SIMILARITY,e)}function j(a,d,h="english"){let k=(0,b.getNanosecondsTime)();function l(){let g=i(a,d,h).sort(b.sortTokenScorePredicate),j=[];d.facets&&Object.keys(d.facets).length>0&&(j=(0,c.getFacets)(a,g,d.facets));let l=d.vector.property,m=d.includeVectors??!1,n=d.limit??10,o=d.offset??0,p=Array.from({length:n});for(let b=0;b<n;b++){let c=g[b+o];if(!c)break;let d=a.data.docs.docs[c[0]];if(d){m||(d[l]=null);let e={id:(0,f.getDocumentIdFromInternalId)(a.internalDocumentIDStore,c[0]),score:c[1],document:d};p[b]=e}}let q=[];d.groupBy&&(q=(0,e.getGroups)(a,g,d.groupBy));let r=(0,b.getNanosecondsTime)()-k;return{count:g.length,hits:p.filter(Boolean),elapsed:{raw:Number(r),formatted:(0,b.formatNanoseconds)(r)},...j?{facets:j}:{},...q?{groups:q}:{}}}async function m(){a.beforeSearch&&await (0,g.runBeforeSearch)(a.beforeSearch,a,d,h);let b=l();return a.afterSearch&&await (0,g.runAfterSearch)(a.afterSearch,a,d,h,b),b}return a.beforeSearch?.length||a.afterSearch?.length?m():l()}},70638:a=>{"use strict";a.s({hybridSearch:()=>i});var b=a.i(94919),c=a.i(51443),d=a.i(70247),e=a.i(79875),f=a.i(93938),g=a.i(77461),h=a.i(97973);function i(a,i,k){let l=(0,b.getNanosecondsTime)();function m(){let h,m,n=function(a,b,c){let d=function(a){let b=Math.max.apply(Math,a.map(j));return a.map(([a,c])=>[a,c/b])}((0,f.innerFullTextSearch)(a,b,c)),e=(0,g.innerVectorSearch)(a,b,c),h=b.hybridWeights;return function(a,b,c,d){let e=Math.max.apply(Math,a.map(j)),f=Math.max.apply(Math,b.map(j)),{text:g,vector:h}=d&&d.text&&d.vector?d:{text:.5,vector:.5},i=new Map,k=a.length,l=(a,b)=>a*g+b*h;for(let b=0;b<k;b++){let[c,d]=a[b],f=l(d/e,0);i.set(c,f)}let m=b.length;for(let a=0;a<m;a++){let[c,d]=b[a],e=d/f,g=i.get(c)??0;i.set(c,g+l(0,e))}return[...i].sort((a,b)=>b[1]-a[1])}(d,e,b.term??"",h)}(a,i,k);i.facets&&Object.keys(i.facets).length>0&&(h=(0,c.getFacets)(a,n,i.facets)),i.groupBy&&(m=(0,d.getGroups)(a,n,i.groupBy));let o=i.offset??0,p=i.limit??10,q=(0,e.fetchDocuments)(a,n,o,p).filter(Boolean),r=(0,b.getNanosecondsTime)(),s={count:n.length,elapsed:{raw:Number(r-l),formatted:(0,b.formatNanoseconds)(r-l)},hits:q,...h?{facets:h}:{},...m?{groups:m}:{}};if(!i.includeVectors){let c=Object.keys(a.data.index.vectorIndexes);(0,b.removeVectorsFromHits)(s,c)}return s}async function n(){a.beforeSearch&&await (0,h.runBeforeSearch)(a.beforeSearch,a,i,k);let b=m();return a.afterSearch&&await (0,h.runAfterSearch)(a.afterSearch,a,i,k,b),b}return a.beforeSearch?.length||a.afterSearch?.length?n():m()}function j(a){return a[1]}},79875:a=>{"use strict";a.s({fetchDocuments:()=>k,fetchDocumentsWithDistinct:()=>j,search:()=>i});var b=a.i(80274),c=a.i(15905),d=a.i(94919),e=a.i(35108),f=a.i(93938),g=a.i(77461),h=a.i(70638);function i(a,b,d){let i=b.mode??e.MODE_FULLTEXT_SEARCH;if(i===e.MODE_FULLTEXT_SEARCH)return(0,f.fullTextSearch)(a,b,d);if(i===e.MODE_VECTOR_SEARCH)return(0,g.searchVector)(a,b);if(i===e.MODE_HYBRID_SEARCH)return(0,h.hybridSearch)(a,b);throw(0,c.createError)("INVALID_SEARCH_MODE",i)}function j(a,c,e,f,g){let h=a.data.docs,i=new Map,j=[],k=new Set,l=c.length,m=0;for(let n=0;n<l;n++){let l=c[n];if(void 0===l)continue;let[o,p]=l;if(k.has(o))continue;let q=a.documentsStore.get(h,o),r=(0,d.getNested)(q,g);if(!(void 0===r||i.has(r))&&(i.set(r,!0),!(++m<=e)&&(j.push({id:(0,b.getDocumentIdFromInternalId)(a.internalDocumentIDStore,o),score:p,document:q}),k.add(o),m>=e+f)))break}return j}function k(a,c,d,e){let f=a.data.docs,g=Array.from({length:e}),h=new Set;for(let i=d;i<e+d;i++){let d=c[i];if(void 0===d)break;let[e,j]=d;if(!h.has(e)){let c=a.documentsStore.get(f,e);g[i]={id:(0,b.getDocumentIdFromInternalId)(a.internalDocumentIDStore,e),score:j,document:c},h.add(e)}}return g}},72085:a=>{"use strict";function b(a,b){a.internalDocumentIDStore.load(a,b.internalDocumentIDStore),a.data.index=a.index.load(a.internalDocumentIDStore,b.index),a.data.docs=a.documentsStore.load(a.internalDocumentIDStore,b.docs),a.data.sorting=a.sorter.load(a.internalDocumentIDStore,b.sorting),a.tokenizer.language=b.language}a.s({load:()=>b})},49528:a=>{"use strict";a.s({update:()=>g,updateMultiple:()=>i});var b=a.i(97973),c=a.i(15905),d=a.i(17945),e=a.i(48855),f=a.i(94919);function g(a,c,g,i,j){return(0,f.isAsyncFunction)(a.afterInsert)||(0,f.isAsyncFunction)(a.beforeInsert)||(0,f.isAsyncFunction)(a.afterRemove)||(0,f.isAsyncFunction)(a.beforeRemove)||(0,f.isAsyncFunction)(a.beforeUpdate)||(0,f.isAsyncFunction)(a.afterUpdate)?h(a,c,g,i,j):function(a,c,f,g,h){!h&&a.beforeUpdate&&(0,b.runSingleHook)(a.beforeUpdate,a,c),(0,e.remove)(a,c,g,h);let i=(0,d.insert)(a,f,g,h);return!h&&a.afterUpdate&&(0,b.runSingleHook)(a.afterUpdate,a,i),i}(a,c,g,i,j)}async function h(a,c,f,g,h){!h&&a.beforeUpdate&&await (0,b.runSingleHook)(a.beforeUpdate,a,c),await (0,e.remove)(a,c,g,h);let i=await (0,d.insert)(a,f,g,h);return!h&&a.afterUpdate&&await (0,b.runSingleHook)(a.afterUpdate,a,i),i}function i(a,g,h,i,k,l){return(0,f.isAsyncFunction)(a.afterInsert)||(0,f.isAsyncFunction)(a.beforeInsert)||(0,f.isAsyncFunction)(a.afterRemove)||(0,f.isAsyncFunction)(a.beforeRemove)||(0,f.isAsyncFunction)(a.beforeUpdate)||(0,f.isAsyncFunction)(a.afterUpdate)||(0,f.isAsyncFunction)(a.beforeUpdateMultiple)||(0,f.isAsyncFunction)(a.afterUpdateMultiple)||(0,f.isAsyncFunction)(a.beforeRemoveMultiple)||(0,f.isAsyncFunction)(a.afterRemoveMultiple)||(0,f.isAsyncFunction)(a.beforeInsertMultiple)||(0,f.isAsyncFunction)(a.afterInsertMultiple)?j(a,g,h,i,k,l):function(a,f,g,h,i,j){j||(0,b.runMultipleHook)(a.beforeUpdateMultiple,a,f);let k=g.length;for(let b=0;b<k;b++){let d=a.validateSchema(g[b],a.schema);if(d)throw(0,c.createError)("SCHEMA_VALIDATION_FAILURE",d)}(0,e.removeMultiple)(a,f,h,i,j);let l=(0,d.innerInsertMultiple)(a,g,h,i,j);return j||(0,b.runMultipleHook)(a.afterUpdateMultiple,a,l),l}(a,g,h,i,k,l)}async function j(a,f,g,h,i,j){j||await (0,b.runMultipleHook)(a.beforeUpdateMultiple,a,f);let k=g.length;for(let b=0;b<k;b++){let d=a.validateSchema(g[b],a.schema);if(d)throw(0,c.createError)("SCHEMA_VALIDATION_FAILURE",d)}await (0,e.removeMultiple)(a,f,h,i,j);let l=await (0,d.innerInsertMultiple)(a,g,h,i,j);return j||await (0,b.runMultipleHook)(a.afterUpdateMultiple,a,l),l}},93370:a=>{"use strict";a.s({}),a.i(97973),a.i(15905),a.i(17945),a.i(49528),a.i(94919)},47710:a=>{"use strict";a.s({}),a.i(15905),a.i(79875)},55825:a=>{"use strict";a.s({kInsertions:()=>b,kRemovals:()=>c}),a.i(35108);let b=Symbol("orama.insertions"),c=Symbol("orama.removals")},81312:a=>{"use strict";a.s({}),a.i(35108),a.i(55825)},67112:a=>{"use strict";a.s({}),a.i(71498),a.i(94919),a.i(87094)},98632:a=>{"use strict";a.s({}),a.i(71498),a.i(94919),a.i(87094),a.i(67112)},45744:a=>{"use strict";a.s({}),a.i(64731),a.i(81188),a.i(17945),a.i(48855),a.i(79875),a.i(77461),a.i(72085),a.i(49528),a.i(93370),a.i(47710),a.i(81312),a.i(94846),a.i(98632)},53504:a=>{"use strict";a.s({}),a.i(64731),a.i(81188),a.i(17945),a.i(48855),a.i(79875),a.i(77461),a.i(72085),a.i(49528),a.i(93370),a.i(47710),a.i(81312),a.i(94846),a.i(98632),a.i(45744)}};

//# sourceMappingURL=53381_%40orama_orama_dist_esm_face7953._.js.map