(globalThis.TURBOPACK=globalThis.TURBOPACK||[]).push(["object"==typeof document?document.currentScript:void 0,{5669:e=>{"use strict";e.s({SPLITTERS:()=>r,SUPPORTED_LANGUAGES:()=>n,getLocale:()=>o});let t={arabic:"ar",armenian:"am",bulgarian:"bg",czech:"cz",danish:"dk",dutch:"nl",english:"en",finnish:"fi",french:"fr",german:"de",greek:"gr",hungarian:"hu",indian:"in",indonesian:"id",irish:"ie",italian:"it",lithuanian:"lt",nepali:"np",norwegian:"no",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"rs",slovenian:"ru",spanish:"es",swedish:"se",tamil:"ta",turkish:"tr",ukrainian:"uk",sanskrit:"sk"},r={dutch:/[^A-Za-zàèéìòóù0-9_'-]+/gim,english:/[^A-Za-zàèéìòóù0-9_'-]+/gim,french:/[^a-z0-9äâàéèëêïîöôùüûœç-]+/gim,italian:/[^A-Za-zàèéìòóù0-9_'-]+/gim,norwegian:/[^a-z0-9_æøåÆØÅäÄöÖüÜ]+/gim,portuguese:/[^a-z0-9à-úÀ-Ú]/gim,russian:/[^a-z0-9а-яА-ЯёЁ]+/gim,spanish:/[^a-z0-9A-Zá-úÁ-ÚñÑüÜ]+/gim,swedish:/[^a-z0-9_åÅäÄöÖüÜ-]+/gim,german:/[^a-z0-9A-ZäöüÄÖÜß]+/gim,finnish:/[^a-z0-9äöÄÖ]+/gim,danish:/[^a-z0-9æøåÆØÅ]+/gim,hungarian:/[^a-z0-9áéíóöőúüűÁÉÍÓÖŐÚÜŰ]+/gim,romanian:/[^a-z0-9ăâîșțĂÂÎȘȚ]+/gim,serbian:/[^a-z0-9čćžšđČĆŽŠĐ]+/gim,turkish:/[^a-z0-9çÇğĞıİöÖşŞüÜ]+/gim,lithuanian:/[^a-z0-9ąčęėįšųūžĄČĘĖĮŠŲŪŽ]+/gim,arabic:/[^a-z0-9أ-ي]+/gim,nepali:/[^a-z0-9अ-ह]+/gim,irish:/[^a-z0-9áéíóúÁÉÍÓÚ]+/gim,indian:/[^a-z0-9अ-ह]+/gim,armenian:/[^a-z0-9ա-ֆ]+/gim,greek:/[^a-z0-9α-ωά-ώ]+/gim,indonesian:/[^a-z0-9]+/gim,ukrainian:/[^a-z0-9а-яА-ЯіїєІЇЄ]+/gim,slovenian:/[^a-z0-9čžšČŽŠ]+/gim,bulgarian:/[^a-z0-9а-яА-Я]+/gim,tamil:/[^a-z0-9அ-ஹ]+/gim,sanskrit:/[^a-z0-9A-Zāīūṛḷṃṁḥśṣṭḍṇṅñḻḹṝ]+/gim,czech:/[^A-Z0-9a-zěščřžýáíéúůóťďĚŠČŘŽÝÁÍÉÓÚŮŤĎ-]+/gim},n=Object.keys(t);function o(e){return void 0!==e&&n.includes(e)?t[e]:void 0}},45199:e=>{"use strict";e.s({convertDistanceToMeters:()=>b,formatNanoseconds:()=>f,getDocumentProperties:()=>I,getNanosecondsTime:()=>d,getNested:()=>y,getOwnProperty:()=>p,intersect:()=>g,isAsyncFunction:()=>function e(t){return Array.isArray(t)?t.some(t=>e(t)):t?.constructor?.name==="AsyncFunction"},removeVectorsFromHits:()=>T,safeArrayPush:()=>l,setDifference:()=>N,setIntersection:()=>A,setUnion:()=>w,sleep:()=>O,sortTokenScorePredicate:()=>m,sprintf:()=>u,uniqueId:()=>h});var t=e.i(98443),r=e.i(76244);let n=Date.now().toString().slice(5),o=0,i=BigInt(1e3),s=BigInt(1e6),a=BigInt(1e9);function l(e,t){if(t.length<65535)Array.prototype.push.apply(e,t);else{let r=t.length;for(let n=0;n<r;n+=65535)Array.prototype.push.apply(e,t.slice(n,n+65535))}}function u(e,...t){return e.replace(/%(?:(?<position>\d+)\$)?(?<width>-?\d*\.?\d*)(?<type>[dfs])/g,function(...e){let{width:r,type:n,position:o}=e[e.length-1],i=o?t[Number.parseInt(o)-1]:t.shift(),s=""===r?0:Number.parseInt(r);switch(n){case"d":return i.toString().padStart(s,"0");case"f":{let e=i,[t,n]=r.split(".").map(e=>Number.parseFloat(e));return"number"==typeof n&&n>=0&&(e=e.toFixed(n)),"number"==typeof t&&t>=0?e.toString().padStart(s,"0"):e.toString()}case"s":return s<0?i.toString().padEnd(-s," "):i.toString().padStart(s," ");default:return i}})}function c(){return BigInt(Math.floor(1e6*performance.now()))}function f(e){return("number"==typeof e&&(e=BigInt(e)),e<i)?`${e}ns`:e<s?`${e/i}μs`:e<a?`${e/s}ms`:`${e/a}s`}function d(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?c():void 0!==t.default&&t.default.release&&"node"===t.default.release.name||void 0!==t.default&&"function"==typeof t.default?.hrtime?.bigint?t.default.hrtime.bigint():"undefined"!=typeof performance?c():BigInt(0)}function h(){return`${n}-${o++}`}function p(e,t){return void 0===Object.hasOwn?Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0:Object.hasOwn(e,t)?e[t]:void 0}function m(e,t){return t[1]===e[1]?e[0]-t[0]:t[1]-e[1]}function g(e){if(0===e.length)return[];if(1===e.length)return e[0];for(let t=1;t<e.length;t++)if(e[t].length<e[0].length){let r=e[0];e[0]=e[t],e[t]=r}let t=new Map;for(let r of e[0])t.set(r,1);for(let r=1;r<e.length;r++){let n=0;for(let o of e[r]){let e=t.get(o);e===r&&(t.set(o,e+1),n++)}if(0===n)return[]}return e[0].filter(r=>{let n=t.get(r);return void 0!==n&&t.set(r,0),n===e.length})}function I(e,t){let r={},n=t.length;for(let o=0;o<n;o++){let n=t[o],i=n.split("."),s=e,a=i.length;for(let e=0;e<a;e++)if("object"==typeof(s=s[i[e]])){if(null!==s&&"lat"in s&&"lon"in s&&"number"==typeof s.lat&&"number"==typeof s.lon){s=r[n]=s;break}else if(!Array.isArray(s)&&null!==s&&e===a-1){s=void 0;break}}else if((null===s||"object"!=typeof s)&&e<a-1){s=void 0;break}void 0!==s&&(r[n]=s)}return r}function y(e,t){return I(e,[t])[t]}let S={cm:.01,m:1,km:1e3,ft:.3048,yd:.9144,mi:1609.344};function b(e,t){let n=S[t];if(void 0===n)throw Error((0,r.createError)("INVALID_DISTANCE_SUFFIX",e).message);return e*n}function T(e,t){e.hits=e.hits.map(e=>({...e,document:{...e.document,...t.reduce((e,t)=>{let r=t.split("."),n=r.pop(),o=e;for(let e of r)o[e]=o[e]??{},o=o[e];return o[n]=null,e},e.document)}}))}let D="intersection"in new Set;function A(...e){if(0===e.length)return new Set;if(1===e.length)return e[0];if(2===e.length){let t=e[0],r=e[1];if(D)return t.intersection(r);let n=new Set,o=t.size<r.size?t:r,i=o===t?r:t;for(let e of o)i.has(e)&&n.add(e);return n}let t={index:0,size:e[0].size};for(let r=1;r<e.length;r++)e[r].size<t.size&&(t.index=r,t.size=e[r].size);if(D){let r=e[t.index];for(let n=0;n<e.length;n++)n!==t.index&&(r=r.intersection(e[n]));return r}let r=e[t.index];for(let n=0;n<e.length;n++){if(n===t.index)continue;let o=e[n];for(let e of r)o.has(e)||r.delete(e)}return r}let v="union"in new Set;function w(e,t){return v?e?e.union(t):t:new Set(e?[...e,...t]:t)}function N(e,t){let r=new Set;for(let n of e)t.has(n)||r.add(n);return r}function O(e){if("undefined"!=typeof SharedArrayBuffer&&"undefined"!=typeof Atomics){let t=new Int32Array(new SharedArrayBuffer(4));if(!1==(e>0&&e<1/0)){if("number"!=typeof e&&"bigint"!=typeof e)throw TypeError("sleep: ms must be a number");throw RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")}Atomics.wait(t,0,0,Number(e))}else{if(!1==(e>0&&e<1/0)){if("number"!=typeof e&&"bigint"!=typeof e)throw TypeError("sleep: ms must be a number");throw RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")}let t=Date.now()+Number(e);for(;t>Date.now(););}}},76244:e=>{"use strict";e.s({createError:()=>i});var t=e.i(5669),r=e.i(45199);let n=t.SUPPORTED_LANGUAGES.join("\n - "),o={NO_LANGUAGE_WITH_CUSTOM_TOKENIZER:"Do not pass the language option to create when using a custom tokenizer.",LANGUAGE_NOT_SUPPORTED:`Language "%s" is not supported.
Supported languages are:
 - ${n}`,INVALID_STEMMER_FUNCTION_TYPE:"config.stemmer property must be a function.",MISSING_STEMMER:'As of version 1.0.0 @orama/orama does not ship non English stemmers by default. To solve this, please explicitly import and specify the "%s" stemmer from the package @orama/stemmers. See https://docs.orama.com/open-source/text-analysis/stemming for more information.',CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY:"Custom stop words array must only contain strings.",UNSUPPORTED_COMPONENT:'Unsupported component "%s".',COMPONENT_MUST_BE_FUNCTION:'The component "%s" must be a function.',COMPONENT_MUST_BE_FUNCTION_OR_ARRAY_FUNCTIONS:'The component "%s" must be a function or an array of functions.',INVALID_SCHEMA_TYPE:'Unsupported schema type "%s" at "%s". Expected "string", "boolean" or "number" or array of them.',DOCUMENT_ID_MUST_BE_STRING:'Document id must be of type "string". Got "%s" instead.',DOCUMENT_ALREADY_EXISTS:'A document with id "%s" already exists.',DOCUMENT_DOES_NOT_EXIST:'A document with id "%s" does not exists.',MISSING_DOCUMENT_PROPERTY:'Missing searchable property "%s".',INVALID_DOCUMENT_PROPERTY:'Invalid document property "%s": expected "%s", got "%s"',UNKNOWN_INDEX:'Invalid property name "%s". Expected a wildcard string ("*") or array containing one of the following properties: %s',INVALID_BOOST_VALUE:"Boost value must be a number greater than, or less than 0.",INVALID_FILTER_OPERATION:"You can only use one operation per filter, you requested %d.",SCHEMA_VALIDATION_FAILURE:'Cannot insert document due schema validation failure on "%s" property.',INVALID_SORT_SCHEMA_TYPE:'Unsupported sort schema type "%s" at "%s". Expected "string" or "number".',CANNOT_SORT_BY_ARRAY:'Cannot configure sort for "%s" because it is an array (%s).',UNABLE_TO_SORT_ON_UNKNOWN_FIELD:'Unable to sort on unknown field "%s". Allowed fields: %s',SORT_DISABLED:"Sort is disabled. Please read the documentation at https://docs.oramasearch for more information.",UNKNOWN_GROUP_BY_PROPERTY:'Unknown groupBy property "%s".',INVALID_GROUP_BY_PROPERTY:'Invalid groupBy property "%s". Allowed types: "%s", but given "%s".',UNKNOWN_FILTER_PROPERTY:'Unknown filter property "%s".',INVALID_VECTOR_SIZE:'Vector size must be a number greater than 0. Got "%s" instead.',INVALID_VECTOR_VALUE:'Vector value must be a number greater than 0. Got "%s" instead.',INVALID_INPUT_VECTOR:`Property "%s" was declared as a %s-dimensional vector, but got a %s-dimensional vector instead.
Input vectors must be of the size declared in the schema, as calculating similarity between vectors of different sizes can lead to unexpected results.`,WRONG_SEARCH_PROPERTY_TYPE:'Property "%s" is not searchable. Only "string" properties are searchable.',FACET_NOT_SUPPORTED:'Facet doens\'t support the type "%s".',INVALID_DISTANCE_SUFFIX:'Invalid distance suffix "%s". Valid suffixes are: cm, m, km, mi, yd, ft.',INVALID_SEARCH_MODE:'Invalid search mode "%s". Valid modes are: "fulltext", "vector", "hybrid".',MISSING_VECTOR_AND_SECURE_PROXY:"No vector was provided and no secure proxy was configured. Please provide a vector or configure an Orama Secure Proxy to perform hybrid search.",MISSING_TERM:'"term" is a required parameter when performing hybrid search. Please provide a search term.',INVALID_VECTOR_INPUT:'Invalid "vector" property. Expected an object with "value" and "property" properties, but got "%s" instead.',PLUGIN_CRASHED:"A plugin crashed during initialization. Please check the error message for more information:",PLUGIN_SECURE_PROXY_NOT_FOUND:`Could not find '@orama/secure-proxy-plugin' installed in your Orama instance.
Please install it before proceeding with creating an answer session.
Read more at https://docs.orama.com/open-source/plugins/plugin-secure-proxy#plugin-secure-proxy
`,PLUGIN_SECURE_PROXY_MISSING_CHAT_MODEL:`Could not find a chat model defined in the secure proxy plugin configuration.
Please provide a chat model before proceeding with creating an answer session.
Read more at https://docs.orama.com/open-source/plugins/plugin-secure-proxy#plugin-secure-proxy
`,ANSWER_SESSION_LAST_MESSAGE_IS_NOT_ASSISTANT:"The last message in the session is not an assistant message. Cannot regenerate non-assistant messages.",PLUGIN_COMPONENT_CONFLICT:'The component "%s" is already defined. The plugin "%s" is trying to redefine it.'};function i(e,...t){let n=Error((0,r.sprintf)(o[e]??`Unsupported Orama Error code: ${e}`,...t));return n.code=e,"captureStackTrace"in Error.prototype&&Error.captureStackTrace(n),n}},3895:e=>{"use strict";e.s({formatElapsedTime:()=>n,getDocumentIndexId:()=>o,getInnerType:()=>c,getVectorSize:()=>f,isArrayType:()=>u,isGeoPointType:()=>a,isVectorType:()=>l,validateSchema:()=>function e(r,n){for(let[o,i]of Object.entries(n)){let n=r[o];if(void 0!==n&&("geopoint"!==i||"object"!=typeof n||"number"!=typeof n.lon||"number"!=typeof n.lat)&&("enum"!==i||"string"!=typeof n&&"number"!=typeof n)){if("enum[]"===i&&Array.isArray(n)){let e=n.length;for(let t=0;t<e;t++)if("string"!=typeof n[t]&&"number"!=typeof n[t])return o+"."+t;continue}if(l(i)){let e=f(i);if(!Array.isArray(n)||n.length!==e)throw(0,t.createError)("INVALID_INPUT_VECTOR",o,e,n.length);continue}if(u(i)){if(!Array.isArray(n))return o;let e=function(e){return s[e]}(i),t=n.length;for(let r=0;r<t;r++)if(typeof n[r]!==e)return o+"."+r;continue}if("object"==typeof i){if(!n||"object"!=typeof n)return o;let t=e(n,i);if(t)return o+"."+t;continue}if(typeof n!==i)return o}}}});var t=e.i(76244),r=e.i(45199);function n(e){return{raw:Number(e),formatted:(0,r.formatNanoseconds)(e)}}function o(e){if(e.id){if("string"!=typeof e.id)throw(0,t.createError)("DOCUMENT_ID_MUST_BE_STRING",typeof e.id);return e.id}return(0,r.uniqueId)()}let i={string:!1,number:!1,boolean:!1,enum:!1,geopoint:!1,"string[]":!0,"number[]":!0,"boolean[]":!0,"enum[]":!0},s={"string[]":"string","number[]":"number","boolean[]":"boolean","enum[]":"enum"};function a(e){return"geopoint"===e}function l(e){return"string"==typeof e&&/^vector\[\d+\]$/.test(e)}function u(e){return"string"==typeof e&&i[e]}function c(e){return s[e]}function f(e){let r=Number(e.slice(7,-1));switch(!0){case isNaN(r):throw(0,t.createError)("INVALID_VECTOR_VALUE",e);case r<=0:throw(0,t.createError)("INVALID_VECTOR_SIZE",e);default:return r}}},71306:e=>{"use strict";e.s({}),e.i(76244),e.i(45199),e.i(3895)},19677:e=>{"use strict";function t(){return{idToInternalId:new Map,internalIdToId:[],save:r,load:n}}function r(e){return{internalIdToId:e.internalIdToId}}function n(e,t){let{internalIdToId:r}=t;e.internalDocumentIDStore.idToInternalId.clear(),e.internalDocumentIDStore.internalIdToId=[];let n=r.length;for(let t=0;t<n;t++){let n=r[t];e.internalDocumentIDStore.idToInternalId.set(n,t+1),e.internalDocumentIDStore.internalIdToId.push(n)}}function o(e,t){if(e.internalIdToId.length<t)throw Error(`Invalid internalId ${t}`);return e.internalIdToId[t-1]}e.s({createInternalDocumentIDStore:()=>t,getDocumentIdFromInternalId:()=>o,getInternalDocumentId:()=>function e(t,r){if("string"==typeof r){let e=t.idToInternalId.get(r);if(e)return e;let n=t.idToInternalId.size+1;return t.idToInternalId.set(r,n),t.internalIdToId.push(r),n}return r>t.internalIdToId.length?e(t,r.toString()):r}})},6723:e=>{"use strict";e.s({createDocumentsStore:()=>f});var t=e.i(19677);function r(e,t){return{sharedInternalDocumentStore:t,docs:{},count:0}}function n(e,r){let n=(0,t.getInternalDocumentId)(e.sharedInternalDocumentStore,r);return e.docs[n]}function o(e,r){let n=r.length,o=Array.from({length:n});for(let i=0;i<n;i++){let n=(0,t.getInternalDocumentId)(e.sharedInternalDocumentStore,r[i]);o[i]=e.docs[n]}return o}function i(e){return e.docs}function s(e,t,r,n){return void 0===e.docs[r]&&(e.docs[r]=n,e.count++,!0)}function a(e,r){let n=(0,t.getInternalDocumentId)(e.sharedInternalDocumentStore,r);return void 0!==e.docs[n]&&(delete e.docs[n],e.count--,!0)}function l(e){return e.count}function u(e,t){return{docs:t.docs,count:t.count,sharedInternalDocumentStore:e}}function c(e){return{docs:e.docs,count:e.count}}function f(){return{create:r,get:n,getMultiple:o,getAll:i,store:s,remove:a,count:l,load:u,save:c}}},56627:e=>{"use strict";e.s({AVAILABLE_PLUGIN_HOOKS:()=>r,getAllPluginsByHook:()=>n});var t=e.i(76244);let r=["beforeInsert","afterInsert","beforeRemove","afterRemove","beforeUpdate","afterUpdate","beforeUpsert","afterUpsert","beforeSearch","afterSearch","beforeInsertMultiple","afterInsertMultiple","beforeRemoveMultiple","afterRemoveMultiple","beforeUpdateMultiple","afterUpdateMultiple","beforeUpsertMultiple","afterUpsertMultiple","beforeLoad","afterLoad","afterCreate"];function n(e,r){let n=[],o=e.plugins?.length;if(!o)return n;for(let i=0;i<o;i++)try{let t=e.plugins[i];"function"==typeof t[r]&&n.push(t[r])}catch(e){throw console.error("Caught error in getAllPluginsByHook:",e),(0,t.createError)("PLUGIN_CRASHED")}return n}},48477:e=>{"use strict";e.s({FUNCTION_COMPONENTS:()=>n,OBJECT_COMPONENTS:()=>r,runAfterCreate:()=>l,runAfterSearch:()=>s,runBeforeSearch:()=>a,runMultipleHook:()=>i,runSingleHook:()=>o});var t=e.i(45199);let r=["tokenizer","index","documentsStore","sorter"],n=["validateSchema","getDocumentIndexId","getDocumentProperties","formatElapsedTime"];function o(e,r,n,o){if(e.some(t.isAsyncFunction))return(async()=>{for(let t of e)await t(r,n,o)})();for(let t of e)t(r,n,o)}function i(e,r,n){if(e.some(t.isAsyncFunction))return(async()=>{for(let t of e)await t(r,n)})();for(let t of e)t(r,n)}function s(e,r,n,o,i){if(e.some(t.isAsyncFunction))return(async()=>{for(let t of e)await t(r,n,o,i)})();for(let t of e)t(r,n,o,i)}function a(e,r,n,o){if(e.some(t.isAsyncFunction))return(async()=>{for(let t of e)await t(r,n,o)})();for(let t of e)t(r,n,o)}function l(e,r){if(e.some(t.isAsyncFunction))return(async()=>{for(let t of e)await t(r)})();for(let t of e)t(r)}},18:e=>{"use strict";e.s({AVLTree:()=>n});var t=e.i(45199);class r{k;v;l=null;r=null;h=1;constructor(e,t){this.k=e,this.v=new Set(t)}updateHeight(){this.h=Math.max(r.getHeight(this.l),r.getHeight(this.r))+1}static getHeight(e){return e?e.h:0}getBalanceFactor(){return r.getHeight(this.l)-r.getHeight(this.r)}rotateLeft(){let e=this.r;return this.r=e.l,e.l=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){let e=this.l;return this.l=e.r,e.r=this,this.updateHeight(),e.updateHeight(),e}toJSON(){return{k:this.k,v:Array.from(this.v),l:this.l?this.l.toJSON():null,r:this.r?this.r.toJSON():null,h:this.h}}static fromJSON(e){let t=new r(e.k,e.v);return t.l=e.l?r.fromJSON(e.l):null,t.r=e.r?r.fromJSON(e.r):null,t.h=e.h,t}}class n{root=null;insertCount=0;constructor(e,t){void 0!==e&&void 0!==t&&(this.root=new r(e,t))}insert(e,t,r=1e3){this.root=this.insertNode(this.root,e,t,r)}insertMultiple(e,t,r=1e3){for(let n of t)this.insert(e,n,r)}rebalance(){this.root&&(this.root=this.rebalanceNode(this.root))}toJSON(){return{root:this.root?this.root.toJSON():null,insertCount:this.insertCount}}static fromJSON(e){let t=new n;return t.root=e.root?r.fromJSON(e.root):null,t.insertCount=e.insertCount||0,t}insertNode(e,t,n,o){if(null===e)return new r(t,[n]);let i=[],s=e,a=null;for(;null!==s;)if(i.push({parent:a,node:s}),t<s.k)if(null===s.l){s.l=new r(t,[n]),i.push({parent:s,node:s.l});break}else a=s,s=s.l;else if(!(t>s.k))return s.v.add(n),e;else if(null===s.r){s.r=new r(t,[n]),i.push({parent:s,node:s.r});break}else a=s,s=s.r;let l=!1;this.insertCount++%o==0&&(l=!0);for(let t=i.length-1;t>=0;t--){let{parent:r,node:n}=i[t];if(n.updateHeight(),l){let t=this.rebalanceNode(n);r?r.l===n?r.l=t:r.r===n&&(r.r=t):e=t}}return e}rebalanceNode(e){let t=e.getBalanceFactor();if(t>1){if(e.l&&e.l.getBalanceFactor()>=0)return e.rotateRight();else if(e.l)return e.l=e.l.rotateLeft(),e.rotateRight()}if(t<-1){if(e.r&&0>=e.r.getBalanceFactor())return e.rotateLeft();else if(e.r)return e.r=e.r.rotateRight(),e.rotateLeft()}return e}find(e){let t=this.findNodeByKey(e);return t?t.v:null}contains(e){return null!==this.find(e)}getSize(){let e=0,t=[],r=this.root;for(;r||t.length>0;){for(;r;)t.push(r),r=r.l;r=t.pop(),e++,r=r.r}return e}isBalanced(){if(!this.root)return!0;let e=[this.root];for(;e.length>0;){let t=e.pop();if(Math.abs(t.getBalanceFactor())>1)return!1;t.l&&e.push(t.l),t.r&&e.push(t.r)}return!0}remove(e){this.root=this.removeNode(this.root,e)}removeDocument(e,t){let r=this.findNodeByKey(e);r&&(1===r.v.size?this.root=this.removeNode(this.root,e):r.v=new Set([...r.v.values()].filter(e=>e!==t)))}findNodeByKey(e){let t=this.root;for(;t;)if(e<t.k)t=t.l;else{if(!(e>t.k))return t;t=t.r}return null}removeNode(e,t){if(null===e)return null;let r=[],n=e;for(;null!==n&&n.k!==t;)r.push(n),n=t<n.k?n.l:n.r;if(null===n)return e;if(null===n.l||null===n.r){let t=n.l?n.l:n.r;if(0===r.length)e=t;else{let e=r[r.length-1];e.l===n?e.l=t:e.r=t}}else{let e=n,t=n.r;for(;null!==t.l;)e=t,t=t.l;n.k=t.k,n.v=t.v,e.l===t?e.l=t.r:e.r=t.r,n=e}r.push(n);for(let t=r.length-1;t>=0;t--){let n=r[t];n.updateHeight();let o=this.rebalanceNode(n);if(t>0){let e=r[t-1];e.l===n?e.l=o:e.r===n&&(e.r=o)}else e=o}return e}rangeSearch(e,r){let n=new Set,o=[],i=this.root;for(;i||o.length>0;){for(;i;)o.push(i),i=i.l;if((i=o.pop()).k>=e&&i.k<=r&&(n=(0,t.setUnion)(n,i.v)),i.k>r)break;i=i.r}return n}greaterThan(e,r=!1){let n=new Set,o=[],i=this.root;for(;i||o.length>0;){for(;i;)o.push(i),i=i.r;if(i=o.pop(),r&&i.k>=e||!r&&i.k>e)n=(0,t.setUnion)(n,i.v);else if(i.k<=e)break;i=i.l}return n}lessThan(e,r=!1){let n=new Set,o=[],i=this.root;for(;i||o.length>0;){for(;i;)o.push(i),i=i.l;if(i=o.pop(),r&&i.k<=e||!r&&i.k<e)n=(0,t.setUnion)(n,i.v);else if(i.k>e)break;i=i.r}return n}}},84134:e=>{"use strict";e.s({FlatTree:()=>t});class t{numberToDocumentId;constructor(){this.numberToDocumentId=new Map}insert(e,t){this.numberToDocumentId.has(e)?this.numberToDocumentId.get(e).add(t):this.numberToDocumentId.set(e,new Set([t]))}find(e){let t=this.numberToDocumentId.get(e);return t?Array.from(t):null}remove(e){this.numberToDocumentId.delete(e)}removeDocument(e,t){let r=this.numberToDocumentId.get(t);r&&(r.delete(e),0===r.size&&this.numberToDocumentId.delete(t))}contains(e){return this.numberToDocumentId.has(e)}getSize(){let e=0;for(let t of this.numberToDocumentId.values())e+=t.size;return e}filter(e){let t=Object.keys(e);if(1!==t.length)throw Error("Invalid operation");let r=t[0];switch(r){case"eq":{let t=e[r],n=this.numberToDocumentId.get(t);return n?Array.from(n):[]}case"in":{let t=e[r],n=new Set;for(let e of t){let t=this.numberToDocumentId.get(e);if(t)for(let e of t)n.add(e)}return Array.from(n)}case"nin":{let t=new Set(e[r]),n=new Set;for(let[e,r]of this.numberToDocumentId.entries())if(!t.has(e))for(let e of r)n.add(e);return Array.from(n)}default:throw Error("Invalid operation")}}filterArr(e){let t=Object.keys(e);if(1!==t.length)throw Error("Invalid operation");let r=t[0];switch(r){case"containsAll":{let t=e[r].map(e=>this.numberToDocumentId.get(e)??new Set);if(0===t.length)return[];return Array.from(t.reduce((e,t)=>new Set([...e].filter(e=>t.has(e)))))}case"containsAny":{let t=e[r].map(e=>this.numberToDocumentId.get(e)??new Set);if(0===t.length)return[];return Array.from(t.reduce((e,t)=>new Set([...e,...t])))}default:throw Error("Invalid operation")}}static fromJSON(e){if(!e.numberToDocumentId)throw Error("Invalid Flat Tree JSON");let r=new t;for(let[t,n]of e.numberToDocumentId)r.numberToDocumentId.set(t,new Set(n));return r}toJSON(){return{numberToDocumentId:Array.from(this.numberToDocumentId.entries()).map(([e,t])=>[e,Array.from(t)])}}}},66313:e=>{"use strict";function t(e,t,r){let n=function(e,t,r){if(r<0)return -1;if(e===t)return 0;let n=e.length,o=t.length;if(0===n)return o<=r?o:-1;if(0===o)return n<=r?n:-1;let i=Math.abs(n-o);if(e.startsWith(t))return i<=r?i:-1;if(t.startsWith(e))return 0;if(i>r)return -1;let s=[];for(let e=0;e<=n;e++){s[e]=[e];for(let t=1;t<=o;t++)s[e][t]=0===e?t:0}for(let i=1;i<=n;i++){let n=1/0;for(let r=1;r<=o;r++)e[i-1]===t[r-1]?s[i][r]=s[i-1][r-1]:s[i][r]=Math.min(s[i-1][r]+1,s[i][r-1]+1,s[i-1][r-1]+1),n=Math.min(n,s[i][r]);if(n>r)return -1}return s[n][o]<=r?s[n][o]:-1}(e,t,r);return{distance:n,isBounded:n>=0}}e.s({syncBoundedLevenshtein:()=>t})},14544:e=>{"use strict";e.s({RadixTree:()=>o});var t=e.i(66313),r=e.i(45199);class n{k;s;c=new Map;d=new Set;e;w="";constructor(e,t,r){this.k=e,this.s=t,this.e=r}updateParent(e){this.w=e.w+this.s}addDocument(e){this.d.add(e)}removeDocument(e){return this.d.delete(e)}findAllWords(e,n,o,i){let s=[this];for(;s.length>0;){let a=s.pop();if(a.e){let{w:s,d:l}=a;if(o&&s!==n)continue;if(null!==(0,r.getOwnProperty)(e,s))if(i){if(!(Math.abs(n.length-s.length)<=i)||!(0,t.syncBoundedLevenshtein)(n,s,i).isBounded)continue;e[s]=[]}else e[s]=[];if(null!=(0,r.getOwnProperty)(e,s)&&l.size>0){let t=e[s];for(let e of l)t.includes(e)||t.push(e)}}a.c.size>0&&s.push(...a.c.values())}return e}insert(e,t){let r=this,o=0,i=e.length;for(;o<i;){let s=e[o],a=r.c.get(s);if(a){let s=a.s,l=s.length,u=0;for(;u<l&&o+u<i&&s[u]===e[o+u];)u++;if(u===l){if(r=a,(o+=u)===i){a.e||(a.e=!0),a.addDocument(t);return}continue}let c=s.slice(0,u),f=s.slice(u),d=e.slice(o+u),h=new n(c[0],c,!1);if(r.c.set(c[0],h),h.updateParent(r),a.s=f,a.k=f[0],h.c.set(f[0],a),a.updateParent(h),d){let e=new n(d[0],d,!0);e.addDocument(t),h.c.set(d[0],e),e.updateParent(h)}else h.e=!0,h.addDocument(t);return}{let i=new n(s,e.slice(o),!0);i.addDocument(t),r.c.set(s,i),i.updateParent(r);return}}r.e||(r.e=!0),r.addDocument(t)}_findLevenshtein(e,n,o,i,s){let a=[{node:this,index:n,tolerance:o}];for(;a.length>0;){let{node:n,index:o,tolerance:l}=a.pop();if(n.w.startsWith(e)){n.findAllWords(s,e,!1,0);continue}if(l<0)continue;if(n.e){let{w:o,d:a}=n;if(o&&((0,t.syncBoundedLevenshtein)(e,o,i).isBounded&&(s[o]=[]),void 0!==(0,r.getOwnProperty)(s,o)&&a.size>0)){let e=new Set(s[o]);for(let t of a)e.add(t);s[o]=Array.from(e)}}if(o>=e.length)continue;let u=e[o];if(n.c.has(u)){let e=n.c.get(u);a.push({node:e,index:o+1,tolerance:l})}for(let[e,t]of(a.push({node:n,index:o+1,tolerance:l-1}),n.c))a.push({node:t,index:o,tolerance:l-1}),e!==u&&a.push({node:t,index:o+1,tolerance:l-1})}}find(e){let{term:t,exact:r,tolerance:n}=e;if(n&&!r){let e={};return this._findLevenshtein(t,0,n,n,e),e}{let e=this,o=0,i=t.length;for(;o<i;){let s=t[o],a=e.c.get(s);if(!a)return{};{let s=a.s,l=s.length,u=0;for(;u<l&&o+u<i&&s[u]===t[o+u];)u++;if(u===l)e=a,o+=u;else{if(o+u!==i||u!==i-o||r)return{};let e={};return a.findAllWords(e,t,r,n),e}}}let s={};return e.findAllWords(s,t,r,n),s}}contains(e){let t=this,r=0,n=e.length;for(;r<n;){let o=e[r],i=t.c.get(o);if(!i)return!1;{let o=i.s,s=o.length,a=0;for(;a<s&&r+a<n&&o[a]===e[r+a];)a++;if(a<s)return!1;r+=s,t=i}}return!0}removeWord(e){if(!e)return!1;let t=this,r=e.length,n=[];for(let o=0;o<r;o++){let r=e[o];if(!t.c.has(r))return!1;{let e=t.c.get(r);n.push({parent:t,character:r}),o+=e.s.length-1,t=e}}for(t.d.clear(),t.e=!1;n.length>0&&0===t.c.size&&!t.e&&0===t.d.size;){let{parent:e,character:r}=n.pop();e.c.delete(r),t=e}return!0}removeDocumentByWord(e,t,r=!0){if(!e)return!0;let n=this,o=e.length;for(let i=0;i<o;i++){let o=e[i];if(!n.c.has(o))return!1;{let s=n.c.get(o);i+=s.s.length-1,n=s,r&&n.w!==e||n.removeDocument(t)}}return!0}static getCommonPrefix(e,t){let r=Math.min(e.length,t.length),n=0;for(;n<r&&e.charCodeAt(n)===t.charCodeAt(n);)n++;return e.slice(0,n)}toJSON(){return{w:this.w,s:this.s,e:this.e,k:this.k,d:Array.from(this.d),c:Array.from(this.c?.entries())?.map(([e,t])=>[e,t.toJSON()])}}static fromJSON(e){let t=new n(e.k,e.s,e.e);return t.w=e.w,t.d=new Set(e.d),t.c=new Map(e?.c?.map(([e,t])=>[e,n.fromJSON(t)])),t}}class o extends n{constructor(){super("","",!1)}static fromJSON(e){let t=new o;return t.w=e.w,t.s=e.s,t.e=e.e,t.k=e.k,t.d=new Set(e.d),t.c=new Map(e.c?.map(([e,t])=>[e,n.fromJSON(t)])),t}toJSON(){return super.toJSON()}}},21693:e=>{"use strict";e.s({BKDTree:()=>r});class t{point;docIDs;left;right;parent;constructor(e,t){this.point=e,this.docIDs=new Set(t),this.left=null,this.right=null,this.parent=null}toJSON(){return{point:this.point,docIDs:Array.from(this.docIDs),left:this.left?this.left.toJSON():null,right:this.right?this.right.toJSON():null}}static fromJSON(e,r=null){let n=new t(e.point,e.docIDs);return n.parent=r,e.left&&(n.left=t.fromJSON(e.left,n)),e.right&&(n.right=t.fromJSON(e.right,n)),n}}class r{root;nodeMap;constructor(){this.root=null,this.nodeMap=new Map}getPointKey(e){return`${e.lon},${e.lat}`}insert(e,r){let n=this.getPointKey(e),o=this.nodeMap.get(n);if(o)return void r.forEach(e=>o.docIDs.add(e));let i=new t(e,r);if(this.nodeMap.set(n,i),null==this.root){this.root=i;return}let s=this.root,a=0;for(;;){if(0==a%2)if(e.lon<s.point.lon){if(null==s.left){s.left=i,i.parent=s;return}s=s.left}else{if(null==s.right){s.right=i,i.parent=s;return}s=s.right}else if(e.lat<s.point.lat){if(null==s.left){s.left=i,i.parent=s;return}s=s.left}else{if(null==s.right){s.right=i,i.parent=s;return}s=s.right}a++}}contains(e){let t=this.getPointKey(e);return this.nodeMap.has(t)}getDocIDsByCoordinates(e){let t=this.getPointKey(e),r=this.nodeMap.get(t);return r?Array.from(r.docIDs):null}removeDocByID(e,t){let r=this.getPointKey(e),n=this.nodeMap.get(r);n&&(n.docIDs.delete(t),0===n.docIDs.size&&(this.nodeMap.delete(r),this.deleteNode(n)))}deleteNode(e){let t=e.parent,r=e.left?e.left:e.right;r&&(r.parent=t),t?t.left===e?t.left=r:t.right===e&&(t.right=r):(this.root=r,this.root&&(this.root.parent=null))}searchByRadius(e,t,n=!0,o="asc",i=!1){let s=i?r.vincentyDistance:r.haversineDistance,a=[{node:this.root,depth:0}],l=[];for(;a.length>0;){let{node:r,depth:o}=a.pop();if(null==r)continue;let i=s(e,r.point);(n?i<=t:i>t)&&l.push({point:r.point,docIDs:Array.from(r.docIDs)}),null!=r.left&&a.push({node:r.left,depth:o+1}),null!=r.right&&a.push({node:r.right,depth:o+1})}return o&&l.sort((t,r)=>{let n=s(e,t.point),i=s(e,r.point);return"asc"===o.toLowerCase()?n-i:i-n}),l}searchByPolygon(e,t=!0,n=null,o=!1){let i=[{node:this.root,depth:0}],s=[];for(;i.length>0;){let{node:n,depth:o}=i.pop();if(null==n)continue;null!=n.left&&i.push({node:n.left,depth:o+1}),null!=n.right&&i.push({node:n.right,depth:o+1});let a=r.isPointInPolygon(e,n.point);(a&&t||!a&&!t)&&s.push({point:n.point,docIDs:Array.from(n.docIDs)})}let a=r.calculatePolygonCentroid(e);if(n){let e=o?r.vincentyDistance:r.haversineDistance;s.sort((t,r)=>{let o=e(a,t.point),i=e(a,r.point);return"asc"===n.toLowerCase()?o-i:i-o})}return s}toJSON(){return{root:this.root?this.root.toJSON():null}}static fromJSON(e){let n=new r;return e.root&&(n.root=t.fromJSON(e.root),n.buildNodeMap(n.root)),n}buildNodeMap(e){if(null==e)return;let t=this.getPointKey(e.point);this.nodeMap.set(t,e),e.left&&this.buildNodeMap(e.left),e.right&&this.buildNodeMap(e.right)}static calculatePolygonCentroid(e){let t=0,r=0,n=0,o=e.length;for(let i=0,s=o-1;i<o;s=i++){let o=e[i].lon,a=e[i].lat,l=e[s].lon,u=e[s].lat,c=o*u-l*a;t+=c,r+=(o+l)*c,n+=(a+u)*c}let i=6*(t/=2);return{lon:r/=i,lat:n/=i}}static isPointInPolygon(e,t){let r=!1,n=t.lon,o=t.lat,i=e.length;for(let t=0,s=i-1;t<i;s=t++){let i=e[t].lon,a=e[t].lat,l=e[s].lon,u=e[s].lat;a>o!=u>o&&n<(l-i)*(o-a)/(u-a)+i&&(r=!r)}return r}static haversineDistance(e,t){let r=Math.PI/180,n=e.lat*r,o=t.lat*r,i=(t.lat-e.lat)*r,s=(t.lon-e.lon)*r,a=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n)*Math.cos(o)*Math.sin(s/2)*Math.sin(s/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371e3}static vincentyDistance(e,t){let r,n,o,i,s,a,l,u=1/298.257223563,c=(1-1/298.257223563)*6378137,f=Math.PI/180,d=e.lat*f,h=t.lat*f,p=(t.lon-e.lon)*f,m=Math.atan((1-u)*Math.tan(d)),g=Math.atan((1-u)*Math.tan(h)),I=Math.sin(m),y=Math.cos(m),S=Math.sin(g),b=Math.cos(g),T=p,D=1e3;do{let e=Math.sin(T),t=Math.cos(T);if(0===(n=Math.sqrt(b*e*(b*e)+(y*S-I*b*t)*(y*S-I*b*t))))return 0;i=Math.atan2(n,o=I*S+y*b*t),isNaN(l=o-2*I*S/(a=1-(s=y*b*e/n)*s))&&(l=0);let c=u/16*a*(4+u*(4-3*a));r=T,T=p+(1-c)*u*s*(i+c*n*(l+c*o*(-1+2*l*l)))}while(Math.abs(T-r)>1e-12&&--D>0)if(0===D)return NaN;let A=a*(0x24ffb2985f71-c*c)/(c*c),v=1+A/16384*(4096+A*(-768+A*(320-175*A))),w=A/1024*(256+A*(-128+A*(74-47*A)));return c*v*(i-w*n*(l+w/4*(o*(-1+2*l*l)-w/6*l*(-3+4*n*n)*(-3+4*l*l))))}}},73435:e=>{"use strict";e.s({BoolNode:()=>t});class t{true;false;constructor(){this.true=new Set,this.false=new Set}insert(e,t){t?this.true.add(e):this.false.add(e)}delete(e,t){t?this.true.delete(e):this.false.delete(e)}getSize(){return this.true.size+this.false.size}toJSON(){return{true:Array.from(this.true),false:Array.from(this.false)}}static fromJSON(e){let r=new t;return r.true=new Set(e.true),r.false=new Set(e.false),r}}},88859:e=>{"use strict";function t(e,t,r,n,o,{k:i,b:s,d:a}){return Math.log(1+(r-t+.5)/(t+.5))*(a+e*(i+1))/(e+i*(1-s+s*n/o))}e.s({BM25:()=>t}),e.i(76244)},47653:e=>{"use strict";e.s({DEFAULT_SIMILARITY:()=>t,VectorIndex:()=>r});let t=.8;class r{size;vectors=new Map;constructor(e){this.size=e}add(e,t){t instanceof Float32Array||(t=new Float32Array(t));let r=n(t,this.size);this.vectors.set(e,[r,t])}remove(e){this.vectors.delete(e)}find(e,t,r){return e instanceof Float32Array||(e=new Float32Array(e)),function(e,t,r,o,i){let s=n(e,o),a=[];for(let n of t||r.keys()){let t=r.get(n);if(!t)continue;let l=t[0],u=t[1],c=0;for(let t=0;t<o;t++)c+=e[t]*u[t];let f=c/(s*l);f>=i&&a.push([n,f])}return a}(e,r,this.vectors,this.size,t)}toJSON(){let e=[];for(let[t,[r,n]]of this.vectors)e.push([t,[r,Array.from(n)]]);return{size:this.size,vectors:e}}static fromJSON(e){let t=new r(e.size);for(let[r,[n,o]]of e.vectors)t.vectors.set(r,[n,new Float32Array(o)]);return t}}function n(e,t){let r=0;for(let n=0;n<t;n++)r+=e[n]*e[n];return Math.sqrt(r)}},83461:e=>{"use strict";e.s({createIndex:()=>w});var t=e.i(76244),r=e.i(18),n=e.i(84134),o=e.i(14544),i=e.i(21693),s=e.i(73435),a=e.i(45199),l=e.i(88859);e.i(71306);var u=e.i(3895),c=e.i(19677),f=e.i(47653);function d(e,t,r,n,o){let i=(0,c.getInternalDocumentId)(e.sharedInternalDocumentStore,r);e.avgFieldLength[t]=((e.avgFieldLength[t]??0)*(o-1)+n.length)/o,e.fieldLengths[t][i]=n.length,e.frequencies[t][i]={}}function h(e,t,r,n,o){let i=0;for(let e of n)e===o&&i++;let s=(0,c.getInternalDocumentId)(e.sharedInternalDocumentStore,r),a=i/n.length;e.frequencies[t][s][o]=a,o in e.tokenOccurrences[t]||(e.tokenOccurrences[t][o]=0),e.tokenOccurrences[t][o]=(e.tokenOccurrences[t][o]??0)+1}function p(e,t,r,n){let o=(0,c.getInternalDocumentId)(e.sharedInternalDocumentStore,r);n>1?e.avgFieldLength[t]=(e.avgFieldLength[t]*n-e.fieldLengths[t][o])/(n-1):e.avgFieldLength[t]=void 0,e.fieldLengths[t][o]=void 0,e.frequencies[t][o]=void 0}function m(e,t,r){e.tokenOccurrences[t][r]--}function g(e,t,r,n,o,i,s,a,l,c,f){if((0,u.isVectorType)(s)){var d,h,p,m;return d=t,h=r,p=i,m=o,void d.vectorIndexes[h].node.add(m,p)}let g=n=>{let{type:i,node:s}=t.indexes[r];switch(i){case"Bool":s[n?"true":"false"].add(o);break;case"AVL":{let e=f?.avlRebalanceThreshold??1;s.insert(n,o,e);break}case"Radix":{let i=l.tokenize(n,a,r,!1);for(let n of(e.insertDocumentScoreParameters(t,r,o,i,c),i))e.insertTokenScoreParameters(t,r,o,i,n),s.insert(n,o);break}case"Flat":s.insert(n,o);break;case"BKD":s.insert(n,[o])}};if(!(0,u.isArrayType)(s))return g(i);let I=i.length;for(let e=0;e<I;e++)g(i[e])}function I(e,t,r,n,o,i,s,a,l,c){if((0,u.isVectorType)(s))return t.vectorIndexes[r].node.remove(o),!0;let{type:f,node:d}=t.indexes[r];switch(f){case"AVL":return d.removeDocument(i,o),!0;case"Bool":return d[i?"true":"false"].delete(o),!0;case"Radix":{let s=l.tokenize(i,a,r);for(let i of(e.removeDocumentScoreParameters(t,r,n,c),s))e.removeTokenScoreParameters(t,r,i),d.removeDocumentByWord(i,o);return!0}case"Flat":return d.removeDocument(o,i),!0;case"BKD":return d.removeDocByID(i,o),!1}}function y(e,t,r,n,o,i,s,a,l,c){if(!(0,u.isArrayType)(s))return I(e,t,r,n,o,i,s,a,l,c);let f=(0,u.getInnerType)(s),d=i.length;for(let s=0;s<d;s++)I(e,t,r,n,o,i[s],f,a,l,c);return!0}function S(e,t,r,n,o,i,s,a,u,c){let f=Array.from(n),d=e.avgFieldLength[t],h=e.fieldLengths[t],p=e.tokenOccurrences[t],m=e.frequencies[t],g="number"==typeof p[r]?p[r]??0:0,I=f.length;for(let e=0;e<I;e++){let n=f[e];if(u&&!u.has(n))continue;c.has(n)||c.set(n,new Map);let p=c.get(n);p.set(t,(p.get(t)||0)+1);let I=m?.[n]?.[r]??0,y=(0,l.BM25)(I,g,o,h[n],d,i);s.has(n)?s.set(n,s.get(n)+y*a):s.set(n,y*a)}}function b(e,r,n,o,i,s,a,l,u,c,f,d=0){let h=n.tokenize(r,o),p=h.length||1,m=new Map,g=new Map,I=new Map;for(let n of i){if(!(n in e.indexes))continue;let o=e.indexes[n],{type:i}=o;if("Radix"!==i)throw(0,t.createError)("WRONG_SEARCH_PROPERTY_TYPE",n);let d=l[n]??1;if(d<=0)throw(0,t.createError)("INVALID_BOOST_VALUE",d);0!==h.length||r||h.push("");let p=h.length;for(let t=0;t<p;t++){let r=h[t],i=o.node.find({term:r,exact:s,tolerance:a}),l=Object.keys(i);l.length>0&&g.set(r,!0);let p=l.length;for(let t=0;t<p;t++){let r=l[t],o=i[r];S(e,n,r,o,c,u,I,d,f,m)}}}let y=Array.from(I.entries()).map(([e,t])=>[e,t]).sort((e,t)=>t[1]-e[1]);if(0===y.length)return[];if(1===d)return y;if(0===d){if(1===p)return y;for(let e of h)if(!g.get(e))return[];return y.filter(([e])=>{let t=m.get(e);return!!t&&Array.from(t.values()).some(e=>e===p)})}let T=y.filter(([e])=>{let t=m.get(e);return!!t&&Array.from(t.values()).some(e=>e===p)});if(T.length>0){let e=y.filter(([e])=>!T.some(([t])=>t===e)),t=Math.ceil(e.length*d);return[...T,...e.slice(0,t)]}return y}function T(e){return e.searchableProperties}function D(e){return e.searchablePropertiesWithTypes}function A(e,t){let{indexes:a,vectorIndexes:l,searchableProperties:u,searchablePropertiesWithTypes:c,frequencies:d,tokenOccurrences:h,avgFieldLength:p,fieldLengths:m}=t,g={},I={};for(let e of Object.keys(a)){let{node:t,type:l,isArray:u}=a[e];switch(l){case"Radix":g[e]={type:"Radix",node:o.RadixTree.fromJSON(t),isArray:u};break;case"Flat":g[e]={type:"Flat",node:n.FlatTree.fromJSON(t),isArray:u};break;case"AVL":g[e]={type:"AVL",node:r.AVLTree.fromJSON(t),isArray:u};break;case"BKD":g[e]={type:"BKD",node:i.BKDTree.fromJSON(t),isArray:u};break;case"Bool":g[e]={type:"Bool",node:s.BoolNode.fromJSON(t),isArray:u};break;default:g[e]=a[e]}}for(let e of Object.keys(l))I[e]={type:"Vector",isArray:!1,node:f.VectorIndex.fromJSON(l[e])};return{sharedInternalDocumentStore:e,indexes:g,vectorIndexes:I,searchableProperties:u,searchablePropertiesWithTypes:c,frequencies:d,tokenOccurrences:h,avgFieldLength:p,fieldLengths:m}}function v(e){let{indexes:t,vectorIndexes:r,searchableProperties:n,searchablePropertiesWithTypes:o,frequencies:i,tokenOccurrences:s,avgFieldLength:a,fieldLengths:l}=e,u={};for(let e of Object.keys(r))u[e]=r[e].node.toJSON();let c={};for(let e of Object.keys(t)){let{type:r,node:n,isArray:o}=t[e];"Flat"===r||"Radix"===r||"AVL"===r||"BKD"===r||"Bool"===r?c[e]={type:r,node:n.toJSON(),isArray:o}:(c[e]=t[e],c[e].node=c[e].node.toJSON())}return{indexes:c,vectorIndexes:u,searchableProperties:n,searchablePropertiesWithTypes:o,frequencies:i,tokenOccurrences:s,avgFieldLength:a,fieldLengths:l}}function w(){return{create:function e(a,l,c,d,h=""){for(let[p,m]of(d||(d={sharedInternalDocumentStore:l,indexes:{},vectorIndexes:{},searchableProperties:[],searchablePropertiesWithTypes:{},frequencies:{},tokenOccurrences:{},avgFieldLength:{},fieldLengths:{}}),Object.entries(c))){let c=`${h}${h?".":""}${p}`;if("object"==typeof m&&!Array.isArray(m)){e(a,l,m,d,c);continue}if((0,u.isVectorType)(m))d.searchableProperties.push(c),d.searchablePropertiesWithTypes[c]=m,d.vectorIndexes[c]={type:"Vector",node:new f.VectorIndex((0,u.getVectorSize)(m)),isArray:!1};else{let e=/\[/.test(m);switch(m){case"boolean":case"boolean[]":d.indexes[c]={type:"Bool",node:new s.BoolNode,isArray:e};break;case"number":case"number[]":d.indexes[c]={type:"AVL",node:new r.AVLTree(0,[]),isArray:e};break;case"string":case"string[]":d.indexes[c]={type:"Radix",node:new o.RadixTree,isArray:e},d.avgFieldLength[c]=0,d.frequencies[c]={},d.tokenOccurrences[c]={},d.fieldLengths[c]={};break;case"enum":case"enum[]":d.indexes[c]={type:"Flat",node:new n.FlatTree,isArray:e};break;case"geopoint":d.indexes[c]={type:"BKD",node:new i.BKDTree,isArray:e};break;default:throw(0,t.createError)("INVALID_SCHEMA_TYPE",Array.isArray(m)?"array":m,c)}d.searchableProperties.push(c),d.searchablePropertiesWithTypes[c]=m}}return d},insert:g,remove:y,insertDocumentScoreParameters:d,insertTokenScoreParameters:h,removeDocumentScoreParameters:p,removeTokenScoreParameters:m,calculateResultScores:S,search:b,searchByWhereClause:function e(r,n,o,i){if("and"in o&&o.and&&Array.isArray(o.and)){let t=o.and;if(0===t.length)return new Set;let s=t.map(t=>e(r,n,t,i));return(0,a.setIntersection)(...s)}if("or"in o&&o.or&&Array.isArray(o.or)){let t=o.or;return 0===t.length?new Set:t.map(t=>e(r,n,t,i)).reduce((e,t)=>(0,a.setUnion)(e,t),new Set)}if("not"in o&&o.not){let t=o.not,s=new Set,l=r.sharedInternalDocumentStore;for(let e=1;e<=l.internalIdToId.length;e++)s.add(e);let u=e(r,n,t,i);return(0,a.setDifference)(s,u)}let s=Object.keys(o),l=s.reduce((e,t)=>({[t]:new Set,...e}),{});for(let e of s){let s=o[e];if(void 0===r.indexes[e])throw(0,t.createError)("UNKNOWN_FILTER_PROPERTY",e);let{node:u,type:c,isArray:f}=r.indexes[e];if("Bool"===c){let t=s?u.true:u.false;l[e]=(0,a.setUnion)(l[e],t);continue}if("BKD"===c){let t;if("radius"in s)t="radius";else if("polygon"in s)t="polygon";else throw Error(`Invalid operation ${s}`);if("radius"===t){let{value:r,coordinates:n,unit:o="m",inside:i=!0,highPrecision:c=!1}=s[t],f=(0,a.convertDistanceToMeters)(r,o),d=u.searchByRadius(n,f,i,void 0,c);l[e]=N(l[e],d)}else{let{coordinates:r,inside:n=!0,highPrecision:o=!1}=s[t],i=u.searchByPolygon(r,n,void 0,o);l[e]=N(l[e],i)}continue}if("Radix"===c&&("string"==typeof s||Array.isArray(s))){for(let t of[s].flat())for(let r of n.tokenize(t,i,e)){let t=u.find({term:r,exact:!0});l[e]=function(e,t){e||(e=new Set);let r=Object.keys(t),n=r.length;for(let o=0;o<n;o++){let n=t[r[o]],i=n.length;for(let t=0;t<i;t++)e.add(n[t])}return e}(l[e],t)}continue}let d=Object.keys(s);if(d.length>1)throw(0,t.createError)("INVALID_FILTER_OPERATION",d.length);if("Flat"===c){let t=new Set(f?u.filterArr(s):u.filter(s));l[e]=(0,a.setUnion)(l[e],t);continue}if("AVL"===c){let r,n=d[0],o=s[n];switch(n){case"gt":r=u.greaterThan(o,!1);break;case"gte":r=u.greaterThan(o,!0);break;case"lt":r=u.lessThan(o,!1);break;case"lte":r=u.lessThan(o,!0);break;case"eq":r=u.find(o)??new Set;break;case"between":{let[e,t]=o;r=u.rangeSearch(e,t);break}default:throw(0,t.createError)("INVALID_FILTER_OPERATION",n)}l[e]=(0,a.setUnion)(l[e],r)}}return(0,a.setIntersection)(...Object.values(l))},getSearchableProperties:T,getSearchablePropertiesWithTypes:D,load:A,save:v}}function N(e,t){e||(e=new Set);let r=t.length;for(let n=0;n<r;n++){let r=t[n].docIDs,o=r.length;for(let t=0;t<o;t++)e.add(r[t])}return e}},21887:e=>{"use strict";e.s({createSorter:()=>S});var t=e.i(76244);e.i(71306);var r=e.i(3895),n=e.i(19677),o=e.i(45199),i=e.i(5669);function s(e,n,i,s){return s?.enabled===!1?{disabled:!0}:function e(n,i,s,a,l){let u={language:n.tokenizer.language,sharedInternalDocumentStore:i,enabled:!0,isSorted:!0,sortableProperties:[],sortablePropertiesWithTypes:{},sorts:{}};for(let[c,f]of Object.entries(s)){let s=`${l}${l?".":""}${c}`;if(!a.includes(s)){if("object"==typeof f&&!Array.isArray(f)){let t=e(n,i,f,a,s);(0,o.safeArrayPush)(u.sortableProperties,t.sortableProperties),u.sorts={...u.sorts,...t.sorts},u.sortablePropertiesWithTypes={...u.sortablePropertiesWithTypes,...t.sortablePropertiesWithTypes};continue}if(!(0,r.isVectorType)(f))switch(f){case"boolean":case"number":case"string":u.sortableProperties.push(s),u.sortablePropertiesWithTypes[s]=f,u.sorts[s]={docs:new Map,orderedDocsToRemove:new Map,orderedDocs:[],type:f};break;case"geopoint":case"enum":case"enum[]":case"boolean[]":case"number[]":case"string[]":continue;default:throw(0,t.createError)("INVALID_SORT_SCHEMA_TYPE",Array.isArray(f)?"array":f,s)}}}return u}(e,n,i,(s||{}).unsortableProperties||[],"")}function a(e,t,r,o){if(!e.enabled)return;e.isSorted=!1;let i=(0,n.getInternalDocumentId)(e.sharedInternalDocumentStore,r),s=e.sorts[t];s.orderedDocsToRemove.has(i)&&d(e,t),s.docs.set(i,s.orderedDocs.length),s.orderedDocs.push([i,o])}function l(e){if(!e.isSorted&&e.enabled){for(let t of Object.keys(e.sorts))!function(e,t){let r,n=e.sorts[t];switch(n.type){case"string":r=u.bind(null,e.language);break;case"number":r=c.bind(null);break;case"boolean":r=f.bind(null)}n.orderedDocs.sort(r);let o=n.orderedDocs.length;for(let e=0;e<o;e++){let t=n.orderedDocs[e][0];n.docs.set(t,e)}}(e,t);e.isSorted=!0}}function u(e,t,r){return t[1].localeCompare(r[1],(0,i.getLocale)(e))}function c(e,t){return e[1]-t[1]}function f(e,t){return t[1]?-1:1}function d(e,t){let r=e.sorts[t];r.orderedDocsToRemove.size&&(r.orderedDocs=r.orderedDocs.filter(e=>!r.orderedDocsToRemove.has(e[0])),r.orderedDocsToRemove.clear())}function h(e,t,r){if(!e.enabled)return;let o=e.sorts[t],i=(0,n.getInternalDocumentId)(e.sharedInternalDocumentStore,r);o.docs.get(i)&&(o.docs.delete(i),o.orderedDocsToRemove.set(i,!0))}function p(e,r,o){if(!e.enabled)throw(0,t.createError)("SORT_DISABLED");let i=o.property,s="DESC"===o.order,a=e.sorts[i];if(!a)throw(0,t.createError)("UNABLE_TO_SORT_ON_UNKNOWN_FIELD",i,e.sortableProperties.join(", "));return d(e,i),l(e),r.sort((t,r)=>{let o=a.docs.get((0,n.getInternalDocumentId)(e.sharedInternalDocumentStore,t[0])),i=a.docs.get((0,n.getInternalDocumentId)(e.sharedInternalDocumentStore,r[0])),l=void 0!==o,u=void 0!==i;return l||u?l?u?s?i-o:o-i:-1:1:0}),r}function m(e){return e.enabled?e.sortableProperties:[]}function g(e){return e.enabled?e.sortablePropertiesWithTypes:{}}function I(e,t){if(!t.enabled)return{enabled:!1};let r=Object.keys(t.sorts).reduce((e,r)=>{let{docs:n,orderedDocs:o,type:i}=t.sorts[r];return e[r]={docs:new Map(Object.entries(n).map(([e,t])=>[+e,t])),orderedDocsToRemove:new Map,orderedDocs:o,type:i},e},{});return{sharedInternalDocumentStore:e,language:t.language,sortableProperties:t.sortableProperties,sortablePropertiesWithTypes:t.sortablePropertiesWithTypes,sorts:r,enabled:!0,isSorted:t.isSorted}}function y(e){if(!e.enabled)return{enabled:!1};for(let t of Object.keys(e.sorts))d(e,t);l(e);let t=Object.keys(e.sorts).reduce((t,r)=>{let{docs:n,orderedDocs:o,type:i}=e.sorts[r];return t[r]={docs:Object.fromEntries(n.entries()),orderedDocs:o,type:i},t},{});return{language:e.language,sortableProperties:e.sortableProperties,sortablePropertiesWithTypes:e.sortablePropertiesWithTypes,sorts:t,enabled:e.enabled,isSorted:e.isSorted}}function S(){return{create:s,insert:a,remove:h,save:y,load:I,sortBy:p,getSortableProperties:m,getSortablePropertiesWithTypes:g}}},53428:e=>{"use strict";e.s({replaceDiacritics:()=>r});let t=[65,65,65,65,65,65,65,67,69,69,69,69,73,73,73,73,69,78,79,79,79,79,79,null,79,85,85,85,85,89,80,115,97,97,97,97,97,97,97,99,101,101,101,101,105,105,105,105,101,110,111,111,111,111,111,null,111,117,117,117,117,121,112,121,65,97,65,97,65,97,67,99,67,99,67,99,67,99,68,100,68,100,69,101,69,101,69,101,69,101,69,101,71,103,71,103,71,103,71,103,72,104,72,104,73,105,73,105,73,105,73,105,73,105,73,105,74,106,75,107,107,76,108,76,108,76,108,76,108,76,108,78,110,78,110,78,110,110,78,110,79,111,79,111,79,111,79,111,82,114,82,114,82,114,83,115,83,115,83,115,83,115,84,116,84,116,84,116,85,117,85,117,85,117,85,117,85,117,85,117,87,119,89,121,89,90,122,90,122,90,122,115];function r(e){let r=[];for(let o=0;o<e.length;o++){var n;r[o]=(n=e.charCodeAt(o))<192||n>383?n:t[n-192]||n}return String.fromCharCode(...r)}},72728:e=>{"use strict";e.s({stemmer:()=>c});let t={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},r={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},n="[aeiouy]",o="[^aeiou][^aeiouy]*",i=n+"[aeiou]*",s="^("+o+")?"+i+o,a="^("+o+")?"+i+o+"("+i+")?$",l="^("+o+")?"+i+o+i+o,u="^("+o+")?"+n;function c(e){let i,c,f,d,h,p;if(e.length<3)return e;let m=e.substring(0,1);if("y"==m&&(e=m.toUpperCase()+e.substring(1)),d=/^(.+?)([^s])s$/,(f=/^(.+?)(ss|i)es$/).test(e)?e=e.replace(f,"$1$2"):d.test(e)&&(e=e.replace(d,"$1$2")),d=/^(.+?)(ed|ing)$/,(f=/^(.+?)eed$/).test(e)){let t=f.exec(e);(f=new RegExp(s)).test(t[1])&&(f=/.$/,e=e.replace(f,""))}else d.test(e)&&(i=d.exec(e)[1],(d=new RegExp(u)).test(i)&&(e=i,d=/(at|bl|iz)$/,h=RegExp("([^aeiouylsz])\\1$"),p=RegExp("^"+o+n+"[^aeiouwxy]$"),d.test(e)?e+="e":h.test(e)?(f=/.$/,e=e.replace(f,"")):p.test(e)&&(e+="e")));if((f=/^(.+?)y$/).test(e)){let t=f.exec(e);i=t?.[1],f=new RegExp(u),i&&f.test(i)&&(e=i+"i")}if((f=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/).test(e)){let r=f.exec(e);i=r?.[1],c=r?.[2],f=new RegExp(s),i&&f.test(i)&&(e=i+t[c])}if((f=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/).test(e)){let t=f.exec(e);i=t?.[1],c=t?.[2],f=new RegExp(s),i&&f.test(i)&&(e=i+r[c])}if(d=/^(.+?)(s|t)(ion)$/,(f=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/).test(e)){let t=f.exec(e);i=t?.[1],f=new RegExp(l),i&&f.test(i)&&(e=i)}else if(d.test(e)){let t=d.exec(e);i=t?.[1]??""+t?.[2]??"",(d=new RegExp(l)).test(i)&&(e=i)}if((f=/^(.+?)e$/).test(e)){let t=f.exec(e);i=t?.[1],f=new RegExp(l),d=new RegExp(a),h=RegExp("^"+o+n+"[^aeiouwxy]$"),i&&(f.test(i)||d.test(i)&&!h.test(i))&&(e=i)}return f=/ll$/,d=new RegExp(l),f.test(e)&&d.test(e)&&(f=/.$/,e=e.replace(f,"")),"y"==m&&(e=m.toLowerCase()+e.substring(1)),e}},78117:e=>{"use strict";e.s({createTokenizer:()=>a});var t=e.i(76244),r=e.i(53428),n=e.i(5669),o=e.i(72728);function i(e,t,n=!0){let o=`${this.language}:${e}:${t}`;return n&&this.normalizationCache.has(o)?this.normalizationCache.get(o):this.stopWords?.includes(t)?(n&&this.normalizationCache.set(o,""),""):(this.stemmer&&!this.stemmerSkipProperties.has(e)&&(t=this.stemmer(t)),t=(0,r.replaceDiacritics)(t),n&&this.normalizationCache.set(o,t),t)}function s(e,r,o,i=!0){let a;if(r&&r!==this.language)throw(0,t.createError)("LANGUAGE_NOT_SUPPORTED",r);if("string"!=typeof e)return[e];let l=this.normalizeToken.bind(this,o??"");if(o&&this.tokenizeSkipProperties.has(o))a=[l(e,i)];else{let t=n.SPLITTERS[this.language];a=e.toLowerCase().split(t).map(e=>l(e,i)).filter(Boolean)}let u=function(e){for(;""===e[e.length-1];)e.pop();for(;""===e[0];)e.shift();return e}(a);return this.allowDuplicates?u:Array.from(new Set(u))}function a(e={}){let r,l;if(e.language){if(!n.SUPPORTED_LANGUAGES.includes(e.language))throw(0,t.createError)("LANGUAGE_NOT_SUPPORTED",e.language)}else e.language="english";if(e.stemming||e.stemmer&&!("stemming"in e))if(e.stemmer){if("function"!=typeof e.stemmer)throw(0,t.createError)("INVALID_STEMMER_FUNCTION_TYPE");r=e.stemmer}else if("english"===e.language)r=o.stemmer;else throw(0,t.createError)("MISSING_STEMMER",e.language);if(!1!==e.stopWords){if(l=[],Array.isArray(e.stopWords))l=e.stopWords;else if("function"==typeof e.stopWords)l=e.stopWords(l);else if(e.stopWords)throw(0,t.createError)("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY");if(!Array.isArray(l))throw(0,t.createError)("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY");for(let e of l)if("string"!=typeof e)throw(0,t.createError)("CUSTOM_STOP_WORDS_MUST_BE_FUNCTION_OR_ARRAY")}let u={tokenize:s,language:e.language,stemmer:r,stemmerSkipProperties:new Set(e.stemmerSkipProperties?[e.stemmerSkipProperties].flat():[]),tokenizeSkipProperties:new Set(e.tokenizeSkipProperties?[e.tokenizeSkipProperties].flat():[]),stopWords:l,allowDuplicates:!!e.allowDuplicates,normalizeToken:i,normalizationCache:new Map};return u.tokenize=s.bind(u),u.normalizeToken=i,u}},58996:e=>{"use strict";e.s({create:()=>f}),e.i(71306);var t=e.i(3895),r=e.i(45199),n=e.i(6723),o=e.i(56627),i=e.i(48477),s=e.i(83461),a=e.i(19677),l=e.i(21887),u=e.i(78117),c=e.i(76244);function f({schema:e,sort:f,language:d,components:h,id:p,plugins:m}){for(let t of(h||(h={}),m??[])){if(!("getComponents"in t)||"function"!=typeof t.getComponents)continue;let r=t.getComponents(e);for(let e of Object.keys(r))if(h[e])throw(0,c.createError)("PLUGIN_COMPONENT_CONFLICT",e,t.name);h={...h,...r}}p||(p=(0,r.uniqueId)());let g=h.tokenizer,I=h.index,y=h.documentsStore,S=h.sorter;if(g=g?g.tokenize?g:(0,u.createTokenizer)(g):(0,u.createTokenizer)({language:d??"english"}),h.tokenizer&&d)throw(0,c.createError)("NO_LANGUAGE_WITH_CUSTOM_TOKENIZER");let b=(0,a.createInternalDocumentIDStore)();I||=(0,s.createIndex)(),S||=(0,l.createSorter)(),y||=(0,n.createDocumentsStore)();var T=h;let D={formatElapsedTime:t.formatElapsedTime,getDocumentIndexId:t.getDocumentIndexId,getDocumentProperties:r.getDocumentProperties,validateSchema:t.validateSchema};for(let e of i.FUNCTION_COMPONENTS)if(T[e]){if("function"!=typeof T[e])throw(0,c.createError)("COMPONENT_MUST_BE_FUNCTION",e)}else T[e]=D[e];for(let e of Object.keys(T))if(!i.OBJECT_COMPONENTS.includes(e)&&!i.FUNCTION_COMPONENTS.includes(e))throw(0,c.createError)("UNSUPPORTED_COMPONENT",e);let{getDocumentProperties:A,getDocumentIndexId:v,validateSchema:w,formatElapsedTime:N}=h,O={data:{},caches:{},schema:e,tokenizer:g,index:I,sorter:S,documentsStore:y,internalDocumentIDStore:b,getDocumentProperties:A,getDocumentIndexId:v,validateSchema:w,beforeInsert:[],afterInsert:[],beforeRemove:[],afterRemove:[],beforeUpdate:[],afterUpdate:[],beforeUpsert:[],afterUpsert:[],beforeSearch:[],afterSearch:[],beforeInsertMultiple:[],afterInsertMultiple:[],beforeRemoveMultiple:[],afterRemoveMultiple:[],beforeUpdateMultiple:[],afterUpdateMultiple:[],beforeUpsertMultiple:[],afterUpsertMultiple:[],afterCreate:[],formatElapsedTime:N,id:p,plugins:m,version:"{{VERSION}}"};for(let t of(O.data={index:O.index.create(O,b,e),docs:O.documentsStore.create(O,b),sorting:O.sorter.create(O,b,e,f)},o.AVAILABLE_PLUGIN_HOOKS))O[t]=(O[t]??[]).concat((0,o.getAllPluginsByHook)(O,t));let E=O.afterCreate;return E&&(0,i.runAfterCreate)(E,O),O}},59915:e=>{"use strict";function t(e,t){return e.documentsStore.get(e.data.docs,t)}function r(e){return e.documentsStore.count(e.data.docs)}e.s({count:()=>r,getByID:()=>t})},52339:e=>{"use strict";e.s({}),e.i(71306),e.i(6723),e.i(83461),e.i(78117),e.i(21887),e.i(19677)},79927:e=>{"use strict";e.s({}),e.i(71306),e.i(6723),e.i(83461),e.i(78117),e.i(21887),e.i(19677),e.i(52339)},46590:e=>{"use strict";e.s({innerInsertMultiple:()=>h,insert:()=>s}),e.i(79927);var t=e.i(3895),r=e.i(45199),n=e.i(48477),o=e.i(76244),i=e.i(19677);function s(e,t,s,a,l){let f=e.validateSchema(t,e.schema);if(f)throw(0,o.createError)("SCHEMA_VALIDATION_FAILURE",f);return(0,r.isAsyncFunction)(e.beforeInsert)||(0,r.isAsyncFunction)(e.afterInsert)||(0,r.isAsyncFunction)(e.index.beforeInsert)||(0,r.isAsyncFunction)(e.index.insert)||(0,r.isAsyncFunction)(e.index.afterInsert)?u(e,t,s,a,l):function(e,t,r,s,a){let{index:l,docs:u}=e.data,f=e.getDocumentIndexId(t);if("string"!=typeof f)throw(0,o.createError)("DOCUMENT_ID_MUST_BE_STRING",typeof f);let d=(0,i.getInternalDocumentId)(e.internalDocumentIDStore,f);if(!e.documentsStore.store(u,f,d,t))throw(0,o.createError)("DOCUMENT_ALREADY_EXISTS",f);let h=e.documentsStore.count(u);s||(0,n.runSingleHook)(e.beforeInsert,e,f,t);let p=e.index.getSearchableProperties(l),m=e.index.getSearchablePropertiesWithTypes(l),g=e.getDocumentProperties(t,p);for(let[e,t]of Object.entries(g))void 0!==t&&c(typeof t,m[e],e,t);return function(e,t,r,n,o,s,a,l){for(let a of r){let r=n[a];if(void 0===r)continue;let u=e.index.getSearchablePropertiesWithTypes(e.data.index)[a],c=(0,i.getInternalDocumentId)(e.internalDocumentIDStore,t);e.index.beforeInsert?.(e.data.index,a,t,r,u,s,e.tokenizer,o),e.index.insert(e.index,e.data.index,a,t,c,r,u,s,e.tokenizer,o,l),e.index.afterInsert?.(e.data.index,a,t,r,u,s,e.tokenizer,o)}let u=e.sorter.getSortableProperties(e.data.sorting),c=e.getDocumentProperties(a,u);for(let r of u){let n=c[r];if(void 0===n)continue;let o=e.sorter.getSortablePropertiesWithTypes(e.data.sorting)[r];e.sorter.insert(e.data.sorting,r,t,n,o,s)}}(e,f,p,g,h,r,t,a),s||(0,n.runSingleHook)(e.afterInsert,e,f,t),f}(e,t,s,a,l)}let a=new Set(["enum","enum[]"]),l=new Set(["string","number"]);async function u(e,t,r,s,a){let{index:l,docs:u}=e.data,d=e.getDocumentIndexId(t);if("string"!=typeof d)throw(0,o.createError)("DOCUMENT_ID_MUST_BE_STRING",typeof d);let h=(0,i.getInternalDocumentId)(e.internalDocumentIDStore,d);if(!e.documentsStore.store(u,d,h,t))throw(0,o.createError)("DOCUMENT_ALREADY_EXISTS",d);let p=e.documentsStore.count(u);s||await (0,n.runSingleHook)(e.beforeInsert,e,d,t);let m=e.index.getSearchableProperties(l),g=e.index.getSearchablePropertiesWithTypes(l),I=e.getDocumentProperties(t,m);for(let[e,t]of Object.entries(I))void 0!==t&&c(typeof t,g[e],e,t);return await f(e,d,m,I,p,r,t,a),s||await (0,n.runSingleHook)(e.afterInsert,e,d,t),d}function c(e,r,n,i){if(!((0,t.isGeoPointType)(r)&&"object"==typeof i&&"number"==typeof i.lon&&"number"==typeof i.lat||(0,t.isVectorType)(r)&&Array.isArray(i)||(0,t.isArrayType)(r)&&Array.isArray(i))&&!(a.has(r)&&l.has(e))&&e!==r)throw(0,o.createError)("INVALID_DOCUMENT_PROPERTY",n,r,e)}async function f(e,t,r,n,o,i,s,a){for(let s of r){let r=n[s];if(void 0===r)continue;let l=e.index.getSearchablePropertiesWithTypes(e.data.index)[s];await e.index.beforeInsert?.(e.data.index,s,t,r,l,i,e.tokenizer,o);let u=e.internalDocumentIDStore.idToInternalId.get(t);await e.index.insert(e.index,e.data.index,s,t,u,r,l,i,e.tokenizer,o,a),await e.index.afterInsert?.(e.data.index,s,t,r,l,i,e.tokenizer,o)}let l=e.sorter.getSortableProperties(e.data.sorting),u=e.getDocumentProperties(s,l);for(let r of l){let n=u[r];if(void 0===n)continue;let o=e.sorter.getSortablePropertiesWithTypes(e.data.sorting)[r];e.sorter.insert(e.data.sorting,r,t,n,o,i)}}async function d(e,t,o=1e3,i,a,l=0){let u=[],c=async r=>{let n=Math.min(r+o,t.length),l=t.slice(r,n);for(let t of l){let r={avlRebalanceThreshold:l.length},n=await s(e,t,i,a,r);u.push(n)}return n},f=async()=>{let e=0;for(;e<t.length;){let t=Date.now();if(e=await c(e),l>0){let e=l-(Date.now()-t);e>0&&(0,r.sleep)(e)}}};return await f(),a||await (0,n.runMultipleHook)(e.afterInsertMultiple,e,t),u}function h(e,t,o,i,a,l){return(0,r.isAsyncFunction)(e.beforeInsert)||(0,r.isAsyncFunction)(e.afterInsert)||(0,r.isAsyncFunction)(e.index.beforeInsert)||(0,r.isAsyncFunction)(e.index.insert)||(0,r.isAsyncFunction)(e.index.afterInsert)?d(e,t,o,i,a,l):function(e,t,o=1e3,i,a,l=0){let u=[],c=0,f=Date.now();for(;function(){let r=t.slice(c*o,(c+1)*o);if(0===r.length)return!1;for(let t of r){let n=s(e,t,i,a,{avlRebalanceThreshold:r.length});u.push(n)}return c++,!0}();)if(l>0){let e=Date.now()-f;if(e>=l){let t=l-e%l;t>0&&(0,r.sleep)(t)}}return a||(0,n.runMultipleHook)(e.afterInsertMultiple,e,t),u}(e,t,o,i,a,l)}},27801:e=>{"use strict";e.s({remove:()=>o,removeMultiple:()=>s});var t=e.i(48477),r=e.i(19677),n=e.i(45199);function o(e,o,s,a){return(0,n.isAsyncFunction)(e.index.beforeRemove)||(0,n.isAsyncFunction)(e.index.remove)||(0,n.isAsyncFunction)(e.index.afterRemove)?i(e,o,s,a):function(e,n,o,i){let s=!0,{index:a,docs:l}=e.data,u=e.documentsStore.get(l,n);if(!u)return!1;let c=(0,r.getInternalDocumentId)(e.internalDocumentIDStore,n),f=(0,r.getDocumentIdFromInternalId)(e.internalDocumentIDStore,c),d=e.documentsStore.count(l);i||(0,t.runSingleHook)(e.beforeRemove,e,f);let h=e.index.getSearchableProperties(a),p=e.index.getSearchablePropertiesWithTypes(a),m=e.getDocumentProperties(u,h);for(let t of h){let r=m[t];if(void 0===r)continue;let i=p[t];e.index.beforeRemove?.(e.data.index,t,f,r,i,o,e.tokenizer,d),e.index.remove(e.index,e.data.index,t,n,c,r,i,o,e.tokenizer,d)||(s=!1),e.index.afterRemove?.(e.data.index,t,f,r,i,o,e.tokenizer,d)}let g=e.sorter.getSortableProperties(e.data.sorting),I=e.getDocumentProperties(u,g);for(let t of g)void 0!==I[t]&&e.sorter.remove(e.data.sorting,t,n);return i||(0,t.runSingleHook)(e.afterRemove,e,f),e.documentsStore.remove(e.data.docs,n,c),s}(e,o,s,a)}async function i(e,n,o,i){let s=!0,{index:a,docs:l}=e.data,u=e.documentsStore.get(l,n);if(!u)return!1;let c=(0,r.getInternalDocumentId)(e.internalDocumentIDStore,n),f=(0,r.getDocumentIdFromInternalId)(e.internalDocumentIDStore,c),d=e.documentsStore.count(l);i||await (0,t.runSingleHook)(e.beforeRemove,e,f);let h=e.index.getSearchableProperties(a),p=e.index.getSearchablePropertiesWithTypes(a),m=e.getDocumentProperties(u,h);for(let t of h){let r=m[t];if(void 0===r)continue;let i=p[t];await e.index.beforeRemove?.(e.data.index,t,f,r,i,o,e.tokenizer,d),await e.index.remove(e.index,e.data.index,t,n,c,r,i,o,e.tokenizer,d)||(s=!1),await e.index.afterRemove?.(e.data.index,t,f,r,i,o,e.tokenizer,d)}let g=await e.sorter.getSortableProperties(e.data.sorting),I=await e.getDocumentProperties(u,g);for(let t of g)void 0!==I[t]&&e.sorter.remove(e.data.sorting,t,n);return i||await (0,t.runSingleHook)(e.afterRemove,e,f),e.documentsStore.remove(e.data.docs,n,c),s}function s(e,i,s,l,u){return(0,n.isAsyncFunction)(e.index.beforeRemove)||(0,n.isAsyncFunction)(e.index.remove)||(0,n.isAsyncFunction)(e.index.afterRemove)||(0,n.isAsyncFunction)(e.beforeRemoveMultiple)||(0,n.isAsyncFunction)(e.afterRemoveMultiple)?a(e,i,s,l,u):function(e,n,i,s,a){let l=0;i||(i=1e3);let u=a?[]:n.map(t=>(0,r.getDocumentIdFromInternalId)(e.internalDocumentIDStore,(0,r.getInternalDocumentId)(e.internalDocumentIDStore,t)));a||(0,t.runMultipleHook)(e.beforeRemoveMultiple,e,u);let c=0;return!function t(){let r=n.slice(c*i,++c*i);if(r.length){for(let t of r)o(e,t,s,a)&&l++;setTimeout(t,0)}}(),a||(0,t.runMultipleHook)(e.afterRemoveMultiple,e,u),l}(e,i,s,l,u)}async function a(e,n,i,s,a){let l=0;i||(i=1e3);let u=a?[]:n.map(t=>(0,r.getDocumentIdFromInternalId)(e.internalDocumentIDStore,(0,r.getInternalDocumentId)(e.internalDocumentIDStore,t)));return a||await (0,t.runMultipleHook)(e.beforeRemoveMultiple,e,u),await new Promise((t,r)=>{let u=0;async function c(){let f=n.slice(u*i,++u*i);if(!f.length)return t();for(let t of f)try{await o(e,t,s,a)&&l++}catch(e){r(e)}setTimeout(c,0)}setTimeout(c,0)}),a||await (0,t.runMultipleHook)(e.afterRemoveMultiple,e,u),l}},66133:e=>{"use strict";e.s({MODE_FULLTEXT_SEARCH:()=>t,MODE_HYBRID_SEARCH:()=>r,MODE_VECTOR_SEARCH:()=>n});let t="fulltext",r="hybrid",n="vector"},89766:e=>{"use strict";e.s({getFacets:()=>i});var t=e.i(76244),r=e.i(45199);function n(e,t){return e[1]-t[1]}function o(e,t){return t[1]-e[1]}function i(e,i,l){let u={},c=i.map(([e])=>e),f=e.documentsStore.getMultiple(e.data.docs,c),d=Object.keys(l),h=e.index.getSearchablePropertiesWithTypes(e.data.index);for(let e of d){let t;if("number"===h[e]){let{ranges:r}=l[e],n=r.length,o=Array.from({length:n});for(let e=0;e<n;e++){let t=r[e];o[e]=[`${t.from}-${t.to}`,0]}t=Object.fromEntries(o)}u[e]={count:0,values:t??{}}}let p=f.length;for(let e=0;e<p;e++){let n=f[e];for(let e of d){let o=e.includes(".")?(0,r.getNested)(n,e):n[e],i=h[e],c=u[e].values;switch(i){case"number":s(l[e].ranges,c)(o);break;case"number[]":{let t=new Set,r=s(l[e].ranges,c,t);for(let e of o)r(e);break}case"boolean":case"enum":case"string":a(c,i)(o);break;case"boolean[]":case"enum[]":case"string[]":{let e=a(c,"boolean[]"===i?"boolean":"string",new Set);for(let t of o)e(t);break}default:throw(0,t.createError)("FACET_NOT_SUPPORTED",i)}}}for(let e of d){let t=u[e];if(t.count=Object.keys(t.values).length,"string"===h[e]){let r=l[e],i=function(e="desc"){return"asc"===e.toLowerCase()?n:o}(r.sort);t.values=Object.fromEntries(Object.entries(t.values).sort(i).slice(r.offset??0,r.limit??10))}}return u}function s(e,t,r){return n=>{for(let o of e){let e=`${o.from}-${o.to}`;!r?.has(e)&&n>=o.from&&n<=o.to&&(void 0===t[e]?t[e]=1:(t[e]++,r?.add(e)))}}}function a(e,t,r){let n="boolean"===t?"false":"";return t=>{let o=t?.toString()??n;r?.has(o)||(e[o]=(e[o]??0)+1,r?.add(o))}}},75364:e=>{"use strict";e.s({getGroups:()=>s});var t=e.i(76244),r=e.i(45199),n=e.i(19677);let o={reducer:(e,t,r,n)=>(t[n]=r,t),getInitialValue:e=>Array.from({length:e})},i=["string","number","boolean"];function s(e,s,a){let l=a.properties,u=l.length,c=e.index.getSearchablePropertiesWithTypes(e.data.index);for(let e=0;e<u;e++){let r=l[e];if(void 0===c[r])throw(0,t.createError)("UNKNOWN_GROUP_BY_PROPERTY",r);if(!i.includes(c[r]))throw(0,t.createError)("INVALID_GROUP_BY_PROPERTY",r,i.join(", "),c[r])}let f=s.map(([t])=>(0,n.getDocumentIdFromInternalId)(e.internalDocumentIDStore,t)),d=e.documentsStore.getMultiple(e.data.docs,f),h=d.length,p=a.maxResult||Number.MAX_SAFE_INTEGER,m=[],g={};for(let e=0;e<u;e++){let t=l[e],n={property:t,perValue:{}},o=new Set;for(let e=0;e<h;e++){let i=d[e],s=(0,r.getNested)(i,t);if(void 0===s)continue;let a="boolean"!=typeof s?s:""+s,l=n.perValue[a]??{indexes:[],count:0};l.count>=p||(l.indexes.push(e),l.count++,n.perValue[a]=l,o.add(s))}m.push(Array.from(o)),g[t]=n}let I=function e(t,n=0){if(n+1===t.length)return t[n].map(e=>[e]);let o=t[n],i=e(t,n+1),s=[];for(let e of o)for(let t of i){let n=[e];(0,r.safeArrayPush)(n,t),s.push(n)}return s}(m),y=I.length,S=[];for(let e=0;e<y;e++){let t=I[e],n=t.length,o={values:[],indexes:[]},i=[];for(let e=0;e<n;e++){let r=t[e],n=l[e];i.push(g[n].perValue["boolean"!=typeof r?r:""+r].indexes),o.values.push(r)}o.indexes=(0,r.intersect)(i).sort((e,t)=>e-t),0!==o.indexes.length&&S.push(o)}let b=S.length,T=Array.from({length:b});for(let e=0;e<b;e++){let t=S[e],r=a.reduce||o,n=t.indexes.map(e=>({id:f[e],score:s[e][1],document:d[e]})),i=r.reducer.bind(null,t.values),l=r.getInitialValue(t.indexes.length),u=n.reduce(i,l);T[e]={values:t.values,result:u}}return T}},3224:e=>{"use strict";e.s({fullTextSearch:()=>c,innerFullTextSearch:()=>u});var t=e.i(89766),r=e.i(75364),n=e.i(48477),o=e.i(19677),i=e.i(76244),s=e.i(45199),a=e.i(59915),l=e.i(24435);function u(e,t,r){let n,o,{term:s,properties:l}=t,u=e.data.index,c=e.caches.propertiesToSearch;if(!c){let t=e.index.getSearchablePropertiesWithTypes(u);c=(c=e.index.getSearchableProperties(u)).filter(e=>t[e].startsWith("string")),e.caches.propertiesToSearch=c}if(l&&"*"!==l){for(let e of l)if(!c.includes(e))throw(0,i.createError)("UNKNOWN_INDEX",e,c.join(", "));c=c.filter(e=>l.includes(e))}Object.keys(t.where??{}).length>0&&(n=e.index.searchByWhereClause(u,e.tokenizer,t.where,r));let d=void 0!==t.threshold&&null!==t.threshold?t.threshold:1;if(s||l){let i=(0,a.count)(e);o=e.index.search(u,s||"",e.tokenizer,r,c,t.exact||!1,t.tolerance||0,t.boost||{},function(e){let t=e??{};return t.k=t.k??f.k,t.b=t.b??f.b,t.d=t.d??f.d,t}(t.relevance),i,n,d)}else o=(n?Array.from(n):Object.keys(e.documentsStore.getAll(e.data.docs))).map(e=>[+e,0]);return o}function c(e,i,a){let c=(0,s.getNanosecondsTime)();function f(){let n,f=Object.keys(e.data.index.vectorIndexes),d=i.facets&&Object.keys(i.facets).length>0,{limit:h=10,offset:p=0,distinctOn:m,includeVectors:g=!1}=i,I=!0===i.preflight,y=u(e,i,a);if(i.sortBy)if("function"==typeof i.sortBy){let t=y.map(([e])=>e),r=e.documentsStore.getMultiple(e.data.docs,t).map((e,t)=>[y[t][0],y[t][1],e]);r.sort(i.sortBy),y=r.map(([e,t])=>[e,t])}else y=e.sorter.sortBy(e.data.sorting,y,i.sortBy).map(([t,r])=>[(0,o.getInternalDocumentId)(e.internalDocumentIDStore,t),r]);else y=y.sort(s.sortTokenScorePredicate);I||(n=m?(0,l.fetchDocumentsWithDistinct)(e,y,p,h,m):(0,l.fetchDocuments)(e,y,p,h));let S={elapsed:{formatted:"",raw:0},hits:[],count:y.length};return void 0!==n&&(S.hits=n.filter(Boolean),g||(0,s.removeVectorsFromHits)(S,f)),d&&(S.facets=(0,t.getFacets)(e,y,i.facets)),i.groupBy&&(S.groups=(0,r.getGroups)(e,y,i.groupBy)),S.elapsed=e.formatElapsedTime((0,s.getNanosecondsTime)()-c),S}async function d(){e.beforeSearch&&await (0,n.runBeforeSearch)(e.beforeSearch,e,i,a);let t=f();return e.afterSearch&&await (0,n.runAfterSearch)(e.afterSearch,e,i,a,t),t}return e.beforeSearch?.length||e.afterSearch?.length?d():f()}let f={k:1.2,b:.75,d:.5}},15199:e=>{"use strict";e.s({innerVectorSearch:()=>l,searchVector:()=>u});var t=e.i(45199),r=e.i(89766),n=e.i(76244),o=e.i(75364),i=e.i(19677),s=e.i(48477),a=e.i(47653);function l(e,t,r){let o,i=t.vector;if(i&&(!("value"in i)||!("property"in i)))throw(0,n.createError)("INVALID_VECTOR_INPUT",Object.keys(i).join(", "));let s=e.data.index.vectorIndexes[i.property],l=s.node.size;if(i?.value.length!==l){if(i?.property===void 0||i?.value.length===void 0)throw(0,n.createError)("INVALID_INPUT_VECTOR","undefined",l,"undefined");throw(0,n.createError)("INVALID_INPUT_VECTOR",i.property,l,i.value.length)}let u=e.data.index;return Object.keys(t.where??{}).length>0&&(o=e.index.searchByWhereClause(u,e.tokenizer,t.where,r)),s.node.find(i.value,t.similarity??a.DEFAULT_SIMILARITY,o)}function u(e,n,a="english"){let c=(0,t.getNanosecondsTime)();function f(){let s=l(e,n,a).sort(t.sortTokenScorePredicate),u=[];n.facets&&Object.keys(n.facets).length>0&&(u=(0,r.getFacets)(e,s,n.facets));let f=n.vector.property,d=n.includeVectors??!1,h=n.limit??10,p=n.offset??0,m=Array.from({length:h});for(let t=0;t<h;t++){let r=s[t+p];if(!r)break;let n=e.data.docs.docs[r[0]];if(n){d||(n[f]=null);let o={id:(0,i.getDocumentIdFromInternalId)(e.internalDocumentIDStore,r[0]),score:r[1],document:n};m[t]=o}}let g=[];n.groupBy&&(g=(0,o.getGroups)(e,s,n.groupBy));let I=(0,t.getNanosecondsTime)()-c;return{count:s.length,hits:m.filter(Boolean),elapsed:{raw:Number(I),formatted:(0,t.formatNanoseconds)(I)},...u?{facets:u}:{},...g?{groups:g}:{}}}async function d(){e.beforeSearch&&await (0,s.runBeforeSearch)(e.beforeSearch,e,n,a);let t=f();return e.afterSearch&&await (0,s.runAfterSearch)(e.afterSearch,e,n,a,t),t}return e.beforeSearch?.length||e.afterSearch?.length?d():f()}},54571:e=>{"use strict";e.s({hybridSearch:()=>l});var t=e.i(45199),r=e.i(89766),n=e.i(75364),o=e.i(24435),i=e.i(3224),s=e.i(15199),a=e.i(48477);function l(e,l,c){let f=(0,t.getNanosecondsTime)();function d(){let a,d,h=function(e,t,r){let n=function(e){let t=Math.max.apply(Math,e.map(u));return e.map(([e,r])=>[e,r/t])}((0,i.innerFullTextSearch)(e,t,r)),o=(0,s.innerVectorSearch)(e,t,r),a=t.hybridWeights;return function(e,t,r,n){let o=Math.max.apply(Math,e.map(u)),i=Math.max.apply(Math,t.map(u)),{text:s,vector:a}=n&&n.text&&n.vector?n:{text:.5,vector:.5},l=new Map,c=e.length,f=(e,t)=>e*s+t*a;for(let t=0;t<c;t++){let[r,n]=e[t],i=f(n/o,0);l.set(r,i)}let d=t.length;for(let e=0;e<d;e++){let[r,n]=t[e],o=n/i,s=l.get(r)??0;l.set(r,s+f(0,o))}return[...l].sort((e,t)=>t[1]-e[1])}(n,o,t.term??"",a)}(e,l,c);l.facets&&Object.keys(l.facets).length>0&&(a=(0,r.getFacets)(e,h,l.facets)),l.groupBy&&(d=(0,n.getGroups)(e,h,l.groupBy));let p=l.offset??0,m=l.limit??10,g=(0,o.fetchDocuments)(e,h,p,m).filter(Boolean),I=(0,t.getNanosecondsTime)(),y={count:h.length,elapsed:{raw:Number(I-f),formatted:(0,t.formatNanoseconds)(I-f)},hits:g,...a?{facets:a}:{},...d?{groups:d}:{}};if(!l.includeVectors){let r=Object.keys(e.data.index.vectorIndexes);(0,t.removeVectorsFromHits)(y,r)}return y}async function h(){e.beforeSearch&&await (0,a.runBeforeSearch)(e.beforeSearch,e,l,c);let t=d();return e.afterSearch&&await (0,a.runAfterSearch)(e.afterSearch,e,l,c,t),t}return e.beforeSearch?.length||e.afterSearch?.length?h():d()}function u(e){return e[1]}},24435:e=>{"use strict";e.s({fetchDocuments:()=>c,fetchDocumentsWithDistinct:()=>u,search:()=>l});var t=e.i(19677),r=e.i(76244),n=e.i(45199),o=e.i(66133),i=e.i(3224),s=e.i(15199),a=e.i(54571);function l(e,t,n){let l=t.mode??o.MODE_FULLTEXT_SEARCH;if(l===o.MODE_FULLTEXT_SEARCH)return(0,i.fullTextSearch)(e,t,n);if(l===o.MODE_VECTOR_SEARCH)return(0,s.searchVector)(e,t);if(l===o.MODE_HYBRID_SEARCH)return(0,a.hybridSearch)(e,t);throw(0,r.createError)("INVALID_SEARCH_MODE",l)}function u(e,r,o,i,s){let a=e.data.docs,l=new Map,u=[],c=new Set,f=r.length,d=0;for(let h=0;h<f;h++){let f=r[h];if(void 0===f)continue;let[p,m]=f;if(c.has(p))continue;let g=e.documentsStore.get(a,p),I=(0,n.getNested)(g,s);if(!(void 0===I||l.has(I))&&(l.set(I,!0),!(++d<=o)&&(u.push({id:(0,t.getDocumentIdFromInternalId)(e.internalDocumentIDStore,p),score:m,document:g}),c.add(p),d>=o+i)))break}return u}function c(e,r,n,o){let i=e.data.docs,s=Array.from({length:o}),a=new Set;for(let l=n;l<o+n;l++){let n=r[l];if(void 0===n)break;let[o,u]=n;if(!a.has(o)){let r=e.documentsStore.get(i,o);s[l]={id:(0,t.getDocumentIdFromInternalId)(e.internalDocumentIDStore,o),score:u,document:r},a.add(o)}}return s}},82478:e=>{"use strict";function t(e,t){e.internalDocumentIDStore.load(e,t.internalDocumentIDStore),e.data.index=e.index.load(e.internalDocumentIDStore,t.index),e.data.docs=e.documentsStore.load(e.internalDocumentIDStore,t.docs),e.data.sorting=e.sorter.load(e.internalDocumentIDStore,t.sorting),e.tokenizer.language=t.language}e.s({load:()=>t})},57498:e=>{"use strict";e.s({update:()=>s,updateMultiple:()=>l});var t=e.i(48477),r=e.i(76244),n=e.i(46590),o=e.i(27801),i=e.i(45199);function s(e,r,s,l,u){return(0,i.isAsyncFunction)(e.afterInsert)||(0,i.isAsyncFunction)(e.beforeInsert)||(0,i.isAsyncFunction)(e.afterRemove)||(0,i.isAsyncFunction)(e.beforeRemove)||(0,i.isAsyncFunction)(e.beforeUpdate)||(0,i.isAsyncFunction)(e.afterUpdate)?a(e,r,s,l,u):function(e,r,i,s,a){!a&&e.beforeUpdate&&(0,t.runSingleHook)(e.beforeUpdate,e,r),(0,o.remove)(e,r,s,a);let l=(0,n.insert)(e,i,s,a);return!a&&e.afterUpdate&&(0,t.runSingleHook)(e.afterUpdate,e,l),l}(e,r,s,l,u)}async function a(e,r,i,s,a){!a&&e.beforeUpdate&&await (0,t.runSingleHook)(e.beforeUpdate,e,r),await (0,o.remove)(e,r,s,a);let l=await (0,n.insert)(e,i,s,a);return!a&&e.afterUpdate&&await (0,t.runSingleHook)(e.afterUpdate,e,l),l}function l(e,s,a,l,c,f){return(0,i.isAsyncFunction)(e.afterInsert)||(0,i.isAsyncFunction)(e.beforeInsert)||(0,i.isAsyncFunction)(e.afterRemove)||(0,i.isAsyncFunction)(e.beforeRemove)||(0,i.isAsyncFunction)(e.beforeUpdate)||(0,i.isAsyncFunction)(e.afterUpdate)||(0,i.isAsyncFunction)(e.beforeUpdateMultiple)||(0,i.isAsyncFunction)(e.afterUpdateMultiple)||(0,i.isAsyncFunction)(e.beforeRemoveMultiple)||(0,i.isAsyncFunction)(e.afterRemoveMultiple)||(0,i.isAsyncFunction)(e.beforeInsertMultiple)||(0,i.isAsyncFunction)(e.afterInsertMultiple)?u(e,s,a,l,c,f):function(e,i,s,a,l,u){u||(0,t.runMultipleHook)(e.beforeUpdateMultiple,e,i);let c=s.length;for(let t=0;t<c;t++){let n=e.validateSchema(s[t],e.schema);if(n)throw(0,r.createError)("SCHEMA_VALIDATION_FAILURE",n)}(0,o.removeMultiple)(e,i,a,l,u);let f=(0,n.innerInsertMultiple)(e,s,a,l,u);return u||(0,t.runMultipleHook)(e.afterUpdateMultiple,e,f),f}(e,s,a,l,c,f)}async function u(e,i,s,a,l,u){u||await (0,t.runMultipleHook)(e.beforeUpdateMultiple,e,i);let c=s.length;for(let t=0;t<c;t++){let n=e.validateSchema(s[t],e.schema);if(n)throw(0,r.createError)("SCHEMA_VALIDATION_FAILURE",n)}await (0,o.removeMultiple)(e,i,a,l,u);let f=await (0,n.innerInsertMultiple)(e,s,a,l,u);return u||await (0,t.runMultipleHook)(e.afterUpdateMultiple,e,f),f}},35032:e=>{"use strict";e.s({}),e.i(48477),e.i(76244),e.i(46590),e.i(57498),e.i(45199)},25893:e=>{"use strict";e.s({}),e.i(76244),e.i(24435)},11344:e=>{"use strict";e.s({kInsertions:()=>t,kRemovals:()=>r}),e.i(66133);let t=Symbol("orama.insertions"),r=Symbol("orama.removals")},90023:e=>{"use strict";e.s({}),e.i(66133),e.i(11344)},22085:e=>{"use strict";e.s({}),e.i(66313),e.i(45199),e.i(78117)},79499:e=>{"use strict";e.s({}),e.i(66313),e.i(45199),e.i(78117),e.i(22085)},69644:e=>{"use strict";e.s({}),e.i(58996),e.i(59915),e.i(46590),e.i(27801),e.i(24435),e.i(15199),e.i(82478),e.i(57498),e.i(35032),e.i(25893),e.i(90023),e.i(79927),e.i(79499)},10326:e=>{"use strict";e.s({}),e.i(58996),e.i(59915),e.i(46590),e.i(27801),e.i(24435),e.i(15199),e.i(82478),e.i(57498),e.i(35032),e.i(25893),e.i(90023),e.i(79927),e.i(79499),e.i(69644)}}]);

//# sourceMappingURL=b8614ef1a801e2d9.js.map